<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NCEPLIBS-w3emc: w3fi88.f Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NCEPLIBS-w3emc
   &#160;<span id="projectnumber">2.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('w3fi88_8f_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">w3fi88.f</div>  </div>
</div><!--header-->
<div class="contents">
<a href="w3fi88_8f.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">C&gt; @file</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">C&gt; @brief BUFR message decoder</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1988-08-31</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160; </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">C&gt; This set of routines will decode a bufr message and</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">C&gt; place information extracted from the bufr message into selected</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">C&gt; arrays for the user. the array kdata can now be sized by the user</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">C&gt; by indicating the maximum number of subsets and the maximum</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">C&gt; number of descriptors that are expected in the course of decoding</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">C&gt; selected input data.  this allows for realistic sizing of kdata</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">C&gt; and the mstack arrays. this version also allows for the inclusion</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">C&gt; of the unit numbers for tables b and d into the</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">C&gt; argument list. this routine does not include ifod processing.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">C&gt; Program history log:</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1988-08-31</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1990-12-07 Now Utilizing gbyte routines to gather</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">C&gt; and separate bit fields. this should improve</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">C&gt; (decrease) the time it takes to decode any</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">C&gt; bufr message. have entered coding that will</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">C&gt; permit processing bufr editions 1 and 2.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">C&gt; improved and corrected the conversion into</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">C&gt; ifod format of decoded bufr messages.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1991-01-18 Program/routines modified to properly handle</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">C&gt; serial profiler data.</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1991-04-04 Modified to handle text supplied thru</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">C&gt; descriptor 2 05 yyy.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1991-04-17 Errors in extracting and scaling data</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">C&gt; corrected. improved handling of nested</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">C&gt; queue descriptors is added.</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1991-05-10 Array &#39;data&#39; has been enlarged to real*8</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">C&gt; to better contain very large numbers more</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">C&gt; accurately. the preious size real*4 could not</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">C&gt; contain sufficient significant digits.</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">C&gt; coding has been introduced to process new</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">C&gt; table c descriptor 2 06 yyy which permits in</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">C&gt; line processing of a local descriptor even if</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">C&gt; the descriptor is not contained in the users</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">C&gt; table b.</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">C&gt; a second routine to process ifod messages</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">C&gt; (ifod0) has been removed in favor of the</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">C&gt; improved processing of the one</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">C&gt; remaining (ifod1).</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">C&gt; new coding has been introduced to permit</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">C&gt; processing of bufr messages based on bufr</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">C&gt; edition up to and including edition 2.</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">C&gt; please note increased size requirements</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">C&gt; for arrays ident(20) and iptr(40).</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1991-07-26 Add Array mtime to calling sequence to</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">C&gt; permit inclusion of receipt/transfer times</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">C&gt; to ifod messages.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1991-09-25 All processing of decoded bufr data into</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">C&gt; ifod (a local use reformat of bufr data)</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">C&gt; has been isolated from this set of routines.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">C&gt; for those interested in the ifod form,</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">C&gt; see w3fl05 in the w3lib routines.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">C&gt;     processing of bufr messages containing</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">C&gt; delayed replication has been altered so that</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">C&gt; single subsets (reports) and and a matching</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">C&gt; descriptor list for that particular  subset</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">C&gt; will be passed to the user will be passed to</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">C&gt; the user one at a time to assure that each</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">C&gt; subset can be fully defined with a minimum</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">C&gt; of reprocessing.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">C&gt;     processing of associated fields has been</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">C&gt; tested with messages containing non-compressed</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">C&gt; data.</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">C&gt;     in order to facilitate user processing</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">C&gt; a matching list of scale factors are included</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">C&gt; with the expanded descriptor list (mstack).</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1991-11-21 Processing of descriptor 2 03 yyy</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">C&gt; has corrected to agree with fm94 standards.</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1991-12-19 Calls to fi8803 and fi8804 have been</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">C&gt; corrected to agree called program argument</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">C&gt; list. some additional entries have been</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">C&gt; included for communicating with data access</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">C&gt; routines. additional error exit provided for</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">C&gt; the case where table b is damaged.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1992-01-24 Routines fi8801, fi8803 and fi8804</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">C&gt; have been modified to handle associated fields</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">C&gt; all descriptors are set to echo to mstack(1,n)</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1992-05-21 Further expansion of information collected</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">C&gt; from within upper air soundings has produced</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">C&gt; the necessity to expand some of the processing</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">C&gt; and output arrays. (see remarks below)</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">C&gt;   corrected descriptor denoting height of</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">C&gt; each wind level for profiler conversions.</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1992-07-23 Expansion of table b requires adjustment</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">C&gt; of arrays to contain table b values needed to</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">C&gt; assist in the decoding process.</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">C&gt; arrays containing data from table b</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">C&gt; - KFXY1 Descriptor</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">C&gt; - ANAME1 Descriptor name</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">C&gt; - AUNIT1 Units for descriptor</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">C&gt; - ISCAL1 Scale for value of descriptor</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">C&gt; - IRFVL1 Reference value for descriptor</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">C&gt; - IWIDE1 Bit width for value of descriptor</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1992-09-09 First encounter with operator descriptor</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">C&gt; 2 05 yyy showed error in decoding. that error</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">C&gt; is corrected with this implementation. further</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">C&gt; testing of upper air data has encountered</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">C&gt; the condition of large (many level) soundings</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">C&gt; arrays in the decoder have been expanded (again)</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">C&gt; to allow for this condition.</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1992-10-02 Modified routine to reformat profiler data</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">C&gt; (fi8809) to show descriptors, scale value and</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">C&gt; data in proper order.  corrected an error that</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">C&gt; prevented user from assigning the second dimension</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">C&gt; of kdata(500,*).</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1992-10-20 Removed error that prevented full</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">C&gt; implementation of previous corrections and</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">C&gt; made corrections to table b to bring it up to</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">C&gt; date. changes include proper reformat of profiler</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">C&gt; data and user capability for assigning second</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">C&gt; dimension of kdata array.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1992-12-09 Thanks to dennis keyser for the suggestions</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">C&gt; and coding, this implementation will allow the</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">C&gt; inclusion of unit numbers for tables b &amp; d, and</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">C&gt; in addition allows for realistic sizing of kdata</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">C&gt; and mstack arrays by the user. as of this</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">C&gt; implementation, the upper size limit for a bufr</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">C&gt; message allows for a message size greater than</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">C&gt; 15000 bytes.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1993-01-26 Routine fi8810 has been added to permit</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">C&gt; reformatting of profiler data in edition 2.</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1993-05-13 Routine fi8811 has been added to permit</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">C&gt; processing of run-line encoding. this provides for</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">C&gt; the handling of data for graphics products.</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">C&gt; please note the addition of two arguments in the</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">C&gt; calling sequence.</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1993-12-01 Routine fi8803 to correct handling of</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">C&gt; associated fields and arrays associated with</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">C&gt; table b entries enlarged to handle larger table b</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1994-05-25 Routines have been modified to construct a</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">C&gt; modified table b i.e., it is tailored to contain o</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">C&gt; those descriptors that will be used to decode</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">C&gt; data in current and subsequent bufr messages.</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">C&gt; table b and table d descriptors will be isolated</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">C&gt; and merged with the main tables for use with</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">C&gt; following bufr messages.</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">C&gt; the descriptors indicating the replication of</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">C&gt; descriptors and data are activated with this</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">C&gt; implementation.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1994-08-30 Added statements that will allow use of</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">C&gt; these routines directly on the cray with no</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">C&gt; modification. handling od table d entries has been</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">C&gt; modified to prevent loss of ancillary entries.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">C&gt; coding has been added to allow processing on</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">C&gt; either an 8 byte word or 4 byte word machine.</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">C&gt; For those users of the bufr decoder that are</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">C&gt; processing sets of bufr messages that include</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">C&gt; type 11 messages, coding has been added to allow</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">C&gt; the recovery of the added or modified table b</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">C&gt; entries by writing them to a disk file available</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">C&gt; to the user. this is accomplished with no change</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">C&gt; to the calling sequence. table b entries will be</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">C&gt; designated as follows:</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">C&gt; IUNITB - Is the unit number for the master table b.</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">C&gt; IUNITB+1 - Will be the unit number for the table b entries that are to be used</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">C&gt; in the decoding of subsequent messages. this device will be formatted the same</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">C&gt; the disk file on iunitb.</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">C&gt; - Dennis Keyser 1995-06-07 Corrected an error which required input</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">C&gt; argument &quot;maxd&quot; to be nearly twice as large as</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">C&gt; needed for decoding wind profiler reports (limit</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">C&gt; upper bound for &quot;iwork&quot; array was set to &quot;maxd&quot;,</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">C&gt; now it is set to 15000). also, a correction was</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">C&gt; made in the wind profiler processing to prevent</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">C&gt; unnecessary looping when all requested</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">C&gt; descriptors are missing.  also corrected an</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">C&gt; error which resulted in returned scale in</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">C&gt; &quot;mstack(2, ..)&quot; always being set to zero for</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">C&gt; compressed data.</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1996-02-15 Modified identification of ascii/ebcdic</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">C&gt; machine. modified handling of table b to permit</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">C&gt; faster processing of multiple messages with</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">C&gt; changing data types and/or subtypes.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1996-04-02 Deactivated extraneous write statement.</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">C&gt; enlarged arrays for table b entries to contain</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">C&gt; up to 1300 entries in preparation for new</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">C&gt; additions to table b.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">C&gt; - Dennis Keyser 2001-02-01 The table b file will now be read whenever the</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">C&gt; input argument &quot;iunitb&quot; (table b unit number)</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">C&gt; changes from its value in the previous call to</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">C&gt; this routine (normally it is only read the</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">C&gt; first time this routine is called)</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">C&gt; - Boi Vuong 2002-10-15 Replaced function ichar with mova2i</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">C&gt; @param[in] MSGA Array containing supposed bufr message</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">C&gt; size is determined by user, can be greater</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">C&gt; than 15000 bytes.</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">C&gt; @param[in] MAXR Maximum number of reports/subsets that may be</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">C&gt; contained in a bufr message</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">C&gt; @param[in] MAXD Maximum number of descriptor combinations that</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">C&gt; may be processed; upper air data and some satellite</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">C&gt; data require a value for maxd of 1700, but for most</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">C&gt; other data a value for maxd of 500 will suffice</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">C&gt; @param[in] IUNITB Unit number of data set holding table b, this is the</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">C&gt; number of a pair of data sets</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">C&gt; -IUNITB+Unit number for a dataset to contain table b entries</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">C&gt; from master table b and table b entries extracted</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">C&gt; from type 11 bufr messages that were used to decode</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">C&gt; current bufr messages.</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">C&gt; @param[in] IUNITD Unit number of data set holding tab</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">C&gt; @param[out] ISTACK Original array of descriptors extracted from</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">C&gt; source bufr message.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">C&gt; @param[out] MSTACK (A,B)-LEVEL B Descriptor number (limited to value of</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">C&gt; input argument maxd)</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">C&gt; - Level A:</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">C&gt;  - = 1 Descriptor</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">C&gt;  - = 2 10**N scaling to return to original value</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">C&gt; @param[out] IPTR Utility array (should have at last 42 entries)</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">C&gt; - IPTR(1)- Error return</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">C&gt; - IPTR(2)- Byte count section 1</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">C&gt; - IPTR(3)- Pointer to start of section 1</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">C&gt; - IPTR(4)- Byte count section 2</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">C&gt; - IPTR(5)- Pointer to start of section 2</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">C&gt; - IPTR(6)- Byte count section 3</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">C&gt; - IPTR(7)- Pointer to start of section 3</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">C&gt; - IPTR(8)- Byte count section 4</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">C&gt; - IPTR(9)- Pointer to start of section 4</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">C&gt; - IPTR(10)- Start of requested subset, reserved for dar</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">C&gt; - IPTR(11)- Current descriptor ptr in iwork</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">C&gt; - IPTR(12)- Last descriptor pos in iwork</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">C&gt; - IPTR(13)- Last descriptor pos in istack</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">C&gt; - IPTR(14)- Number of master table b entries</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">C&gt; - IPTR(15)- Requested subset pointer, reserved for dar</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">C&gt; - IPTR(16)- Indicator for existance of section 2</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">C&gt; - IPTR(17)- Number of reports processed</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">C&gt; - IPTR(18)- Ascii/text event</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">C&gt; - IPTR(19)- Pointer to start of bufr message</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">C&gt; - IPTR(20)- Number of entries from table d</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">C&gt; - IPTR(21)- Nr table b entries</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">C&gt; - IPTR(22)- Nr table b entries from current message</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">C&gt; - IPTR(23)- Code/flag table switch</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">C&gt; - IPTR(24)- Aditional words added by text info</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">C&gt; - IPTR(25)- Current bit number</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">C&gt; - IPTR(26)- Data width change - add to table b width</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">C&gt; - IPTR(27)- Data scale change - modifies table b scale</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">C&gt; - IPTR(28)- Data reference value change - ?????????</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">C&gt; - IPTR(29)- Add data associated field</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">C&gt; - IPTR(30)- Signify characters</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">C&gt; - IPTR(31)- Number of expanded descriptors in mstack</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">C&gt; - IPTR(32)- Current descriptor segment f</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">C&gt; - IPTR(33)- Current descriptor segment x</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">C&gt; - IPTR(34)- Current descriptor segment y</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">C&gt; - IPTR(35)- Data/descriptor replication in progress</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">C&gt;  - 0  = No</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">C&gt;  - 1  = Yes</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">C&gt; - IPTR(36)- Next descriptor may be undecipherable</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">C&gt; - IPTR(37)- Machine text type flag</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">C&gt;  - 0  = EBCIDIC</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">C&gt;  - 1  = ASCII</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">C&gt; - IPTR(38)- Data/descriptor replication flag</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">C&gt;  -  0 - Does not exist in current message</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">C&gt;  - 1 - Exists in current message</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">C&gt; - IPTR(39)- Delayed replication flag</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">C&gt;  - 0 - No delayed replication</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">C&gt;  - 1 - Message contains delayed replication</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">C&gt; - IPTR(40)- Number of characters in text for curr descriptor</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">C&gt; - IPTR(41)- Number of ancillary table b entries</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">C&gt; - IPTR(42)- Number of ancillary table d entries</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">C&gt; - IPTR(43)- Number of added table b entries encountered while</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">C&gt; processing a bufr message. these entries only</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">C&gt; exist durng processing of current bufr message</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">C&gt; IPTR(44)- Bits per word</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">C&gt; IPTR(45)- Bytes per word</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">C&gt; @param[out] IDENT Array contains message information extracted from BUFR message:</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">C&gt; - IDENT(1)  - Edition number (byte 4, section 1)</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">C&gt; - IDENT(2)  - Originating center (bytes 5-6, section 1)</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">C&gt; - IDENT(3)  - Update sequence (byte 7, section 1)</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">C&gt; - IDENT(4)  - Optional section (byte 8, section 1)</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">C&gt; - IDENT(5)  - Bufr message type (byte 9, section 1)</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">C&gt;  -  0 = Surface data (land)</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">C&gt;  -  1 = Surface data (ship)</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">C&gt;  -  2 = Vertical soundings (other than satellite)</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">C&gt;  -  3 = Vertical soundings (satellite)</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">C&gt;  -  4 = Single lvl upper-air data(other than satellite)</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">C&gt;  -  5 = Single level upper-air data (satellite)</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">C&gt;  -  6 = Radar data</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">C&gt;  -  7 = Synoptic features</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">C&gt;  -  8 = Physical/chemical constituents</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">C&gt;  -  9 = Dispersal and transport</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">C&gt;  - 10 = Radiological data</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">C&gt;  - 11 = Bufr tables (complete, replacement or update)</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">C&gt;  - 12 = Surface data (satellite)</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">C&gt;  - 21 = Radiances (satellite measured)</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">C&gt;  - 31 = Oceanographic data</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">C&gt; - IDENT(6)  - Bufr msg sub-type (byte 10, section 1)</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">C&gt;              | TYPE | SBTYP |</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">C&gt;              | :--- | :---- |</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">C&gt;              | 2 | 7 = PROFILER |</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">C&gt; - IDENT(7)  - (bytes 11-12, section 1)</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">C&gt; - IDENT(8)  - Year of century (byte 13, section 1)</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">C&gt; - IDENT(9)  - Month of year (byte 14, section 1)</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">C&gt; - IDENT(10) - Day of month (byte 15, section 1)</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">C&gt; - IDENT(11) - Hour of day (byte 16, section 1)</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">C&gt; - IDENT(12) - Minute of hour (byte 17, section 1)</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">C&gt; - IDENT(13) - Rsvd by adp centers(byte 18, section 1)</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">C&gt; - IDENT(14) - Nr of data subsets (byte 5-6, section 3)</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">C&gt; - IDENT(15) - Observed flag (byte 7, bit 1, section 3)</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">C&gt; - IDENT(16) - Compression flag (byte 7, bit 2, section 3)</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">C&gt; - IDENT(17) - Master table number(byte 4, section 1, ed 2 or gtr)</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">C&gt; @param[out] KDATA Array containing decoded reports from bufr message.</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">C&gt; KDATA(Report number,parameter number)</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">C&gt; (Report number limited to value of input argument</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">C&gt; maxr and parameter number limited to value of input</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">C&gt; argument maxd)</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">C&gt; @param[out] INDEX Pointer to available subset</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">C&gt; @param KNR</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">C&gt; @param LDATA</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">C&gt; @param LSTACK</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">C&gt;  ===========================================================</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">C&gt; Arrays containing data from table b</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">C&gt; new - base arrays containing data from table b</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">C&gt; - KFXY1 - Decimal descriptor value of f x y values</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">C&gt; - ANAME1 - Descriptor name</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">C&gt; - AUNIT1 - Units for descriptor</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">C&gt; - ISCAL1 - Scale for value of descriptor</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">C&gt; - IRFVL1 - Reference value for descriptor</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">C&gt; - IWIDE1 - Bit width for value of descriptor</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">C&gt;  ===========================================================</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">C&gt; New - ancillary arrays containing data from table b</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">C&gt; containing table b entries extracted</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">C&gt; from type 11 bufr messages</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">C&gt; - KFXY2 - Decimal descriptor value of f x y values</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">C&gt; - ANAME2 - Descriptor name</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">C&gt; - AUNIT2 - Units for descriptor</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">C&gt; - ISCAL2 - Scale for value of descriptor</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">C&gt; - IRFVL2 - Reference value for descriptor</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">C&gt; - IWIDE2 - Bit width for value of descriptor</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">C&gt;  ===========================================================</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">C&gt; New - added arrays containing data from table b</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">C&gt; containing table b entries extracted</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">C&gt; from non-type 11 bufr messages</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">C&gt; these exist for the life of current bufr message</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">C&gt; - KFXY3 - Decimal descriptor value of f x y values</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">C&gt; - ANAME3 - Descriptor name</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">C&gt; - AUNIT3 - Units for descriptor</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">C&gt; - ISCAL3 - Scale for value of descriptor</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">C&gt; - IRFVL3 - Reference value for descriptor</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">C&gt; - IWIDE3 - Bit width for value of descriptor</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">C&gt;  ===========================================================</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">C&gt; Error returns:</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">C&gt; IPTR(1)</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">C&gt; - = 1 &#39;BUFR&#39; Not found in first 125 characters</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">C&gt; - = 2 &#39;7777&#39; Not found in location determined by</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">C&gt; by using counts found in each section. one or</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">C&gt; more sections have an erroneous byte count or</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">C&gt; characters &#39;7777&#39; are not in test message.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">C&gt; - = 3 Message contains a descriptor with f=0 that does</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">C&gt; not exist in table b.</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">C&gt; - = 4 Message contains a descriptor with f=3 that does</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">C&gt; not exist in table d.</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">C&gt; - = 5 Message contains a descriptor with f=2 with the</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">C&gt; value of x outside the range 1-6.</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">C&gt; - = 6 Descriptor element indicated to have a flag value</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">C&gt; does not have an entry in the flag table.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">C&gt; (to be activated)</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">C&gt; - = 7 Descriptor indicated to have a code value does</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">C&gt; not have an entry in the code table.</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">C&gt; (to be activated)</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">C&gt; - = 8 Error reading table d</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">C&gt; - = 9 Error reading table b</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">C&gt; - = 10 Error reading code/flag table</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">C&gt; - = 11 Descriptor 2 04 004 not followed by 0 31 021</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">C&gt; - = 12 Data descriptor operator qualifier does not follow</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">C&gt; delayed replication descriptor.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">C&gt; - = 13 Bit width on ascii characters not a multiple of 8</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">C&gt; - = 14 Subsets = 0, no content bulletin</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">C&gt; - = 20 Exceeded count for delayed replication pass</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">C&gt; - = 21 Exceeded count for non-delayed replication pass</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">C&gt; - = 22 Exceeded combined bit width, bit width &gt; 32</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">C&gt; - = 23 No element descriptors following 2 03 yyy</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">C&gt; - = 27 Non zero lowest on text data</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">C&gt; - = 28 Nbinc not nr of characters</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">C&gt; - = 29 Table b appears to be damaged</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">C&gt; - = 30 Table d entry with more than 18 in sequence</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">C&gt; being entered from type 11 message</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">C&gt; - = 99 No more subsets (reports) available in current</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">C&gt; bufr mesage</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">C&gt; - = 400 Number of subsets exceeds the value of input</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">C&gt; argument maxr; must increase maxr to value of</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">C&gt; ident(14) in calling program</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">C&gt; - = 401 Number of parameters (and associated fields)</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">C&gt; exceeds limits of this program.</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">C&gt; - = 500 Value for nbinc has been found that exceeds</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">C&gt; standard width plus any bit width change.</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">C&gt; check all bit widths up to point of error.</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">C&gt; - = 501 Corrected width for descriptor is 0 or less</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">C&gt; - = 888 Non-numeric character in conversion request</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">C&gt; - = 890 Class 0 element descriptor w/width of 0</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">C&gt; On the initial call to w3fi88 with a bufr message the argument</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">C&gt; index must be set to zero (index = 0). on the return from w3fi88</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">C&gt; &#39;index&#39; will be set to the next available subset/report. when</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">C&gt; there are no more subsets available a 99 err return will occur.</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">C&gt; If the original bufr message does not contain delayed replication</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">C&gt; the bufr message will be completely decoded and &#39;index&#39; will point</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">C&gt; to the first decoded subset. the users will then have the option</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">C&gt; of indexing through the subsets on their own or by recalling this</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">C&gt; routine (without resetting &#39;index&#39;) to have the routine do the</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">C&gt; indexing.</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">C&gt; If the original bufr message does contain delayed replication</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">C&gt; one subset/report will be decoded at a time and passed back to</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">C&gt; the user. this is not an option.</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">C&gt;  =============================================</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">C&gt;   To use this routine</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">C&gt;  =============================================</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">C&gt;       the arrays to contain the output information are defined</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">C&gt;       as follows:</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">C&gt;           KDATA(A,B)  is the a data entry  (integer value)</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">C&gt;                       where a is the maximum number of reports/subsets</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">C&gt;                       that may be contained in the bufr message (this</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">C&gt;                       is now set to &quot;maxr&quot; which is passed as an input</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">C&gt;                       argument to w3fi88), and where b is the maximum</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">C&gt;                       number of descriptor combinations that may</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">C&gt;                       be processed (this is now set to &quot;maxd&quot; which</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">C&gt;                       is also passed as an input argument to w3fi88;</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">C&gt;                       upper air data and some satellite data require</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">C&gt;                       a value for maxd of 1700, but for most other</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">C&gt;                       data a value for maxd of 500 will suffice)</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">C&gt;           MSTACK(1,B) contains the descriptor that matches the</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">C&gt;                       data entry (max. value for b is now &quot;maxd&quot;</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">C&gt;                       which is passed as an input argument to w3fi88)</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">C&gt;           MSTACK(2,B) is the scale (power of 10) to be applied to</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">C&gt;                       the data (max. value for b is now &quot;maxd&quot;</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">C&gt;                       which is passed as an input argument to w3fi88)</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00437"></a><span class="lineno"><a class="line" href="w3fi88_8f.html#aaa3b36f853bace0e172b8191ce3a4f17">  437</a></span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="w3fi88_8f.html#aaa3b36f853bace0e172b8191ce3a4f17">w3fi88</a>(IPTR,IDENT,MSGA,ISTACK,MSTACK,KDATA,KNR,INDEX,</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;     *            LDATA,LSTACK,MAXR,MAXD,IUNITB,IUNITD)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">C          THE MEMORY REQUIREMENTS FOR LSTACK AND LDATA ARE USED WITH</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">C          RUN-LINE CODING PROVIDING FOR THE HANDLING OF DATA FOR</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">C          GRAPHICS. I.E., RADAR DISPLAYS. IF THE DECODING PROCESS WILL</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">C          NOT BE USED TO PROCESS THOSE TYPE OF MESSAGES, THEN THE</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">C          VARIABLE SIZES FOR THE ARRAYS CAN BE MINIMIZED.</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">C          IF THE DECODING PROCESS WILL BE USED TO DECODE THOSE MESSAGE</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">C          TYPES, THEN MAXD MUST REFLECT THE MAXIMUM NUMBER OF</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">C          DESCRIPTORS (FULLY EXPANDED LIST) TO BE EXPECTED IN THE</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">C          MESSAGE.</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keywordtype">INTEGER</span>        LDATA(MAXD)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordtype">INTEGER</span>        LSTACK(2,MAXD)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="keywordtype">INTEGER</span>        MSGA(*)</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordtype">INTEGER</span>        IPTR(*),KPTRB(16384),KPTRD(16384)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="keywordtype">INTEGER</span>        KDATA(MAXR,MAXD)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="keywordtype">INTEGER</span>        MSTACK(2,MAXD)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <span class="keywordtype">INTEGER</span>        IVALS(1000)</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keywordtype">INTEGER</span>        KNR(MAXR)</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordtype">INTEGER</span>        IDENT(*)</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <span class="keywordtype">INTEGER</span>        ISTACK(*),IOLD11</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">cdak KEYSER fix 02/02/2001 VVVVV</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="keywordtype">INTEGER</span>        IOLDTB</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">cdak KEYSER fix 02/02/2001 AAAAA</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keywordtype">INTEGER</span>        IWORK(15000)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="keywordtype">INTEGER</span>        INDEX</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordtype">INTEGER</span>        IIII</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keywordtype">CHARACTER*1</span>    BLANK</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <span class="keywordtype">CHARACTER*4</span>    DIRID(2)</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <span class="keywordtype">LOGICAL</span>        SEC2</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">C     NEW               BASE TABLE B</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">C                            MAY BE A COMBINATION OF MASTER TABLE B</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">C                            AND ANCILLARY TABLE B</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keywordtype">INTEGER</span>        KFXY1(1300),ISCAL1(1300)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="keywordtype">INTEGER</span>        IRFVL1(3,1300),IWIDE1(1300)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keywordtype">CHARACTER*40</span>   ANAME1(1300)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="keywordtype">CHARACTER*24</span>   AUNIT1(1300)</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">C        NEW            ANCILLARY TABLE B FROM TYPE 11 BUFR MESSAGE</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="keywordtype">INTEGER</span>        KFXY2(200),ISCAL2(200),IRFVL2(200),IWIDE2(200)</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="keywordtype">CHARACTER*64</span>   ANAME2(200)</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="keywordtype">CHARACTER*24</span>   AUNIT2(200)</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">C           NEW         ADDED TABLE B FROM NON-TYPE 11 BUFR MESSAGE</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">C     INTEGER        KFXY3(200),ISCAL3(200),IRFVL3(200),IWIDE3(200)</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">C     CHARACTER*64   ANAME3(200)</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">C     CHARACTER*24   AUNIT3(200)</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">C                       NEW BASE TABLE D</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="keywordtype">INTEGER</span>        ITBLD(20,400)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">C                       ANCILLARY TABLE D FROM TYPE 11 BUFR MESSAGE</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="keywordtype">INTEGER</span>        ITBLD2(20,50)</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="keywordtype">SAVE</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">cdak KEYSER fix 02/02/2001 VVVVV</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keyword">DATA</span>              iold11/0/</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keyword">DATA</span>              ioldtb/-99/</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">cdak KEYSER fix 02/02/2001 AAAAA</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <span class="keyword">CALL </span><a class="code" href="w3fi01_8f.html#a10ac20498f7eca8e2281cad1218bede4">w3fi01</a>(lw)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      iptr(45) = lw</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      iptr(44) = lw * 8</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      blank  = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <span class="keywordflow">IF</span> (<a class="code" href="mova2i_8f.html#aed1be7b63ac5c89c04f701e75bb4fbe0">mova2i</a>(blank).EQ.32) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;          iptr(37) = 1</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">C         PRINT *,&#39;ASCII MACHINE&#39;</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;          iptr(37) = 0</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">C         PRINT *,&#39;EBCDIC MACHINE&#39;</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">C     PRINT *,&#39; W3FI88 DECODER&#39;</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">C                            INITIALIZE ERROR RETURN</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      iptr(1)   = 0</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <span class="keywordflow">IF</span> (index.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">C                                 HAVE RE-ENTRY</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;          index   = index + 1</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">C         PRINT *,&#39;RE-ENTRY LOOKING FOR SUBSET NR&#39;,INDEX</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;          <span class="keywordflow">IF</span> (index.GT.ident(14)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">C                                 ALL SUBSETS PROCESSED</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;              iptr(1)  = 99</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;              iptr(38) = 0</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;              iptr(39) = 0</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (index.LE.ident(14)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;              <span class="keywordflow">IF</span> (iptr(39).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                  <span class="keywordflow">DO</span> 3000 j =1, iptr(13)</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                      iwork(j)  = istack(j)</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; 3000             <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                  iptr(12)  = iptr(13)</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                 <span class="keyword">CALL </span><a class="code" href="w3fi88_8f.html#ae5d0192919fea00763c2ea1490bff16a">fi8801</a>(iptr,ident,msga,istack,iwork,kdata,ivals,</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;     *           mstack,knr,index,maxr,maxd,</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;     *           kfxy1,aname1,aunit1,iscal1,irfvl1,iwide1,irf1sw,inewvl,</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;     *           kfxy2,aname2,aunit2,iscal2,irfvl2,iwide2,</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;     *           kfxy3,aname3,aunit3,iscal3,irfvl3,iwide3,</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;     *           iunitb,iunitd,itbld,itbld2,kptrb,kptrd)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;          <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;          index  = 1</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">C         PRINT *,&#39;INITIAL ENTRY FOR THIS BUFR MESSAGE&#39;</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      iptr(39)  = 0</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">C                        FIND &#39;BUFR&#39; IN FIRST 125 CHARACTERS</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <span class="keywordflow">DO</span> 1000 knofst = 0, 999, 8</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;          inofst     = knofst</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;          <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,8)</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;          <span class="keywordflow">IF</span> (ivals(1).EQ.66) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;              iptr(19)   = inofst</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;              inofst     = inofst + 8</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;              <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,24)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;              <span class="keywordflow">IF</span> (ivals(1).EQ.5588562) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">C                 PRINT *,&#39;FOUND BUFR AT&#39;,IPTR(19)</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                  inofst     = inofst + 24</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                  <span class="keywordflow">GO TO</span> 1500</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; 1000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      print *,<span class="stringliteral">&#39;BUFR - START OF BUFR MESSAGE NOT FOUND&#39;</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      iptr(1)    = 1</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; 1500 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      ident(1)   = 0</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">C                            TEST FOR EDITION NUMBER</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">C  ======================</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ident(1),inofst+24,8)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">C     PRINT *,&#39;THIS IS AN EDITION&#39;,IDENT(1),&#39; BUFR MESSAGE&#39;</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <span class="keywordflow">IF</span> (ident(1).GE.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">C                           GET TOTAL COUNT</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;          <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,24)</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;          itotal   = ivals(1)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;          kender   = itotal * 8 - 32 + iptr(19)</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;          <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ilast,kender,32)</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">C         IF (ILAST.EQ.926365495) THEN</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">C             PRINT *,&#39;HAVE TOTAL COUNT FROM SEC 0&#39;,IVALS(1)</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">C         END IF</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;          inofst     = inofst + 32</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">C                           GET SECTION 1 COUNT</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;          iptr(3)  = inofst</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;          <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,24)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">C         PRINT *,&#39;SECTION 1 STARTS AT&#39;,INOFST,&#39;  SIZE&#39;,IVALS(1)</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;          inofst     = inofst + 24</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;          iptr( 2)   = ivals(1)</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">C                           GET MASTER TABLE</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;          <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,8)</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;          inofst     = inofst + 8</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;          ident(17)  = ivals(1)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">C         PRINT *,&#39;BUFR MASTER TABLE NR&#39;,IDENT(17)</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;          iptr(3)    = inofst</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">C                           GET SECTION 1 COUNT</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;          <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,24)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">C         PRINT *,&#39;SECTION 1 STARTS AT&#39;,INOFST,&#39;  SIZE&#39;,IVALS(1)</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;          inofst     = inofst + 32</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;          iptr( 2)   = ivals(1)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">C  ======================</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">C                            ORIGINATING CENTER</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,16)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      inofst     = inofst + 16</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      ident(2)   = ivals(1)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">C                            UPDATE SEQUENCE</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,8)</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      inofst     = inofst + 8</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      ident(3)   = ivals(1)</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">C                            OPTIONAL SECTION FLAG</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,1)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      ident(4)   = ivals(1)</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="keywordflow">IF</span> (ident(4).GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;          sec2       = .true.</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">C         PRINT *,&#39;              NO OPTIONAL SECTION 2&#39;</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;          sec2       = .false.</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      inofst     = inofst + 8</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">C                            MESSAGE TYPE</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,8)</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      ident(5)   = ivals(1)</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      inofst     = inofst + 8</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">C                            MESSAGE SUBTYPE</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,8)</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      ident(6)   = ivals(1)</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      inofst     = inofst + 8</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">cdak KEYSER fix 02/02/2001 VVVVV</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="keywordflow">IF</span> (iunitb.NE.ioldtb) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">C                IF HAVE A CHANGE IN TABLE B UNIT NUMBER , READ TABLE B</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;          <span class="keywordflow">IF</span>(ioldtb.NE.-99)  print *, <span class="stringliteral">&#39;W3FI88 - NEW TABLE B UNIT NUMBER&#39;</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;          ioldtb = iunitb</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;          iptr(14)  = 0</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;          iptr(21)  = 0</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">cdak KEYSER fix 02/02/2001 AAAAA</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">C                            IF HAVE CHANGE IN DATA TYPE , RESET TABLE B</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      <span class="keywordflow">IF</span> (iold11.EQ.11) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;          iold11 = ident(5)</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;          ioldsb = ident(6)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">C                            JUST CONTINUE PROCESSING</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (iold11.NE.11) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;          <span class="keywordflow">IF</span> (ident(5).EQ.11) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;              iold11  = ident(5)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;              iptr(21) = 0</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (ident(5).NE.iold11) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;              iold11  = ident(5)</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;              iptr(21) = 0</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (ident(5).EQ.iold11) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">C                      IF HAVE A CHANGE IN SUBTYPE, RESET TABLE B</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;              <span class="keywordflow">IF</span> (ioldsb.NE.ident(6)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                  ioldsb  = ident(6)</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                  iptr(21)  = 0</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">C             ELSE IF</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">C                           IF BUFR EDITION 0 OR 1 THEN</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">C                                 NEXT 2 BYTES ARE BUFR TABLE VERSION</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">C                           ELSE</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">C                               BYTE 11 IS VER NR OF MASTER TABLE</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">C                               BYTE 12 IS VER NR OF LOCAL TABLE</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <span class="keywordflow">IF</span> (ident(1).LT.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;          <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,16)</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;          ident(7)   = ivals(1)</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;          inofst     = inofst + 16</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">C                               BYTE 11 IS VER NR OF MASTER TABLE</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;          <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,8)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;          ident(18)  = ivals(1)</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;          inofst     = inofst + 8</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">C                               BYTE 12 IS VER NR OF LOCAL TABLE</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;          <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,8)</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          ident(19)  = ivals(1)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;          inofst     = inofst + 8</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">C                            YEAR OF CENTURY</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,8)</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      ident(8)   = ivals(1)</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      inofst     = inofst + 8</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">C                            MONTH</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,8)</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      ident(9)   = ivals(1)</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      inofst     = inofst + 8</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">C                            DAY</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">C     PRINT *,&#39;DAY AT &#39;,INOFST</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,8)</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      ident(10)  = ivals(1)</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      inofst     = inofst + 8</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">C                            HOUR</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,8)</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      ident(11)  = ivals(1)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      inofst     = inofst + 8</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">C                            MINUTE</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,8)</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      ident(12)  = ivals(1)</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">C                            RESET POINTER (INOFST) TO START OF</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">C                                NEXT SECTION</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">C                                (SECTION 2 OR SECTION 3)</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      inofst     = iptr(3) + iptr(2) * 8</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      iptr(4)    = 0</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      iptr(5)    = inofst</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="keywordflow">IF</span> (sec2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">C                            SECTION 2 COUNT</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;          <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,iptr(4),inofst,24)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;          inofst   = inofst + 32</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">C         PRINT *,&#39;SECTION 2 STARTS AT&#39;,INOFST,&#39; BYTES=&#39;,IPTR(4)</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;          kentry  = (iptr(4) - 4) / 14</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">C         PRINT *,&#39;SHOULD BE A MAX OF&#39;,KENTRY,&#39; REPORTS&#39;</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;          <span class="keywordflow">IF</span> (ident(2).EQ.7) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;              <span class="keywordflow">DO</span> 2000 i = 1, kentry</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,kdspl ,inofst,16)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                  inofst  = inofst + 16</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,lat   ,inofst,16)</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                  inofst  = inofst + 16</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,lon   ,inofst,16)</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                  inofst  = inofst + 16</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,kdahr ,inofst,16)</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                  inofst  = inofst + 16</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,dirid(1),inofst,32)</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                  inofst  = inofst + 32</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,dirid(2),inofst,16)</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                  inofst  = inofst + 16</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">C                 PRINT *,KDSPL,LAT,LON,KDAHR,DIRID(1),DIRID(2)</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; 2000         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">C                            RESET POINTER (INOFST) TO START OF</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">C                                SECTION 3</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;          inofst     = iptr(5) + iptr(4) * 8</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">C                            BIT OFFSET TO START OF SECTION 3</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      iptr( 7)   = inofst</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">C                            SECTION 3 COUNT</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,iptr(6),inofst,24)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">C     PRINT *,&#39;SECTION 3 STARTS AT&#39;,INOFST,&#39; BYTES=&#39;,IPTR(6)</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      inofst     = inofst + 24</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">C                           SKIP RESERVED BYTE</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      inofst     = inofst + 8</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">C                            NUMBER OF DATA SUBSETS</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ident(14),inofst,16)</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      <span class="keywordflow">IF</span> (ident(14).GT.maxr) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;          print *,<span class="stringliteral">&#39;THE NUMBER OF SUBSETS EXCEEDS THE MAXIMUM OF&#39;</span>,maxr</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;          print *,<span class="stringliteral">&#39;PASSED INTO W3FI88; MAXR MUST BE INCREASED IN &#39;</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;          print *,<span class="stringliteral">&#39;THE CALLING PROGRAM TO AT LEAST THE VALUE OF&#39;</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;          print *,ident(14),<span class="stringliteral">&#39;TO BE ABLE TO PROCESS THIS DATA&#39;</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;          iptr(1)  = 400</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;          <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      inofst     = inofst + 16</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">C                            OBSERVED DATA FLAG</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,1)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      ident(15)  = ivals(1)</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      inofst     = inofst + 1</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">C                            COMPRESSED DATA FLAG</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,1)</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      ident(16)  = ivals(1)</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      inofst     = inofst + 7</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">C                            CALCULATE NUMBER OF DESCRIPTORS</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      nrdesc     = (iptr( 6) - 8) / 2</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      iptr(12)   = nrdesc</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      iptr(13)   = nrdesc</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">C                            EXTRACT DESCRIPTORS</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keyword">CALL </span><a class="code" href="gbytes_8f.html#ac957b0c87f1261d8460c52bfec7d0308">gbytes</a> (msga,istack,inofst,16,0,nrdesc)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">C     PRINT *,&#39;INITIAL DESCRIPTOR LIST OF&#39;,NRDESC,&#39; DESCRIPTORS&#39;</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <span class="keywordflow">DO</span> 10 l = 1, nrdesc</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;          iwork(l)   = istack(l)</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">C         PRINT *,L,ISTACK(L)</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      iptr(13)   = nrdesc</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">C  ===============================================================</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">C                            CONSTRUCT A TABLE B TO MATCH THE</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">C                            LIST OF DESCRIPTORS FOR THIS MESSAGE</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <span class="keywordflow">IF</span> (iptr(21).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;          print *,<span class="stringliteral">&#39;W3FI88- TABLE B NOT YET ENTERED&#39;</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;          <span class="keyword">CALL </span>fi8812(iptr,iunitb,iunitd,istack,nrdesc,kptrb,kptrd,</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;     *                     irf1sw,newref,itbld,itbld2,</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;     *                     kfxy1,aname1,aunit1,iscal1,irfvl1,iwide1,</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;     *                     kfxy2,aname2,aunit2,iscal2,irfvl2,iwide2)</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">C         PRINT *,&#39;W3FI88- TABLE B ALL READY IN PLACE&#39;</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;          <span class="keywordflow">IF</span> (iptr(41).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">C             PRINT *,&#39;MERGE&#39;,IPTR(41),&#39; ENTRIES INTO TABLE B&#39;</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">C             CALL FI8818(IPTR,KFXY1,ANAME1,AUNIT1,ISCAL1,IRFVL1,IWIDE1,</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">C    *                 KFXY2,ANAME2,AUNIT2,ISCAL2,IRFVL2,IWIDE2,KPTRB)</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <span class="keywordflow">IF</span> (iptr(1).NE.0) <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">C ================================================================</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">C                            RESET POINTER TO START OF SECTION 4</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      inofst     = iptr(7) + iptr(6) * 8</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">C                            BIT OFFSET TO START OF SECTION 4</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      iptr( 9)   = inofst</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">C                            SECTION 4 COUNT</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,inofst,24)</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">C     PRINT *,&#39;SECTION 4 STARTS AT&#39;,INOFST,&#39; VALUE&#39;,IVALS(1)</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      iptr( 8)   = ivals(1)</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      inofst     = inofst + 32</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">C                            SET FOR STARTING BIT OF DATA</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      iptr(25)   = inofst</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">C                            FIND OUT IF &#39;7777&#39; TERMINATOR IS THERE</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      inofst     = iptr(9) + iptr(8) * 8</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a>  (msga,ivals,inofst,32)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">C     PRINT *,&#39;SECTION 5 STARTS AT&#39;,INOFST,&#39; VALUE&#39;,IVALS(1)</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="keywordflow">IF</span> (ivals(1).NE.926365495) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;          print *,<span class="stringliteral">&#39;BAD SECTION COUNT&#39;</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;          iptr(1)     = 2</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;          <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;          iptr(1)     = 0</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <span class="keyword">CALL </span><a class="code" href="w3fi88_8f.html#ae5d0192919fea00763c2ea1490bff16a">fi8801</a>(iptr,ident,msga,istack,iwork,kdata,ivals,</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;     *           mstack,knr,index,maxr,maxd,</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;     *           kfxy1,aname1,aunit1,iscal1,irfvl1,iwide1,irf1sw,inewvl,</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;     *           kfxy2,aname2,aunit2,iscal2,irfvl2,iwide2,</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;     *           kfxy3,aname3,aunit3,iscal3,irfvl3,iwide3,</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;     *           iunitb,iunitd,itbld,itbld2,kptrb,kptrd)</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">C     PRINT *,&#39;HAVE RETURNED FROM FI8801&#39;</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      <span class="keywordflow">IF</span> (iptr(1).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;          <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">C                FURTHER PROCESSING REQUIRED FOR PROFILER DATA</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="keywordflow">IF</span> (ident(5).EQ.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;          <span class="keywordflow">IF</span> (ident(6).EQ.7) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">C             PRINT *,&#39;REFORMAT PROFILER DATA&#39;</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">C             DO 7151 I = 1, 40</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">C                 IF (I.LE.20) THEN</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">C                     PRINT *,&#39;IPTR(&#39;,I,&#39;)=&#39;,IPTR(I),</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">C    *                                       &#39; IDENT(&#39;,I,&#39;)= &#39;,IDENT(I)</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">C                 ELSE</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">C                     PRINT *,&#39;IPTR(&#39;,I,&#39;)=&#39;,IPTR(I)</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">C                 END IF</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">C7151         CONTINUE</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">C             DO 152 I = 1, IPTR(31)</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">C                 PRINT *,MSTACK(1,I),MSTACK(2,I),(KDATA(J,I),J=1,5)</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">C 152         CONTINUE</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;              <span class="keywordflow">IF</span> (ident(1).LT.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="w3fi88_8f.html#a334e81d3c01ac71a02ef5425671e7bf0">fi8809</a>(ident,mstack,kdata,iptr,maxr,maxd)</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="w3fi88_8f.html#adad8332e2168ab134f2c6f879f133a5f">fi8810</a>(ident,mstack,kdata,iptr,maxr,maxd)</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">C             DO 151 I = 1, 40</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">C                 IF (I.LE.20) THEN</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">C                     PRINT *,&#39;IPTR(&#39;,I,&#39;)=&#39;,IPTR(I),</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">C    *                                       &#39; IDENT(&#39;,I,&#39;)= &#39;,IDENT(I)</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">C                 ELSE</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">C                     PRINT *,&#39;IPTR(&#39;,I,&#39;)=&#39;,IPTR(I)</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">C                 END IF</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">C 151         CONTINUE</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;              <span class="keywordflow">IF</span> (iptr(1).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                  <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="keywordflow">              END  IF</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">C             DO 154 I = 1, IPTR(31)</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">C                PRINT *,I,MSTACK(1,I),MSTACK(2,I),KDATA(1,I),KDATA(2,I)</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">C 154         CONTINUE</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">C                        IF DATA/DESCRIPTOR REPLICATION FLAG IS ON,</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">C                         MUST COMPLETE EXPANSION OF DATA AND</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">C                          DESCRIPTORS.</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <span class="keywordflow">IF</span> (iptr(38).EQ.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;          <span class="keyword">CALL </span><a class="code" href="w3fi88_8f.html#a12b020b46772271cab997bb781bda9c1">fi8811</a>(iptr,ident,mstack,kdata,knr,</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;     *                  ldata,lstack,maxd,maxr)</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">C                        IF HAVE A LIST OF TABLE ENTRIES FROM</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">C                        A BUFR MESSAGE TYPE 11</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">C                        PRINT OUT THE ENTRIES</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="keywordflow">IF</span> (ident(5).EQ.11) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">C         DO 100 I = 1, IPTR(31)+IPTR(24)</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">C             PRINT *,I,MSTACK(1,I),(KDATA(J,I),J=1,4)</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">C 100     CONTINUE</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;          <span class="keyword">CALL </span>fi8813 (iptr,maxr,maxd,mstack,kdata,ident,kptrd,kptrb,</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;     *         itbld,aname1,aunit1,kfxy1,iscal1,irfvl1,iwide1,iunitb)</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">C&gt; @brief Data extraction</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1988-09-01</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment">C&gt; Control the extraction of data from section 4 based on data descriptors.</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment">C&gt; Program history log:</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1988-09-01\</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1991-01-18 Corrections to properly handle non-compressed</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">C&gt;                         DATA.</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1991-09-23 Coding added to handle single subsets with</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">C&gt;                         DELAYED REPLICATION.</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1992-01-24 Modified to echo descriptors to mstack(1,n)</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">C&gt; - Dennis Keyser 1995-06-07 Corrected an error which required input</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">C&gt; argument &quot;maxd&quot; to be nearly twice as large</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">C&gt; as needed for decoding wind profiler reports</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">C&gt; (limit upper bound for &quot;iwork&quot; array was set</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">C&gt; to &quot;maxd&quot;, now it is set to 15000)</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment">C&gt; @param[in] IPTR See w3fi88() routine docblock</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment">C&gt; @param[in] IDENT See w3fi88() routine docblock</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment">C&gt; @param[in] MSGA Array containing bufr message</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment">C&gt; @param[inout] ISTACK Original array of descriptors extracted from</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">C&gt; source bufr message.</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">C&gt; @param[in] MSTACK Working array of descriptors (expanded)and scaling</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">C&gt; factor</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">C&gt; @param[inout] KFXY1+KFXY2+KFXY3 Image of current descriptor</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">C&gt; @param[in] INDEX</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">C&gt; @param[in] MAXR Maximum number of reports/subsets that may be</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">C&gt; contained in a bufr message</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">C&gt; @param[in] MAXD Maximum number of descriptor combinations that</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">C&gt; may be processed; upper air data and some satellite</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">C&gt; data require a value for maxd of 1700, but for most</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">C&gt; other data a value for maxd of 500 will suffice</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">C&gt; @param[in] IUNITB Unit number of data set holding table b</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment">C&gt; @param[in] IUNITD Unit number of data set holding table d</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">C&gt; @param[out] IWORK Working descriptor list</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">C&gt; @param[out] KDATA Array containing decoded reports from bufr message.</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">C&gt; KDATA(Report number,parameter number)</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">C&gt; (report number limited to value of input argument</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">C&gt;  maxr and parameter number limited to value of input</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">C&gt;  argument maxd)</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">C&gt; arrays containing data from table b</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">C&gt; @param[out] AUNIT1+AUNIT2+AUNIT3 Units for descriptor</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">C&gt; @param[out] ANAME1+ANAME2+ANAME3 Descriptor name</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">C&gt; @param[out] ISCAL1+ISCAL2+ISCAL3 Scale for value of descriptor</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">C&gt; @param[out] IRFVL1+IRFVL2+IRFVL3 Reference value for descriptor</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">C&gt; @param[out] IWIDE1+IWIDE2+IWIDE3 Bit width for value of descriptor</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">C&gt; @param ITBLD+ITBLD2</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">C&gt; @param KPTRB</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">C&gt; @param KPTRD</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">C&gt; @param KNR</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">C&gt; @param IVALS</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">C&gt; @param IRF1SW</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">C&gt; @param INEWVL</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">C&gt; Error return:</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">C&gt; - IPTR(1)</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">C&gt;  - = 8 Error reading table b</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">C&gt;  - = 9 Error reading table d</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">C&gt;  - = 11 Error opening table b</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1988-09-01</span></div>
<div class="line"><a name="l00967"></a><span class="lineno"><a class="line" href="w3fi88_8f.html#ae5d0192919fea00763c2ea1490bff16a">  967</a></span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="w3fi88_8f.html#ae5d0192919fea00763c2ea1490bff16a">fi8801</a>(IPTR,IDENT,MSGA,ISTACK,IWORK,KDATA,IVALS,</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;     *        MSTACK,KNR,INDEX,MAXR,MAXD,</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;     *        KFXY1,ANAME1,AUNIT1,ISCAL1,IRFVL1,IWIDE1,IRF1SW,INEWVL,</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;     *        KFXY2,ANAME2,AUNIT2,ISCAL2,IRFVL2,IWIDE2,</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;     *        KFXY3,ANAME3,AUNIT3,ISCAL3,IRFVL3,IWIDE3,</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;     *        IUNITB,IUNITD,ITBLD,ITBLD2,KPTRB,KPTRD)</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">C        NEW            ANCILLARY TABLE B FROM TYPE 11 BUFR MESSAGE</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <span class="keywordtype">INTEGER</span>        KFXY2(*),ISCAL2(*),IRFVL2(*),IWIDE2(*)</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <span class="keywordtype">CHARACTER*64</span>   ANAME2(*)</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <span class="keywordtype">CHARACTER*24</span>   AUNIT2(*)</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">C           NEW         ADDED TABLE B FROM NON-TYPE 11 BUFR MESSAGE</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      <span class="keywordtype">INTEGER</span>        KFXY3(200),ISCAL3(200),IRFVL3(200),IWIDE3(200)</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="keywordtype">CHARACTER*64</span>   ANAME3(200)</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <span class="keywordtype">CHARACTER*24</span>   AUNIT3(200)</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">C     NEW               BASE TABLE B</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">C                            MAY BE A COMBINATION OF MASTER TABLE B</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">C                            AND ANCILLARY TABLE B</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      <span class="keywordtype">INTEGER</span>        KFXY1(*),ISCAL1(*),IRFVL1(3,*),IWIDE1(*)</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <span class="keywordtype">CHARACTER*40</span>   ANAME1(*)</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      <span class="keywordtype">CHARACTER*24</span>   AUNIT1(*)</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">C                       ANCILLARY TABLE D FROM TYPE 11 BUFR MESSAGE</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <span class="keywordtype">INTEGER</span>        ITBLD2(20,*)</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">C                       NEW BASE TABLE D</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      <span class="keywordtype">INTEGER</span>        ITBLD(20,*)</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      <span class="keywordtype">INTEGER</span>        MAXD, MAXR</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      <span class="keywordtype">INTEGER</span>        MSGA(*),KDATA(MAXR,MAXD),IVALS(*)</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      <span class="keywordtype">INTEGER</span>        KNR(MAXR)</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="keywordtype">INTEGER</span>        LX,LY,LL,J</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">C     INTEGER        IHOLD(33)</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      <span class="keywordtype">INTEGER</span>        IPTR(*),KPTRB(*),KPTRD(*)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      <span class="keywordtype">INTEGER</span>        IDENT(*)</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <span class="keywordtype">INTEGER</span>        ISTACK(*),IWORK(*)</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      <span class="keywordtype">INTEGER</span>        MSTACK(2,MAXD)</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      <span class="keywordtype">INTEGER</span>        JDESC</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      <span class="keywordtype">INTEGER</span>        INDEX</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      <span class="keywordtype">SAVE</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">C     PRINT *,&#39; DECOLL FI8801&#39;</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      <span class="keywordflow">IF</span> (index.GT.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;              <span class="keywordflow">GO TO</span> 1000</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">C                      ---------  DECOLL  ---------------</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      iptr(23)    = 0</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      iptr(26)    = 0</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      iptr(27)    = 0</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      iptr(28)    = 0</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      iptr(29)    = 0</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      iptr(30)    = 0</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      iptr(36)    = 0</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">C                            INITIALIZE OUTPUT AREA</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">C                              SET POINTER TO BEGINNING OF DATA</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">C                                   SET BIT</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      iptr(17)   = 1</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; 1000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">C     IPTR(12)   = IPTR(13)</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      ll         = 0</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      iptr(11)   = 1</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <span class="keywordflow">IF</span> (iptr(10).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">C                              RE-ENTRY POINT FOR MULTIPLE</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">C                                 NON-COMPRESSED REPORTS</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;          index     = iptr(15)</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;          iptr(17)  = index</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;          iptr(25)  = iptr(10)</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;          iptr(10)  = 0</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;          iptr(15)  = 0</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">C     PRINT *,&#39;FI8801 - RPT&#39;,IPTR(17),&#39;  STARTS AT&#39;,IPTR(25)</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      iptr(24)  = 0</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      iptr(31)  = 0</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">C                              POINTING AT NEXT AVAILABLE DESCRIPTOR</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      mm         = 0</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <span class="keywordflow">IF</span> (iptr(21).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;          nrdesc  = iptr(13)</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;          <span class="keyword">CALL </span>fi8812(iptr,iunitb,iunitd,istack,nrdesc,kptrb,kptrd,</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;     *                     irf1sw,newref,itbld,itbld2,</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;     *                     kfxy1,aname1,aunit1,iscal1,irfvl1,iwide1,</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;     *                     kfxy2,aname2,aunit2,iscal2,irfvl2,iwide2)</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;   10     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">C                              PROCESS THRU THE FOLLOWING</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">C                              DEPENDING UPON THE VALUE OF &#39;F&#39; (LF)</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;          mm     = mm + 1</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;   12     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;          <span class="keywordflow">IF</span> (mm.GT.maxd) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;              <span class="keywordflow">GO TO</span> 200</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">C                            END OF CYCLE TEST (SERIAL/SEQUENTIAL)</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;          <span class="keywordflow">IF</span> (iptr(11).GT.iptr(12)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">C             PRINT *,&#39; HAVE COMPLETED REPORT SEQUENCE&#39;</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;              <span class="keywordflow">IF</span> (ident(16).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">C                 PRINT *,&#39; PROCESSING COMPRESSED REPORTS&#39;</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">C                            REFORMAT DATA FROM DESCRIPTOR</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">C                            FORM TO USER FORM</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                  <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">C                 WRITE (6,1)</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">C   1             FORMAT (1H1)</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">C                 PRINT *,&#39; PROCESSED SERIAL REPORT&#39;,IPTR(17),IPTR(25)</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                  iptr(17) = iptr(17) + 1</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                  <span class="keywordflow">IF</span> (iptr(17).GT.ident(14)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                      iptr(17)  = iptr(17) - 1</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                      <span class="keywordflow">GO TO</span> 200</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                  <span class="keywordflow">DO</span> 300 i = 1, iptr(13)</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                      iwork(i)  = istack(i)</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  300             <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">C                             RESET POINTERS</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                  ll       = 0</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                  iptr(1)   = 0</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                  iptr(11)  = 1</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                  iptr(12)  = iptr(13)</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">C                         IS THIS LAST REPORT ?</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">C                 PRINT *,&#39;READY&#39;,IPTR(39),INDEX</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                  <span class="keywordflow">IF</span> (iptr(39).GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                      <span class="keywordflow">IF</span> (index.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">C                         PRINT *,&#39;HERE IS SUBSET NR&#39;,INDEX</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                          <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="keywordflow">                      END IF</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                  <span class="keywordflow">GO TO</span> 1000</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;   14     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="comment">C                               GET NEXT DESCRIPTOR</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;          <span class="keyword">CALL </span><a class="code" href="w3fi88_8f.html#a2a7856fc62e88d8fa8670e58c4082293">fi8808</a> (iptr,iwork,lf,lx,ly,jdesc)</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">C         PRINT *,IPTR(11)-1,&#39;JDESC= &#39;,JDESC,&#39; AND NEXT &#39;,</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">C    *                       IPTR(11),IWORK(IPTR(11)),IPTR(31)</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">C         PRINT *,IPTR(11)-1,&#39;DESCRIPTOR&#39;,JDESC,LF,LX,LY,</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">C    *       &#39; FOR LOC&#39;,IPTR(17),IPTR(25)</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">CVVVVVCHANGE#2 FIX BY KEYSER  -- 12/06/1994</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment">C  NOTE: THIS FIX NEEDED BECAUSE IWORK ARRAY DOES NOT HAVE TO BE</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment">C        LIMITED TO SIZE OF &quot;MAXD&quot; -- WASTES SPACE BECAUSE &quot;MAXD&quot;</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment">C        MUST BECOME OVER TWICE AS LARGE AS NEEDED FOR PROFILERS</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">C        IN ORDER TO AVOID SATISFYING THIS BELOW IF TEST</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">CDAK      IF (IPTR(11).GT.MAXD) THEN</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;          <span class="keywordflow">IF</span> (iptr(11).GT.15000) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment">CAAAAACHANGE#2 FIX BY KEYSER -- 12/06/1994</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;              iptr(1)  = 401</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;              <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;              kprm        = iptr(31) + iptr(24)</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;              <span class="keywordflow">IF</span> (kprm.GT.maxd) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                  <span class="keywordflow">IF</span> (kprm.GT.kold) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                      print *,<span class="stringliteral">&#39;EXCEEDED  ARRAY SIZE&#39;</span>,kprm,iptr(31),</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;     *                        iptr(24)</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                      kold  = kprm</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">C                          REPLICATION PROCESSING</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;          <span class="keywordflow">IF</span> (lf.EQ.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment">C                                        ----------  F1  ---------</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;              iptr(31)    = iptr(31) + 1</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;              kprm        = iptr(31) + iptr(24)</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;              mstack(1,kprm)       = jdesc</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;              mstack(2,kprm)       = 0</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;              kdata(iptr(17),kprm) = 0</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment">C             PRINT *,&#39;FI8801-1&#39;,KPRM,MSTACK(1,KPRM),</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment">C    *                       MSTACK(2,KPRM),KDATA(IPTR(17),KPRM)</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;              <span class="keyword">CALL </span><a class="code" href="w3fi88_8f.html#a45180c8723bc0f7b3eaff47b7fda7ed8">fi8805</a>(iptr,ident,msga,iwork,lx,ly,</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;     *                       kdata,ll,knr,mstack,maxr,maxd)</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment">C    *                              KDATA,LL,KNR,MSTACK,MAXR,MAXD)</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;              <span class="keywordflow">IF</span> (iptr(1).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                  <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                  <span class="keywordflow">GO TO</span> 12</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">C                             DATA DESCRIPTION OPERATORS</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (lf.EQ.2)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;              <span class="keywordflow">IF</span> (lx.EQ.4) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                  iptr(31)       = iptr(31) + 1</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                  kprm           = iptr(31) + iptr(24)</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                  mstack(1,kprm) = jdesc</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                  mstack(2,kprm) = 0</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                  kdata(iptr(17),kprm) = 0</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">C                 PRINT *,&#39;FI8801-2&#39;,KPRM,MSTACK(1,KPRM),</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment">C    *                       MSTACK(2,KPRM),KDATA(IPTR(17),KPRM)</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;              <span class="keyword">CALL </span><a class="code" href="w3fi88_8f.html#a119b554db1325ff6b2d3742797f107dd">fi8806</a> (iptr,lx,ly,ident,msga,kdata,ivals,mstack,</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;     *          iwide1,irfvl1,iscal1,j,ll,kfxy1,iwork,jdesc,maxr,maxd,</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;     *          kptrb)</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;              <span class="keywordflow">IF</span> (iptr(1).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                  <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;              <span class="keywordflow">GO TO</span> 12</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment">C                              DESCRIPTOR SEQUENCE STRINGS</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (lf.EQ.3) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment">C             PRINT *,&#39;F3  SEQUENCE DESCRIPTOR&#39;</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">C                                  READ IN TABLE D, BUT JUST ONCE</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;              <span class="keywordflow">IF</span> (iptr(20).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                  <span class="keyword">CALL </span>fi8820 (itbld,iunitd,iptr,itbld2,kptrd)</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                  <span class="keywordflow">IF</span> (iptr(1).GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                       <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment">C             ELSE</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">C                 IF (IPTR(42).NE.0) THEN</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">C                     PRINT *,&#39;MERGE&#39;,IPTR(42),&#39; ENTRIES INTO TABLE D&#39;</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">C                     CALL FI8819(IPTR,ITBLD,ITBLD2,KPTRD)</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">C                 END IF</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;              <span class="keyword">CALL </span><a class="code" href="w3fi88_8f.html#aa56d7f5f943a7bf774c2e9ddc144595f">fi8807</a>(iptr,iwork,itbld,itbld2,jdesc,kptrd)</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;              <span class="keywordflow">IF</span> (iptr(1).GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                   <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;              <span class="keywordflow">GO TO</span> 14</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">C                              ELEMENT DESCRIPTOR PROCESSING</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;              kprm           = iptr(31) + iptr(24)</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;              <span class="keyword">CALL </span><a class="code" href="w3fi88_8f.html#a7829bc0e44ec367834a1a6d83377d428">fi8802</a>(iptr,ident,msga,kdata,kfxy1,ll,mstack,</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;     *          aunit1,iwide1,irfvl1,iscal1,jdesc,ivals,j,maxr,maxd,</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;     *          kptrb)</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">C                             TURN OFF SKIP FLAG AFTER STD DESCRIPTOR</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;              iptr(36)   = 0</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;              <span class="keywordflow">IF</span> (iptr(1).GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                  <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment">C                               IF ENCOUNTER CLASS 0 DESCRIPTOR</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">C                                  NOT CONTAINED WITHIN A BUFR</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">C                                  MESSAGE OF TYPE 11, THEN COLLECT</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">C                                  ALL TABLE B ENTRIES FOR USE ON</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">C                                  CURRENT BUFR MESSAGE</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                  <span class="keywordflow">IF</span> (jdesc.LE.20.AND.jdesc.GE.10) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                      <span class="keywordflow">IF</span> (ident(5).NE.11) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">C                                     COLLECT TABLE B ENTRIES</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                          <span class="keyword">CALL </span>fi8815(iptr,ident,jdesc,kdata,</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;     *                                kfxy3,maxr,maxd,aname3,aunit3,</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;     *                                iscal3,irfvl3,iwide3,</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;     *                                keyset,ibflag,ierr)</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                          <span class="keywordflow">IF</span> (ierr.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="keywordflow">                          END IF</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                          <span class="keywordflow">IF</span> (iand(ibflag,16).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                            <span class="keywordflow">IF</span> (iand(ibflag,8).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                              <span class="keywordflow">IF</span> (iand(ibflag,4).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                                <span class="keywordflow">IF</span> (iand(ibflag,2).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                                  <span class="keywordflow">IF</span> (iand(ibflag,1).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">C                                          HAVE A COMPLETE TABLE B ENTRY</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                                    iptr(43) = iptr(43) + ident(14)</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                                    keyset  = 0</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                                    ibflag  = 0</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                                    <span class="keywordflow">GO TO</span> 1000</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="keywordflow">                                  END IF</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="keywordflow">                                END IF</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="keywordflow">                              END IF</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="keywordflow">                            END IF</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="keywordflow">                          END IF</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="keywordflow">                      END IF</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                  <span class="keywordflow">IF</span> (ident(16).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                      knr(iptr(17))  = iptr(31)</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                      <span class="keywordflow">DO</span> 310 kj = 1, maxr</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                          knr(kj) = iptr(31)</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  310                 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                  <span class="keywordflow">GO TO</span> 10</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment">C     END IF</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment">C         END DO WHILE</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  200 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment">C     IF (IDENT(16).NE.0) THEN</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="comment">C         PRINT *,&#39;RETURN WITH&#39;,IDENT(14),&#39; COMPRESSED REPORTS&#39;</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment">C     ELSE</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment">C         PRINT *,&#39;RETURN WITH&#39;,IPTR(17),&#39; NON-COMPRESSED REPORTS&#39;</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">C     END IF</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment">C&gt; @brief Process element descriptor.</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1988-09-01</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160; </div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment">C&gt; Process an element descriptor (f = 0) and store data</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">C&gt; in output array.</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment">C&gt; Program history log:</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment">C&gt;   88-09-01</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment">C&gt;   91-04-04 Changed to pass width of text fields in bytes</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment">C&gt; @param[in] IPTR See w3fi88 routine docblock</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">C&gt; @param[in] IDENT See w3fi88 routine docblock</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="comment">C&gt; @param[in] MSGA Array containing bufr message</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="comment">C&gt; @param[inout] KDATA Array containing decoded reports from bufr message.</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment">C&gt; KDATA(Report number,parameter number)</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment">C&gt; (report number limited to value of input argument</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">C&gt;  maxr and parameter number limited to value of input</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment">C&gt;  argument maxd)</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment">C&gt; @param[inout] KFXY1 Image of current descriptor</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment">C&gt; @param[in] MSTACK</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment">C&gt; @param[in] MAXR Maximum number of reports/subsets that may be contained in</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="comment">C&gt; a bufr message</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="comment">C&gt; @param[in] MAXD Maximum number of descriptor combinations that</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="comment">C&gt; may be processed; upper air data and some satellite</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="comment">C&gt; data require a value for maxd of 1700, but for most</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="comment">C&gt; other data a value for maxd of 500 will suffice</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="comment">C&gt; arrays containing data from table b</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="comment">C&gt; @param[out] AUNIT1 Units for descriptor</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="comment">C&gt; @param[out] ISCAL1 Scale for value of descriptor</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment">C&gt; @param[out] IRFVL1 Reference value for descriptor</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment">C&gt; @param[out] IWIDE1 Bit width for value of descriptor</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment">C&gt; @param LL</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="comment">C&gt; @param JDESC</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="comment">C&gt; @param IVALS</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="comment">C&gt; @param J</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="comment">C&gt; @param KPTRB</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="comment">C&gt; Error return:</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="comment">C&gt; IPTR(1) = 3 - Message contains a descriptor with f=0 that does not exist</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment">C&gt; in table b.</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1988-09-01</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"><a class="line" href="w3fi88_8f.html#a7829bc0e44ec367834a1a6d83377d428"> 1307</a></span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="w3fi88_8f.html#a7829bc0e44ec367834a1a6d83377d428">fi8802</a>(IPTR,IDENT,MSGA,KDATA,KFXY1,LL,MSTACK,AUNIT1,</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;     *      IWIDE1,IRFVL1,ISCAL1,JDESC,IVALS,J,MAXR,MAXD,KPTRB)</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160; </div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="comment">C                                          TABLE B ENTRY</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      <span class="keywordtype">CHARACTER*24</span>   ASKEY</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      <span class="keywordtype">INTEGER</span>        MSGA(*)</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      <span class="keywordtype">INTEGER</span>        IPTR(*)</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      <span class="keywordtype">INTEGER</span>        KPTRB(*)</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      <span class="keywordtype">INTEGER</span>        IDENT(*)</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      <span class="keywordtype">INTEGER</span>        J</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      <span class="keywordtype">INTEGER</span>        JDESC</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <span class="keywordtype">INTEGER</span>        MSTACK(2,MAXD)</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      <span class="keywordtype">INTEGER</span>        KDATA(MAXR,MAXD),IVALS(*)</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="comment">C     NEW               BASE TABLE B</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="comment">C                            MAY BE A COMBINATION OF MASTER TABLE B</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="comment">C                            AND ANCILLARY TABLE B</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      <span class="keywordtype">INTEGER</span>        KFXY1(*),ISCAL1(*),IRFVL1(3,*),IWIDE1(*)</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="comment">C     CHARACTER*40   ANAME1(*)</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;      <span class="keywordtype">CHARACTER*24</span>   AUNIT1(*)</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      SAVE</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      DATA  ASKEY /<span class="stringliteral">&#39;CCITT IA5               &#39;</span>/</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="comment">C     PRINT *,&#39; FI8802 - ELEMENT DESCRIPTOR &#39;,JDESC,KPTRB(JDESC)</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="comment">C                                      FIND TABLE B ENTRY</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      j  = kptrb(jdesc)</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment">C                                   HAVE A MATCH</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment">C                                        SET FLAG IF TEXT EVENT</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="comment">C     PRINT *,&#39;ASKEY=&#39;,ASKEY,&#39;AUNIT1(&#39;,J,&#39;)=&#39;,AUNIT1(J),JDESC</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      <span class="keywordflow">IF</span> (askey(1:9).EQ.aunit1(j)(1:9)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;          iptr(18)     = 1</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;          iptr(40)     = iwide1(j) / 8</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;          iptr(18)     = 0</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="comment">C     PRINT *,&#39;FI8802 - BIT WIDTH =&#39;,IWIDE1(J),IPTR(18),&#39; FOR&#39;,JDESC</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      <span class="keywordflow">IF</span> (ident(16).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment">C                                   COMPRESSED</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;          <span class="keyword">CALL </span><a class="code" href="w3fi88_8f.html#a228b9ca88ab5e42aa00c6df379ecd470">fi8803</a>(iptr,ident,msga,kdata,ivals,mstack,</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;     *                iwide1,irfvl1,iscal1,j,jdesc,maxr,maxd)</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="comment">C         IF (IPTR(1).NE.0) THEN</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="comment">C             RETURN</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="comment">C         END IF</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="comment">C                                   NOT COMPRESSED</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment">C         PRINT *,&#39; FROM FI8802&#39;,J</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;          <span class="keyword">CALL </span><a class="code" href="w3fi88_8f.html#a94b6d994b2df117c1395048caea2f86b">fi8804</a>(iptr,msga,kdata,ivals,mstack,</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;     *                  iwide1,irfvl1,iscal1,j,ll,jdesc,maxr,maxd)</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment">C         IF (IPTR(1).NE.0) THEN</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment">C             RETURN</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment">C         END IF</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="comment">C&gt; @brief Process compressed data</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1988-09-01</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160; </div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="comment">C&gt; Process compressed data and place individual elements</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="comment">C&gt; into output array.</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="comment">C&gt; Program history log:</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1988-09-01</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1991-04-04 Text handling portion of this routine</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment">C&gt; modified to hanle width of fields in bytes.</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1991-04-17 Tests showed that the same data in compressed</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment">C&gt; and uncompressed form gave different results.</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="comment">C&gt; this has been corrected.</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1991-06-21 Processing of text data has been changed to</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="comment">C&gt; provide exact reproduction of all characters.</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1994-04-11 Corrected processing of data when all values</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="comment">C&gt; the same (nbinc = 0). corrected test of lowest</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="comment">C&gt; value against proper bit mask.</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment">C&gt; - Dennis Keyser 1995-06-07 Corrected an error which resulted in</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment">C&gt; returned scale in &quot;mstack(2, ..)&quot; always</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="comment">C&gt; being set to zero for compressed data.  also,</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="comment">C&gt; scale changes were not being recognized.</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="comment">C&gt; @param[in] IPTR See w3fi88 routine docblock</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="comment">C&gt; @param[in] IDENT See w3fi88 routine docblock</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="comment">C&gt; @param[in] MSGA Array containing bufr message,mstack,</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="comment">C&gt; @param[in] IVALS Array of single parameter values</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="comment">C&gt; @param[inout] J</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="comment">C&gt; @param[in] MAXR Maximum number of reports/subsets that may be</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="comment">C&gt; contained in a bufr message</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="comment">C&gt; @param[in] MAXD Maximum number of descriptor combinations that</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment">C&gt; may be processed; upper air data and some satellite</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment">C&gt; data require a value for maxd of 1700, but for most</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="comment">C&gt; other data a value for maxd of 500 will suffice</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="comment">C&gt; @param[out] KDATA Array containing decoded reports from bufr message.</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="comment">C&gt; KDATA(Report number,parameter number)</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="comment">C&gt; (report number limited to value of input argument</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment">C&gt;  maxr and parameter number limited to value of input</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment">C&gt;  argument maxd)</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="comment">C&gt; arrays containing data from table b</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="comment">C&gt; @param[out] ISCAL1 Scale for value of descriptor</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="comment">C&gt; @param[out] IRFVL1 Reference value for descriptor</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="comment">C&gt; @param[out] IWIDE1 Bit width for value of descriptor</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="comment">C&gt; @param MSTACK</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="comment">C&gt; @param JDESC</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1988-09-01</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"><a class="line" href="w3fi88_8f.html#a228b9ca88ab5e42aa00c6df379ecd470"> 1412</a></span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="w3fi88_8f.html#a228b9ca88ab5e42aa00c6df379ecd470">fi8803</a>(IPTR,IDENT,MSGA,KDATA,IVALS,MSTACK,</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;     *                      IWIDE1,IRFVL1,ISCAL1,J,JDESC,MAXR,MAXD)</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160; </div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment">C     NEW               BASE TABLE B</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment">C                            MAY BE A COMBINATION OF MASTER TABLE B</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment">C                            AND ANCILLARY TABLE B</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="comment">C     INTEGER        KFXY1(*)</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      <span class="keywordtype">INTEGER</span>        ISCAL1(*)</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      <span class="keywordtype">INTEGER</span>        IRFVL1(3,*)</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <span class="keywordtype">INTEGER</span>        IWIDE1(*)</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="comment">C     CHARACTER*40   ANAME1(*)</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="comment">C     CHARACTER*24   AUNIT1(*)</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      <span class="keywordtype">INTEGER</span>        MAXD,MAXR</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      <span class="keywordtype">INTEGER</span>        MSGA(*),JDESC,MSTACK(2,MAXD)</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      <span class="keywordtype">INTEGER</span>        IPTR(*),IVALS(*),KDATA(MAXR,MAXD)</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      <span class="keywordtype">INTEGER</span>        NRVALS,JWIDE,IDATA</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      <span class="keywordtype">INTEGER</span>        IDENT(*)</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      <span class="keywordtype">INTEGER</span>        J</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      <span class="keywordtype">INTEGER</span>        KLOW(256)</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      <span class="keywordtype">LOGICAL</span>        TEXT</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      <span class="keywordtype">INTEGER</span>        MSK(32)</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      <span class="keywordtype">SAVE</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      <span class="keyword">DATA</span>   msk  /1,  3,  7,  15,  31,  63,  127,</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="comment">C                  1   2   3   4    5    6    7</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;     *             255,  511,  1023,  2047,  4095,</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="comment">C                  8     9     10     11     12</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;     *             8191,  16383,  32767,  65535,</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="comment">C                  13     14      15      16</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;     *             131071,  262143,  524287,</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="comment">C                  17       18       19</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;     *             1048575, 2097151,  4194303,</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="comment">C                  20       21        22</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;     *             8388607,  16777215,  33554431,</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment">C                  23        24         25</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;     *             67108863,  134217727,  268435455,</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment">C                  26         27          28</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;     *             536870911, 1073741823, 2147483647,-1     /</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="comment">C                  29         30          31          32</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;      <span class="keyword">CALL </span><a class="code" href="w3fi01_8f.html#a10ac20498f7eca8e2281cad1218bede4">w3fi01</a>(lw)</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      mwdbit  = iptr(44)</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;      <span class="keywordflow">IF</span> (iptr(45).EQ.8) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;          i        = 2147483647</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;          msk(32)  = i + i + 1</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="comment">C     PRINT *,&#39; FI8803  COMPR    J=&#39;,J,&#39; IWIDE1(J) =&#39;,IWIDE1(J),</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="comment">C    *             &#39; EXTRA BITS =&#39;,IPTR(26),&#39; START AT&#39;,IPTR(25)</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      <span class="keywordflow">IF</span> (iptr(18).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;          text    = .false.</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;          text    = .true.</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="comment">C     PRINT *,&#39;DESCRIPTOR&#39;,KPRM,JDESC</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      <span class="keywordflow">IF</span> (.NOT.text) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;          <span class="keywordflow">IF</span> (iptr(29).GT.0.AND.jdesc.NE.7957) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;<span class="comment">C             PRINT *,&#39;ASSOCIATED FIELD AT&#39;,IPTR(25)</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="comment">C                        WORKING WITH ASSOCIATED FIELDS HERE</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;              iptr(31)   = iptr(31) + 1</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;              kprm       = iptr(31) + iptr(24)</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment">C                        GET LOWEST</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;              <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,lowest,iptr(25),iptr(29))</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;              iptr(25)   = iptr(25) + iptr(29)</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="comment">C                        GET NBINC</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;              <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,nbinc,iptr(25),6)</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;              iptr(25)   = iptr(25) + 6</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="comment">C             PRINT *,&#39;LOWEST=&#39;,LOWEST,&#39; NBINC=&#39;,NBINC</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;              <span class="keywordflow">IF</span> (nbinc.GT.32) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                  iptr(1)  = 22</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                  <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="comment">C                        EXTRACT DATA FOR ASSOCIATED FIELD</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;              <span class="keywordflow">IF</span> (nbinc.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="gbytes_8f.html#ac957b0c87f1261d8460c52bfec7d0308">gbytes</a> (msga,ivals,iptr(25),nbinc,0,iptr(21))</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                  iptr(25)   = iptr(25) + nbinc * iptr(21)</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                  <span class="keywordflow">DO</span> 50 i = 1, ident(14)</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                      kdata(i,kprm) = ivals(i) + lowest</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                      <span class="keywordflow">IF</span> (nbinc.EQ.32) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                          <span class="keywordflow">IF</span> (kdata(i,kprm).EQ.msk(nbinc)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                              kdata(i,kprm) = 999999</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="keywordflow">                          END IF</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (kdata(i,kprm).GE.msk(nbinc)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                          kdata(i,kprm) = 999999</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="keywordflow">                      END IF</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;   50             <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                  <span class="keywordflow">DO</span> 51 i = 1, ident(14)</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                      kdata(i,kprm) = lowest</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                      <span class="keywordflow">IF</span> (nbinc.EQ.32) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                          <span class="keywordflow">IF</span> (lowest.EQ.msk(32)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                              kdata(i,kprm) = 999999</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="keywordflow">                          END IF</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(lowest.GE.msk(nbinc)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                          kdata(i,kprm) = 999999</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="keywordflow">                      END IF</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;   51             <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment">C                                       SET PARAMETER</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">C                                       ISOLATE COMBINED BIT WIDTH</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;          jwide     = iwide1(j) + iptr(26)</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;          <span class="keywordflow">IF</span> (jwide.GT.32) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment">C                                       TOO MANY BITS IN COMBINED</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment">C                                       BIT WIDTH</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;              print *,<span class="stringliteral">&#39;ERR 22 - HAVE EXCEEDED COMBINED BIT WIDTH&#39;</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;              iptr(1)  = 22</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;              <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="comment">C                                       SINGLE VALUE FOR LOWEST</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;          nrvals    = 1</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="comment">C                                       LOWEST</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="comment">C         PRINT *,&#39;PARAM&#39;,KPRM</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;          <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,lowest,iptr(25),jwide)</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="comment">C         PRINT *,&#39;            LOWEST=&#39;,LOWEST,&#39; AT BIT LOC &#39;,IPTR(25)</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;          iptr(25)  = iptr(25) + jwide</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="comment">C                                       ISOLATE COMPRESSED BIT WIDTH</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;          <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,nbinc,iptr(25),6)</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="comment">C         PRINT *,&#39;            NBINC=&#39;,NBINC,&#39; AT BIT LOC&#39;,IPTR(25)</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;          <span class="keywordflow">IF</span> (nbinc.GT.32) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="comment">C                                NBINC TOO LARGE</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;              iptr(1)  = 22</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;              <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;          <span class="keywordflow">IF</span> (iptr(32).EQ.2.AND.iptr(33).EQ.5) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;              <span class="keywordflow">IF</span> (nbinc.GT.jwide) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment">C                 PRINT *,&#39;FOR DESCRIPTOR&#39;,JDESC</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment">C              PRINT *,J,&#39;NBINC=&#39;,NBINC,&#39; LOWEST=&#39;,LOWEST,&#39; IWIDE1(J)=&#39;,</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment">C    *          IWIDE1(J),&#39; IPTR(26)=&#39;,IPTR(26),&#39; AT BIT LOC&#39;,IPTR(25)</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment">C                 DO 110 I = 1, KPRM</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="comment">C                     WRITE (6,111)I,(KDATA(J,I),J=1,6)</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="comment">C 110             CONTINUE</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="comment">C 111             FORMAT (1X,5HDATA ,I3,6(2X,I10))</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                  iptr(1) = 500</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                  print *,<span class="stringliteral">&#39;NBINC CALLS FOR LARGER BIT WIDTH THAN TABLE&#39;</span>,</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;     *                       <span class="stringliteral">&#39; B  PLUS  WIDTH CHANGES&#39;</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;          iptr(25)  = iptr(25) + 6</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment">C         PRINT *,&#39;LOWEST&#39;,LOWEST,&#39; NBINC=&#39;,NBINC</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">C                                       IF TEXT EVENT, PROCESS TEXT</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment">C                                       GET COMPRESSED VALUES</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="comment">C         PRINT *,&#39;COMPRESSED VALUES - NONTEXT&#39;</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;          nrvals    = ident(14)</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;          iptr(31)  = iptr(31) + 1</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;          kprm      = iptr(31) + iptr(24)</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;          <span class="keywordflow">IF</span> (nbinc.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;              <span class="keyword">CALL </span><a class="code" href="gbytes_8f.html#ac957b0c87f1261d8460c52bfec7d0308">gbytes</a> (msga,ivals,iptr(25),nbinc,0,nrvals)</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;              iptr(25)  = iptr(25) + nbinc * nrvals</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment">C                                       RECALCULATE TO ORIGINAL VALUES</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;              <span class="keywordflow">DO</span> 100 i = 1, nrvals</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="comment">C                 PRINT *,IVALS(I),MSK(NBINC),NBINC</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                  <span class="keywordflow">IF</span> (ivals(i).GE.msk(nbinc)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                      kdata(i,kprm) = 999999</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                      <span class="keywordflow">IF</span> (irfvl1(2,j).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                         jrv  = irfvl1(1,j)</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                         jrv  = irfvl1(3,j)</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="keywordflow">                     END IF</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                     kdata(i,kprm) = ivals(i) + lowest + jrv</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  100         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="comment">C             PRINT *,I,JDESC,LOWEST,IRFVL1(1,J),IRFVL1(3,J)</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;              <span class="keywordflow">IF</span> (lowest.EQ.msk(jwide)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                  <span class="keywordflow">DO</span> 105 i = 1, nrvals</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                      kdata(i,kprm)    = 999999</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  105             <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                  <span class="keywordflow">IF</span> (irfvl1(2,j).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                      jrv  = irfvl1(1,j)</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                      jrv  = irfvl1(3,j)</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                  icomb  = lowest + jrv</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                  <span class="keywordflow">DO</span> 106 i = 1, nrvals</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                      kdata(i,kprm) = icomb</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  106             <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="comment">C         PRINT *,&#39;KPRM=&#39;,KPRM,&#39;  IPTR(25)=&#39;,IPTR(25)</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;          mstack(1,kprm)  = jdesc</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="comment">C         WRITE (6,80) (KDATA(I,KPRM),I=1,10)</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;   80     <span class="keyword">FORMAT</span>(2x,10(f10.2,1x))</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="comment">CVVVVVCHANGE#3 FIX BY KEYSER  -- 12/06/1994</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="comment">C  NOTE: THIS FIX NEEDED BECAUSE THE RETURNED SCALE IN MSTACK(2,..)</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="comment">C        WAS ALWAYS &#39;0&#39; FOR COMPRESSED DATA, INCL. CHANGED SCALES)</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;          mstack(2,kprm) = iscal1(j) + iptr(27)</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<span class="comment">CAAAAACHANGE#3 FIX BY KEYSER  -- 12/06/1994</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (text) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="comment">C         PRINT *,&#39; FOUND TEXT MODE IN COMPRESSED DATA&#39;,IPTR(40)</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="comment">C                                   GET LOWEST</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="comment">C         PRINT *,&#39; PICKED UP LOWEST&#39;,(KLOW(K),K=1,IPTR(40))</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;          <span class="keywordflow">DO</span> 1906 k = 1, iptr(40)</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;              <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,klow,iptr(25),8)</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;              iptr(25)   = iptr(25) + 8</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;              <span class="keywordflow">IF</span> (klow(k).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                  iptr(1)   = 27</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                  print *,<span class="stringliteral">&#39;NON-ZERO LOWEST ON TEXT DATA&#39;</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                  <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160; 1906     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="comment">C         PRINT *,&#39;TEXT - LOWEST = 0&#39;</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="comment">C                                   GET NBINC</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;          <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,nbinc,iptr(25),6)</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;          iptr(25)     = iptr(25) + 6</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;          <span class="keywordflow">IF</span> (nbinc.NE.iptr(40)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;              iptr(1)  = 28</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;              print *,<span class="stringliteral">&#39;NBINC IS NOT THE NUMBER OF CHARACTERS&#39;</span>,nbinc</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;              <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="comment">C         PRINT *,&#39;TEXT    NBINC =&#39;,NBINC</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="comment">C                                   FOR NUMBER OF OBSERVATIONS</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;          iptr(31)      = iptr(31) + 1</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;          kprm          = iptr(31) + iptr(24)</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;          istart        = kprm</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;          i24           = iptr(24)</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;          <span class="keywordflow">DO</span> 1900 n   = 1, ident(14)</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;              kprm        = istart</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;              iptr(24)    = i24</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;              nbits       = iptr(40) * 8</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160; 1700         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="comment">C             PRINT *,N,IDENT(14),&#39;KPRM-B=&#39;,KPRM,IPTR(24),NBITS</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;              <span class="keywordflow">IF</span> (nbits.GT.mwdbit) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,idata,iptr(25),mwdbit)</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                  iptr(25)     = iptr(25) + mwdbit</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                  nbits        = nbits - mwdbit</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                  <span class="keywordflow">IF</span> (iptr(37).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="comment">C                               CONVERTS ASCII TO EBCIDIC</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                      <span class="keyword">CALL </span><a class="code" href="w3ai39_8f.html#a28ca73de8fec4c73859576d1d2e0a219">w3ai39</a> (idata,lw)</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                  mstack(1,kprm) = jdesc</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                  mstack(2,kprm) = 0</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                  kdata(n,kprm) = idata</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="comment">C                 PRINT *,&#39;TEXT        &#39;,N,KPRM,KDATA(N,KPRM)</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="comment">C                         SET FOR NEXT PART</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                  kprm          = kprm + 1</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                  iptr(24)      = iptr(24) + 1</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="comment">C                 PRINT 1701,1,KDATA(N,KPRM),N,KPRM,NBITS,IDATA</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="comment">C1701             FORMAT (1X,I1,1X,6HKDATA=,A4,2X,I5,2X,I5,2X,I5,2X,I12)</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                  <span class="keywordflow">GO TO</span> 1700</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (nbits.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,idata,iptr(25),nbits)</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                  iptr(25)     = iptr(25) + nbits</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                  ibuf         = (iptr(44) - nbits) / 8</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                  <span class="keywordflow">IF</span> (ibuf.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                      <span class="keywordflow">DO</span> 1750 mp = 1, ibuf</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                          idata  = idata * 256 + 32</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160; 1750                 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="comment">C                               CONVERTS ASCII TO EBCIDIC</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;                  <span class="keywordflow">IF</span> (iptr(37).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;                      <span class="keyword">CALL </span><a class="code" href="w3ai39_8f.html#a28ca73de8fec4c73859576d1d2e0a219">w3ai39</a> (idata,lw)</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                  mstack(1,kprm) = jdesc</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                  mstack(2,kprm) = 0</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                  kdata(n,kprm) = idata</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="comment">C                 PRINT *,&#39;TEXT        &#39;,N,KPRM,KDATA(N,KPRM)</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;<span class="comment">C                 PRINT 1701,2,KDATA(N,KPRM),N,KPRM,NBITS</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                  nbits          = 0</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="comment">C             WRITE (6,1800)N,(KDATA(N,I),I=KPRS,KPRM)</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="comment">C1800         FORMAT (2X,I4,2X,3A4)</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160; 1900     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="comment">C&gt; @brief Process serial data</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1988-09-01</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160; </div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="comment">C&gt; Process data that is not compressed</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="comment">C&gt; Program history log:</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="comment">C&gt; - Bill cavanaugh 1988-09-01</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="comment">C&gt; - Bill cavanaugh 1991-01-18 Modified to properly handle non-compressed</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="comment">C&gt; data.</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="comment">C&gt; - Bill cavanaugh 1991-04-04 Text handling portion of this routine</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="comment">C&gt; modified to handle field width in bytes.</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="comment">C&gt; - Bill cavanaugh 1991-04-17 ests showed that the same data in compressed</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="comment">C&gt; and uncompressed form gave different results.</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="comment">C&gt; this has been corrected.</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="comment">C&gt; @param[in] IPTR See w3fi88() routine docblock</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="comment">C&gt; @param[in] MSGA Array containing bufr message</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;<span class="comment">C&gt; @param[inout] IVALS Array of single parameter values</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;<span class="comment">C&gt; @param[inout] J</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="comment">C&gt; @param[in] MAXR Maximum number of reports/subsets that may be</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="comment">C&gt; contained in a bufr message</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="comment">C&gt; @param[in] MAXD Maximum number of descriptor combinations that</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="comment">C&gt; may be processed; upper air data and some satellite</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;<span class="comment">C&gt; data require a value for maxd of 1700, but for most</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="comment">C&gt; other data a value for maxd of 500 will suffice</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;<span class="comment">C&gt; @param[out] KDATA Array containing decoded reports from bufr message.</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="comment">C&gt; KDATA(Report number,parameter number)</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;<span class="comment">C&gt; (report number limited to value of input argument</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;<span class="comment">C&gt;  maxr and parameter number limited to value of input</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="comment">C&gt;  argument maxd)</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="comment">C&gt; Arrays containing data from table b</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;<span class="comment">C&gt; @param[out] ISCAL1 Scale for value of descriptor</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="comment">C&gt; @param[out] IRFVL1 Reference value for descriptor</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;<span class="comment">C&gt; @param[out] IWIDE1 Bit width for value of descriptorE</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;<span class="comment">C&gt; @param MSTACK</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="comment">C&gt; @param LL</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="comment">C&gt; @param JDESC</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="comment">C&gt; Error return:</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;<span class="comment">C&gt; IPTR(1) = 13 - Bit width on ascii chars not a multiple of 8</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1988-09-01</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"><a class="line" href="w3fi88_8f.html#a94b6d994b2df117c1395048caea2f86b"> 1731</a></span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="w3fi88_8f.html#a94b6d994b2df117c1395048caea2f86b">fi8804</a>(IPTR,MSGA,KDATA,IVALS,MSTACK,</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;     *                  IWIDE1,IRFVL1,ISCAL1,J,LL,JDESC,MAXR,MAXD)</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160; </div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="comment">C     NEW               BASE TABLE B</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="comment">C                            MAY BE A COMBINATION OF MASTER TABLE B</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="comment">C                            AND ANCILLARY TABLE B</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="comment">C     INTEGER        KFXY1(*)</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;      <span class="keywordtype">INTEGER</span>        ISCAL1(*)</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;      <span class="keywordtype">INTEGER</span>        IRFVL1(3,*)</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;      <span class="keywordtype">INTEGER</span>        IWIDE1(*)</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="comment">C     CHARACTER*40   ANAME1(*)</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="comment">C     CHARACTER*24   AUNIT1(*)</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;      <span class="keywordtype">INTEGER</span>        MSGA(*),MAXD,MAXR</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      <span class="keywordtype">INTEGER</span>        IPTR(*)</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      <span class="keywordtype">INTEGER</span>        JDESC</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      <span class="keywordtype">INTEGER</span>        IVALS(*)</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<span class="comment">C     INTEGER        LSTBLK(3)</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;      <span class="keywordtype">INTEGER</span>        KDATA(MAXR,MAXD),MSTACK(2,MAXD)</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;      <span class="keywordtype">INTEGER</span>        J,LL</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="comment">C     LOGICAL        LKEY</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;      <span class="keywordtype">INTEGER</span>        ITEST(32)</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;       <span class="keywordtype">SAVE</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;      <span class="keyword">DATA</span>  itest  /1,3,7,15,31,63,127,255,</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;     *             511,1023,2047,4095,8191,16383,</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;     *             32767, 65535,131071,262143,524287,</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;     *             1048575,2097151,4194303,8388607,</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;     *             16777215,33554431,67108863,134217727,</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;     *             268435455,536870911,1073741823,</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;     *             2147483647,-1/</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;      mwdbit  = iptr(44)</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;      <span class="keywordflow">IF</span> (iptr(45).NE.4) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;          i         = 2147483647</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;          itest(32) = i + i + 1</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;<span class="comment">C     PRINT *,&#39; FI8804 NOCMP&#39;,J,JDESC,IWIDE1(J),IPTR(26),IPTR(25)</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;<span class="comment">C                  --------  NOCMP  --------</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;<span class="comment">C                                       IF NOT TEXT EVENT, PROCESS</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;      <span class="keywordflow">IF</span> (iptr(18).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="comment">C          PRINT *,&#39;                              NOT TEXT&#39;</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;          <span class="keywordflow">IF</span> ((iptr(26)+iwide1(j)).LT.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;<span class="comment">C            PRINT *,&#39; FI8804 NOCMP&#39;,J,JDESC,IWIDE1(J),IPTR(26),IPTR(25)</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;              iptr(1)  = 501</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;              <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="comment">C                                ISOLATE BIT WIDTH</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;          jwide    = iwide1(j) + iptr(26)</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;<span class="comment">C                                    IF ASSOCIATED FIELD SW ON</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;          <span class="keywordflow">IF</span> (iptr(29).GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;              <span class="keywordflow">IF</span> (jdesc.NE.7957.AND.jdesc.NE.7937) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                  iptr(31)        = iptr(31) + 1</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                  kprm            = iptr(31) + iptr(24)</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                  mstack(1,kprm)  = 33792 + iptr(29)</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                  mstack(2,kprm)  = 0</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,iptr(25),iptr(29))</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                  iptr(25)        = iptr(25) + iptr(29)</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                  kdata(iptr(17),kprm) = ivals(1)</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="comment">C                 PRINT *,&#39;FI8804-A&#39;,KPRM,MSTACK(1,KPRM),</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="comment">C    *                      MSTACK(2,KPRM),IPTR(17),KDATA(IPTR(17),KPRM)</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;          iptr(31) = iptr(31) + 1</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;          kprm     = iptr(31) + iptr(24)</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;          mstack(1,kprm) = jdesc</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="comment">C         IF (IPTR(27).NE.0) THEN</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="comment">C             MSTACK(2,KPRM) = IPTR(27)</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;<span class="comment">C         ELSE</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;              mstack(2,kprm) = iscal1(j) + iptr(27)</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="comment">C         END IF</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="comment">C                                       GET VALUES</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="comment">C                                CALL TO GET DATA OF GIVEN BIT WIDTH</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;          <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,ivals,iptr(25),jwide)</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;<span class="comment">C         PRINT *,&#39;DATA  TO&#39;,IPTR(17),KPRM,IVALS(1),JWIDE,IPTR(25)</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;          iptr(25) = iptr(25) + jwide</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;<span class="comment">C                                RETURN WITH SINGLE VALUE</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;          <span class="keywordflow">IF</span> (irfvl1(2,j).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;              jrv  = irfvl1(1,j)</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;              jrv  = irfvl1(3,j)</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;          <span class="keywordflow">IF</span> (jwide.EQ.32) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;              <span class="keywordflow">IF</span> (ivals(1).EQ.itest(jwide)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;                  kdata(iptr(17),kprm) = 999999</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                  kdata(iptr(17),kprm) = ivals(1) + jrv</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (ivals(1).GE.itest(jwide)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;              kdata(iptr(17),kprm) = 999999</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;              kdata(iptr(17),kprm) = ivals(1) + jrv</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;<span class="comment">C         PRINT *,&#39;FI8804-B&#39;,KPRM,MSTACK(1,KPRM),</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;<span class="comment">C    *                     MSTACK(2,KPRM),IPTR(17),KDATA(IPTR(17),KPRM)</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;<span class="comment">C         IF(JDESC.EQ.2049) THEN</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;<span class="comment">C             PRINT *,&#39;VERT SIG =&#39;,KDATA(IPTR(17),KPRM)</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="comment">C         END IF</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="comment">C         PRINT *,&#39;FI8804  &#39;,KPRM,MSTACK(1,KPRM),</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="comment">C    *                       MSTACK(2,KPRM),KDATA(IPTR(17),KPRM)</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="comment">C         PRINT *,&#39;                             TEXT&#39;</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;<span class="comment">C         PRINT *,&#39; FOUND TEXT MODE ****** NOT COMPRESSED *********&#39;</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;          jwide      = iptr(40) * 8</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="comment">C         PRINT *,&#39;                              WIDTH =&#39;,JWIDE,IPTR(40)</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;          nrchrs     = iptr(40)</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;          nrbits     = jwide</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="comment">C         PRINT *,&#39;          CHARS =&#39;,NRCHRS,&#39; BITS =&#39;,NRBITS</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;          iptr(31)        = iptr(31) + 1</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;          kany   = 0</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160; 1800     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;          kany  = kany + 1</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="comment">C         PRINT *,&#39;          NR BITS THIS PASS&#39;,NRBITS</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;          <span class="keywordflow">IF</span> (nrbits.GT.mwdbit) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;              <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,idata,iptr(25),mwdbit)</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="comment">C             PRINT 1801,KANY,IDATA,IPTR(17),KPRM,NRBITS</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160; 1801         <span class="keyword">FORMAT</span> (1x,i2,4x,z8,2(4x,i4))</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;<span class="comment">C                               CONVERTS ASCII TO EBCIDIC</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="comment">C                               COMMENT OUT IF NOT IBM370 COMPUTER</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;              <span class="keywordflow">IF</span> (iptr(37).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="w3ai39_8f.html#a28ca73de8fec4c73859576d1d2e0a219">w3ai39</a> (idata,iptr(45))</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;              kprm            = iptr(31) + iptr(24)</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;              kdata(iptr(17),kprm)  = idata</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;              mstack(1,kprm)  = jdesc</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;              mstack(2,kprm)  = 0</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="comment">C             PRINT *,&#39;BODY &#39;,KPRM,MSTACK(1,KPRM),MSTACK(2,KPRM),</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="comment">C    *                   KDATA(IPTR(17),KPRM)</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;              iptr(25)    = iptr(25) + mwdbit</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;              nrbits      = nrbits - mwdbit</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;              iptr(24)    = iptr(24) + 1</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;              <span class="keywordflow">GO TO</span> 1800</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (nrbits.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;              <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,idata,iptr(25),nrbits)</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;              iptr(25)    = iptr(25) + nrbits</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;<span class="comment">C                               CONVERTS ASCII TO EBCIDIC</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="comment">C                               COMMENT OUT IF NOT IBM370 COMPUTER</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;              <span class="keywordflow">IF</span> (iptr(37).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="w3ai39_8f.html#a28ca73de8fec4c73859576d1d2e0a219">w3ai39</a> (idata,iptr(45))</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;              kprm            = iptr(31) + iptr(24)</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;              kshft           = mwdbit - nrbits</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;              <span class="keywordflow">IF</span> (kshft.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;                  ktry  = kshft / 8</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;                  <span class="keywordflow">DO</span>  1722  lak = 1, ktry</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;                      <span class="keywordflow">IF</span> (iptr(37).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;                          idata  = idata * 256 + 64</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;                          idata  = idata * 256 + 32</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;<span class="keywordflow">                      END IF</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;<span class="comment">C                     PRINT 1723,IDATA</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="comment">C1723                 FORMAT (12X,Z8)</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160; 1722             <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;              kdata(iptr(17),kprm) = idata</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="comment">C             PRINT 1801,KANY,IDATA,KDATA(IPTR(17),KPRM),KPRM</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;              mstack(1,kprm)  = jdesc</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;              mstack(2,kprm)  = 0</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;<span class="comment">C             PRINT *,&#39;TAIL &#39;,KPRM,MSTACK(1,KPRM),</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;<span class="comment">C    *                   KDATA(IPTR(17),KPRM)</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="comment">C&gt; @brief Process a replication descriptor</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="comment">C&gt; @author  Bill Cavanaugh @date 1988-09-01</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160; </div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;<span class="comment">C&gt; Process a replication descriptor, must extract number</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;<span class="comment">C&gt; of replications of n descriptors from the data stream.</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;<span class="comment">C&gt; Program history log:</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1988-09-01</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;<span class="comment">C&gt; @param[in] IWORK Working descriptor list</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="comment">C&gt; @param[in] IPTR See w3fi88 routine docblock</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="comment">C&gt; @param[in] IDENT See w3fi88 routine docblock</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="comment">C&gt; @param[inout] LX X portion of current descriptor</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;<span class="comment">C&gt; @param[inout] LY Y portion of current descriptor</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<span class="comment">C&gt; @param[in] MAXR Maximum number of reports/subsets that may be</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="comment">C&gt; contained in a bufr message</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="comment">C&gt; @param[in] MAXD Maximum number of descriptor combinations that</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="comment">C&gt; may be processed; upper air data and some satellite</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;<span class="comment">C&gt; data require a value for maxd of 1700, but for most</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;<span class="comment">C&gt; other data a value for maxd of 500 will suffice</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="comment">C&gt; @param[out] KDATA Array containing decoded reports from bufr message.</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="comment">C&gt; KDATA(Report number,parameter number)</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="comment">C&gt; (report number limited to value of input argument</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="comment">C&gt;  maxr and parameter number limited to value of input</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="comment">C&gt;  argument maxd)</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;<span class="comment">C&gt; @param MSGA</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;<span class="comment">C&gt; @param LL</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;<span class="comment">C&gt; @param KNR</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="comment">C&gt; @param MSTACK</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;<span class="comment">C&gt; Error return:</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;<span class="comment">C&gt; - IPTR(1)</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;<span class="comment">C&gt;  - = 12  Data descriptor qualifier does not follow delayed replication descriptor</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;<span class="comment">C&gt;  - = 20  Exceeded count for delayed replication pass</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="comment">C&gt; @author  Bill Cavanaugh @date 1988-09-01</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"><a class="line" href="w3fi88_8f.html#a45180c8723bc0f7b3eaff47b7fda7ed8"> 1939</a></span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="w3fi88_8f.html#a45180c8723bc0f7b3eaff47b7fda7ed8">fi8805</a>(IPTR,IDENT,MSGA,IWORK,LX,LY,</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;     *                          KDATA,LL,KNR,MSTACK,MAXR,MAXD)</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160; </div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;      <span class="keywordtype">INTEGER</span>        IPTR(*)</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      <span class="keywordtype">INTEGER</span>        KNR(MAXR)</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;      <span class="keywordtype">INTEGER</span>        ITEMP(2000)</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;      <span class="keywordtype">INTEGER</span>        LL</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;      <span class="keywordtype">INTEGER</span>        KTEMP(2000)</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;      <span class="keywordtype">INTEGER</span>        KDATA(MAXR,MAXD)</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;      <span class="keywordtype">INTEGER</span>        LX,MSTACK(2,MAXD)</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;      <span class="keywordtype">INTEGER</span>        LY</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;      <span class="keywordtype">INTEGER</span>        MSGA(*)</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;      <span class="keywordtype">INTEGER</span>        KVALS(1300)</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;<span class="comment">CVVVVVCHANGE#2 FIX BY KEYSER  -- 12/06/1994</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;<span class="comment">C  NOTE: THIS FIX JUST CLEANS UP CODE SINCE IWORK ARRAY IS EARLIER</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;<span class="comment">C        DEFINED AS 15000 WORDS</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;      <span class="keywordtype">INTEGER</span>        IWORK(*)</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;<span class="comment">CDAK  INTEGER        IWORK(MAXD)</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;<span class="comment">CAAAAACHANGE#2 FIX BY KEYSER  -- 12/06/1994</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;      <span class="keywordtype">INTEGER</span>        IDENT(*)</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      <span class="keywordtype">SAVE</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;<span class="comment">C     PRINT *,&#39; REPLICATION FI8805&#39;</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;<span class="comment">C     DO 7100 I = 1, IPTR(13)</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;<span class="comment">C         PRINT *,I,IWORK(I)</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;<span class="comment">C7100 CONTINUE</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="comment">C                         NUMBER OF DESCRIPTORS</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;      nrset   = lx</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="comment">C                         NUMBER OF REPLICATIONS</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;      nrreps  = ly</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      icurr   = iptr(11) - 1</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;      ipick   = iptr(11) - 1</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;      <span class="keywordflow">IF</span> (nrreps.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;          iptr(39)  = 1</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="comment">C                         SAVE PRIMARY DELAYED REPLICATION DESCRIPTOR</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="comment">C         IPTR(31)  = IPTR(31) + 1</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="comment">C         KPRM      = IPTR(31) + IPTR(24)</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="comment">C         MSTACK(1,KPRM)  = JDESC</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="comment">C         MSTACK(2,KPRM)  = 0</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;<span class="comment">C         KDATA(IPTR(17),KPRM) = 0</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;<span class="comment">C         PRINT *,&#39;FI8805-1&#39;,KPRM,MSTACK(1,KPRM),</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;<span class="comment">C    *                       MSTACK(2,KPRM),KDATA(IPTR(17),KPRM)</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;<span class="comment">C                          DELAYED REPLICATION - MUST GET NUMBER OF</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="comment">C                              REPLICATIONS FROM DATA.</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<span class="comment">C                                GET NEXT DESCRIPTOR</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;          <span class="keyword">CALL </span><a class="code" href="w3fi88_8f.html#a2a7856fc62e88d8fa8670e58c4082293">fi8808</a>(iptr,iwork,lf,lx,ly,jdesc)</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="comment">C          PRINT *,&#39; DELAYED REPLICATION&#39;,LF,LX,LY,JDESC</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;<span class="comment">C                                MUST BE DATA DESCRIPTION</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="comment">C                                   OPERATION QUALIFIER</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;          <span class="keywordflow">IF</span> (jdesc.EQ.7937.OR.jdesc.EQ.7947) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;              jwide     = 8</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (jdesc.EQ.7938.OR.jdesc.EQ.7948) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;              jwide     = 16</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (jdesc.EQ.7936) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;              jwide  = 1</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;              iptr(1)   = 12</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;              <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;<span class="comment">C                        THIS IF BLOCK IS SET TO HANDLE</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;<span class="comment">C                        DATA/DESCRIPTOR REPLICATION</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;          <span class="keywordflow">IF</span> (jdesc.EQ.7947.OR.jdesc.EQ.7948) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;<span class="comment">C                         SET DATA/DESCRIPTOR REPLICATION FLAG = ON</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;              iptr(38)  = 1</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="comment">C                         SAVE AS NEXT ENTRY IN KDATA, MSTACK</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;              iptr(31)  = iptr(31) + 1</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;              kprm      = iptr(31) + iptr(24)</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;              mstack(1,kprm)  = jdesc</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;              mstack(2,kprm)  = 0</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;              <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,kvals,iptr(25),jwide)</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;              iptr(25)   = iptr(25) + jwide</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;              kdata(iptr(17),kprm) = kvals(1)</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;              <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160; </div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="comment">C                             SET SINGLE VALUE FOR SEQUENTIAL,</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;<span class="comment">C                                  MULTIPLE VALUES FOR COMPRESSED</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;          <span class="keywordflow">IF</span> (ident(16).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160; </div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;<span class="comment">C                               NON COMPRESSED</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;              <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,kvals,iptr(25),jwide)</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="comment">C             PRINT *,LF,LX,LY,JDESC,&#39; NR OF REPLICATIONS&#39;,KVALS(1)</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;              iptr(25)   = iptr(25) + jwide</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;              iptr(31)  = iptr(31) + 1</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;              kprm       = iptr(31) + iptr(24)</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;              mstack(1,kprm)  = jdesc</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;              mstack(2,kprm)  = 0</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;              kdata(iptr(17),kprm) = kvals(1)</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;              nrreps          = kvals(1)</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="comment">C             PRINT *,&#39;FI8805-2&#39;,KPRM,MSTACK(1,KPRM),</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;<span class="comment">C    *                       MSTACK(2,KPRM),KDATA(IPTR(17),KPRM)</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;              nrvals     = ident(14)</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;              <span class="keyword">CALL </span><a class="code" href="gbytes_8f.html#ac957b0c87f1261d8460c52bfec7d0308">gbytes</a> (msga,kvals,iptr(25),jwide,0,nrvals)</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;              iptr(25)   = iptr(25) + jwide * nrvals</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;              iptr(31)  = iptr(31) + 1</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;              kprm       = iptr(31) + iptr(24)</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;              mstack(1,kprm)  = jdesc</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;              mstack(2,kprm)  = 0</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;              kdata(iptr(17),kprm) = kvals(1)</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;              <span class="keywordflow">DO</span> 100 i = 1, nrvals</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                  kdata(i,kprm) = kvals(i)</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;  100         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;              nrreps     = kvals(1)</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="comment">C         PRINT *,&#39;NOT DELAYED REPLICATION&#39;</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="comment">C                             RESTRUCTURE WORKING STACK W/REPLICATIONS</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;      <span class="keywordflow">IF</span> (nrreps.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="comment">C         PRINT *,&#39;RESTRUCTURING - NO REPLICATION&#39;</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;          iptr(11)  = ipick + nrset + 2</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;          <span class="keywordflow">GO TO</span> 9999</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="comment">C     PRINT *,&#39; SAVE OFF&#39;,NRSET,&#39; DESCRIPTORS&#39;</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="comment">C                                 PICK UP DESCRIPTORS TO BE REPLICATED</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;      <span class="keywordflow">DO</span> 1000 i = 1, nrset</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;          <span class="keyword">CALL </span><a class="code" href="w3fi88_8f.html#a2a7856fc62e88d8fa8670e58c4082293">fi8808</a>(iptr,iwork,lf,lx,ly,jdesc)</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;          itemp(i)    = jdesc</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="comment">C         PRINT *,&#39;REPLICATION        &#39;,I,ITEMP(I)</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160; 1000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="comment">C                              MOVE TRAILING DESCRIPTORS TO HOLD AREA</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;      lax       = iptr(12) - iptr(11) + 1</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="comment">C     PRINT *,LAX,&#39; TRAILING DESCRIPTORS TO HOLD AREA&#39;,IPTR(11),IPTR(12)</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;      <span class="keywordflow">DO</span> 2000 i = 1, lax</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;          <span class="keyword">CALL </span><a class="code" href="w3fi88_8f.html#a2a7856fc62e88d8fa8670e58c4082293">fi8808</a>(iptr,iwork,lf,lx,ly,jdesc)</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;          ktemp(i)   = jdesc</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;<span class="comment">C         PRINT *,&#39;                             &#39;,I,KTEMP(I)</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160; 2000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="comment">C                              REPLICATIONS INTO ISTACK</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;<span class="comment">C     PRINT *,&#39; MUST REPLICATE &#39;,KX,&#39; DESCRIPTORS&#39;,KY,&#39; TIMES&#39;</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;<span class="comment">C     PRINT *,&#39;REPLICATIONS INTO STACK. LOC&#39;,ICURR</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;      <span class="keywordflow">DO</span> 4000 i = 1, nrreps</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;          <span class="keywordflow">DO</span> 3000 j = 1, nrset</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;              iwork(icurr) = itemp(j)</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<span class="comment">C             PRINT *,&#39;FI8805 A&#39;,ICURR,IWORK(ICURR)</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;              icurr         = icurr + 1</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; 3000     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160; 4000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="comment">C     PRINT *,&#39;                     TO  LOC&#39;,ICURR-1</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="comment">C                              RESTORE TRAILING DESCRIPTORS</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="comment">C     PRINT *,&#39;TRAILING DESCRIPTORS INTO STACK. LOC&#39;,ICURR</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;      <span class="keywordflow">DO</span> 5000 i = 1, lax</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;          iwork(icurr) = ktemp(i)</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;<span class="comment">C         PRINT *,&#39;FI8805 B&#39;,ICURR,IWORK(ICURR)</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;          icurr        = icurr + 1</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160; 5000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;      iptr(12)  = icurr - 1</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;      iptr(11)  = ipick</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160; 9999 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;<span class="comment">C     DO 5500 I = 1, IPTR(12)</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;<span class="comment">C         PRINT *,&#39;FI8805 B&#39;,I,IWORK(I),IPTR(11)</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;<span class="comment">C5500 CONTINUE</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;<span class="comment">C&gt; @brief Process operator descriptors</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1988-09-01</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160; </div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;<span class="comment">C&gt; Extract and save indicated change values for use</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;<span class="comment">C&gt; until changes are rescinded, or extract text strings indicated</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;<span class="comment">C&gt; through 2 05 yyy.</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;<span class="comment">C&gt; Program history log:</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1988-09-01</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1991-04-04 Modified to handle descriptor 2 05 yyy</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1991-05-10 Coding has been added to process properly</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="comment">C&gt; table c descriptor 2 06 yyy.</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1991-11-21 Coding has been added to properly process</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="comment">C&gt; table c descriptor 2 03 yyy, the change</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="comment">C&gt; to new reference value for selected</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;<span class="comment">C&gt; descriptors.</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;<span class="comment">C&gt; @param[in] IPTR See w3fi88 routine docblock</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="comment">C&gt; @param[in] LX X portion of current descriptor</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;<span class="comment">C&gt; @param[in] LY Y portion of current descriptor</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="comment">C&gt; @param[in] MAXR Maximum number of reports/subsets that may be</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="comment">C&gt; contained in a bufr message</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;<span class="comment">C&gt; @param[in] MAXD Maximum number of descriptor combinations that</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;<span class="comment">C&gt; may be processed; upper air data and some satellite</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;<span class="comment">C&gt; data require a value for maxd of 1700, but for most</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;<span class="comment">C&gt; other data a value for maxd of 500 will suffice</span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;<span class="comment">C&gt; @param[out] KDATA Array containing decoded reports from bufr message.</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;<span class="comment">C&gt; KDATA(Report number,parameter number)</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;<span class="comment">C&gt; (report number limited to value of input argument</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;<span class="comment">C&gt;  maxr and parameter number limited to value of input</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="comment">C&gt;  argument maxd)</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="comment">C&gt; Arrays containing data from table b</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="comment">C&gt; @param[out] ISCAL1 Scale for value of descriptor</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="comment">C&gt; @param[out] IRFVL1 Reference value for descriptor</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;<span class="comment">C&gt; @param[out] IWIDE1 Bit width for value of descriptor</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;<span class="comment">C&gt; @param IDENT</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;<span class="comment">C&gt; @param MSGA</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;<span class="comment">C&gt; @param IVALS</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="comment">C&gt; @param MSTACK</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="comment">C&gt; @param J</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="comment">C&gt; @param LL</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="comment">C&gt; @param KFXY1</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;<span class="comment">C&gt; @param IWORK</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;<span class="comment">C&gt; @param JDESC</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="comment">C&gt; @param KPTRB</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;<span class="comment">C&gt; Error return:</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;<span class="comment">C&gt; IPTR(1) = 5 - Erroneous x value in data descriptor operator</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1988-09-01</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"><a class="line" href="w3fi88_8f.html#a119b554db1325ff6b2d3742797f107dd"> 2147</a></span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="w3fi88_8f.html#a119b554db1325ff6b2d3742797f107dd">fi8806</a> (IPTR,LX,LY,IDENT,MSGA,KDATA,IVALS,MSTACK,</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;     *     IWIDE1,IRFVL1,ISCAL1,J,LL,KFXY1,IWORK,JDESC,MAXR,MAXD,KPTRB)</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160; </div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;<span class="comment">C     NEW               BASE TABLE B</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="comment">C                            MAY BE A COMBINATION OF MASTER TABLE B</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="comment">C                            AND ANCILLARY TABLE B</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;      <span class="keywordtype">INTEGER</span>        KFXY1(*),ISCAL1(*),IRFVL1(3,*),IWIDE1(*)</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;<span class="comment">C     CHARACTER*40   ANAME1(*)</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="comment">C     CHARACTER*24   AUNIT1(*)</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;      <span class="keywordtype">INTEGER</span>        IPTR(*),KDATA(MAXR,MAXD),IVALS(*)</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;      <span class="keywordtype">INTEGER</span>        IDENT(*),IWORK(*),KPTRB(*)</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;      <span class="keywordtype">INTEGER</span>        MSGA(*),MSTACK(2,MAXD)</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;      <span class="keywordtype">INTEGER</span>        J,JDESC</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;      <span class="keywordtype">INTEGER</span>        LL</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;      <span class="keywordtype">INTEGER</span>        LX</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;      <span class="keywordtype">INTEGER</span>        LY</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      <span class="keywordtype">SAVE</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;<span class="comment">C     PRINT *,&#39; F2 - DATA DESCRIPTOR OPERATOR&#39;</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;      <span class="keywordflow">IF</span> (lx.EQ.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;<span class="comment">C                                CHANGE BIT WIDTH</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;          <span class="keywordflow">IF</span> (ly.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="comment">C             PRINT *,&#39; RETURN TO NORMAL WIDTH&#39;</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;              iptr(26) = 0</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="comment">C             PRINT *,&#39; EXPAND WIDTH BY&#39;,LY-128,&#39; BITS&#39;</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;              iptr(26)  = ly - 128</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (lx.EQ.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="comment">C                                  CHANGE SCALE</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;          <span class="keywordflow">IF</span> (ly.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="comment">C                              RESET TO STANDARD SCALE</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;              iptr(27) = 0</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="comment">C                               SET NEW SCALE</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;              iptr(27)  = ly - 128</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (lx.EQ.3) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;<span class="comment">C                      CHANGE REFERENCE VALUE</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;<span class="comment">C                                 FOR EACH OF THOSE DESCRIPTORS BETWEEN</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="comment">C                                 2 03 YYY WHERE Y LT 255 AND</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="comment">C                                 2 03 255, EXTRACT THE NEW REFERENCE</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="comment">C                                 VALUE (BIT WIDTH YYY) AND PLACE</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="comment">C                                 IN TERTIARY TABLE B REF VAL POSITION,</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="comment">C                                 SET FLAG IN SECONDARY REFVAL POSITION</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="comment">C                                 THOSE DESCRIPTORS DO NOT HAVE DATA</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment">C                                 ASSOCIATED WITH THEM, BUT ONLY</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="comment">C                                 IDENTIFY THE TABLE B ENTRIES THAT</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="comment">C                                 ARE GETTING NEW REFERENCE VALUES.</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;          kyyy     = ly</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;          <span class="keywordflow">IF</span> (kyyy.GT.0.AND.kyyy.LT.255) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="comment">C                               START CYCLING THRU DESCRIPTORS UNTIL</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="comment">C                               TERMINATE NEW REF VALS IS FOUND</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;  300         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;              <span class="keyword">CALL </span><a class="code" href="w3fi88_8f.html#a2a7856fc62e88d8fa8670e58c4082293">fi8808</a> (iptr,iwork,lf,lx,ly,jdesc)</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;              <span class="keywordflow">IF</span> (jdesc.EQ.33791) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="comment">C                    IF 2 03 255 THEN RETURN</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                  <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="comment">C                               FIND MATCHING TABLE B ENTRY</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;              lj  = kptrb(jdesc)</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;              <span class="keywordflow">IF</span> (lj.LT.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;<span class="comment">C                         MATCHING DESCRIPTOR NOT FOUND, ERROR ERROR</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                  print *,<span class="stringliteral">&#39;2 03 YYY - MATCHING DESCRIPTOR NOT FOUND&#39;</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;                  iptr(1)  = 23</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;                  <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;<span class="comment">C                                  TURN ON SWITCH</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;              irfvl1(2,lj) = 1</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="comment">C                                 INSERT NEW REFERENCE VALUE</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;              <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,irfvl1(3,lj),iptr(25),kyyy)</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;              <span class="keywordflow">GO TO</span> 300</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (kyyy.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;<span class="comment">C                                      MUST TURN OFF ALL NEW</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;<span class="comment">C                                      REFERENCE VALUES</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;              <span class="keywordflow">DO</span> 400 i = 1, iptr(21)</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                  irfvl1(2,i) = 0</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;  400         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="comment">C                                      LX = 3</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="comment">C                                      MUST BE CONCLUDED WITH Y=255</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (lx.EQ.4) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="comment">C                             ASSOCIATED VALUES</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;          <span class="keywordflow">IF</span> (ly.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;              iptr(29) = 0</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;<span class="comment">C             PRINT *,&#39;RESET ASSOCIATED VALUES&#39;,IPTR(29)</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;              iptr(29)  = ly</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;              <span class="keywordflow">IF</span> (iwork(iptr(11)).NE.7957) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                  print *,<span class="stringliteral">&#39;2 04 YYY NOT FOLLOWED BY 0 31 021&#39;</span></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;                  iptr(1)   = 11</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;<span class="comment">C             PRINT *,&#39;SET ASSOCIATED VALUES&#39;,IPTR(29)</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (lx.EQ.5) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;          mwdbit = iptr(44)</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="comment">C                        PROCESS TEXT DATA</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;          iptr(40)  = ly</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;          iptr(18)  = 1</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;          j = kptrb(jdesc)</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;          <span class="keywordflow">IF</span> (ident(16).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;<span class="comment">C             PRINT *,&#39;FROM FI8806 - 2 05 YYY - NONCOMPRESSED TEXT&#39;,J</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;              <span class="keyword">CALL </span><a class="code" href="w3fi88_8f.html#a94b6d994b2df117c1395048caea2f86b">fi8804</a>(iptr,msga,kdata,ivals,mstack,</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;     *                iwide1,irfvl1,iscal1,j,ll,jdesc,maxr,maxd)</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;<span class="comment">C             PRINT *,&#39;2 05 YYY - TEXT - COMPRESSED MODE YYY=&#39;,LY</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<span class="comment">C             PRINT *,&#39;TEXT - LOWEST = 0&#39;</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;              iptr(25) = iptr(25) + iptr(40) * 8</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;<span class="comment">C                                   GET NBINC</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;<span class="comment">C             CALL GBYTE (MSGA,NBINC,IPTR(25),6)</span></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;              iptr(25)     = iptr(25) + 6</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;              nbinc  = iptr(40)</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;<span class="comment">C             PRINT *,&#39;TEXT    NBINC =&#39;,NBINC,IPTR(40)</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="comment">C                                   FOR NUMBER OF OBSERVATIONS</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;              iptr(31)      = iptr(31) + 1</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;              kprm          = iptr(31) + iptr(24)</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;              istart        = kprm</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;              <span class="keywordflow">DO</span> 1900 n   = 1, ident(14)</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;                  kprm        = istart</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;                  nbits       = iptr(40) * 8</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160; 1700             <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;<span class="comment">C                 PRINT *,&#39;1700&#39;,KDATA(N,KPRM),N,KPRM,NBITS</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;                  <span class="keywordflow">IF</span> (nbits.GT.mwdbit) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;                      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,idata,iptr(25),mwdbit)</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                      iptr(25)     = iptr(25) + mwdbit</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;                      nbits        = nbits - mwdbit</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="comment">C                               CONVERTS ASCII TO EBCIDIC</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;<span class="comment">C                               COMMENT OUT IF NOT IBM370 COMPUTER</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;                      <span class="keywordflow">IF</span> (iptr(37).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                          <span class="keyword">CALL </span><a class="code" href="w3ai39_8f.html#a28ca73de8fec4c73859576d1d2e0a219">w3ai39</a> (idata,iptr(45))</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;<span class="keywordflow">                      END IF</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;                      mstack(1,kprm) = jdesc</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;                      mstack(2,kprm) = 0</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                      kdata(n,kprm) = idata</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;<span class="comment">C                     PRINT *,&#39;TEXT        &#39;,N,KPRM,KDATA(N,KPRM)</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;<span class="comment">C                          SET FOR NEXT PART</span></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;                      kprm          = kprm + 1</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;<span class="comment">C                     PRINT 1701,1,KDATA(N,KPRM),N,KPRM,NBITS,IDATA</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;<span class="comment">C1701                 FORMAT (1X,I1,1X,6HKDATA=,A4,2X,I5,2X,I5,2X,I5,2X,</span></div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;<span class="comment">C    *                 I10)</span></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                      <span class="keywordflow">GO TO</span> 1700</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (nbits.EQ.mwdbit) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,idata,iptr(25),mwdbit)</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                      iptr(25)     = iptr(25) + mwdbit</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;                      nbits        = nbits - mwdbit</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;<span class="comment">C                               CONVERTS ASCII TO EBCIDIC</span></div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;<span class="comment">C                               COMMENT OUT IF NOT IBM370 COMPUTER</span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;                      <span class="keywordflow">IF</span> (iptr(37).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;                          <span class="keyword">CALL </span><a class="code" href="w3ai39_8f.html#a28ca73de8fec4c73859576d1d2e0a219">w3ai39</a> (idata,iptr(45))</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="keywordflow">                      END IF</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;                      mstack(1,kprm) = jdesc</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;                      mstack(2,kprm) = 0</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;                      kdata(n,kprm) = idata</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;<span class="comment">C                     PRINT *,&#39;TEXT        &#39;,N,KPRM,KDATA(N,KPRM)</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;<span class="comment">C                          SET FOR NEXT PART</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;                      kprm          = kprm + 1</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<span class="comment">C                     PRINT 1701,1,KDATA(N,KPRM),N,KPRM,NBITS,IDATA</span></div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (nbits.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;                      <span class="keyword">CALL </span><a class="code" href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a> (msga,idata,iptr(25),nbits)</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;                      iptr(25)     = iptr(25) + nbits</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;                      ibuf         = (mwdbit - nbits) / 8</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;                      <span class="keywordflow">IF</span> (ibuf.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;                          <span class="keywordflow">DO</span> 1750 mp = 1, ibuf</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;                              idata  = idata * 256 + 32</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160; 1750                     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="keywordflow">                      END IF</span></div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;<span class="comment">C                               CONVERTS ASCII TO EBCIDIC</span></div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;<span class="comment">C                               COMMENT OUT IF NOT IBM370 COMPUTER</span></div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;                      <span class="keywordflow">IF</span> (iptr(37).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                          <span class="keyword">CALL </span><a class="code" href="w3ai39_8f.html#a28ca73de8fec4c73859576d1d2e0a219">w3ai39</a> (idata,iptr(45))</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="keywordflow">                      END IF</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                      mstack(1,kprm) = jdesc</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;                      mstack(2,kprm) = 0</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;                      kdata(n,kprm) = idata</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="comment">C                     PRINT *,&#39;TEXT        &#39;,N,KPRM,KDATA(N,KPRM)</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;<span class="comment">C                     PRINT 1701,2,KDATA(N,KPRM),N,KPRM,NBITS</span></div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;<span class="comment">C                 WRITE (6,1800)N,(KDATA(N,I),I=KPRS,KPRM)</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;<span class="comment">C1800             FORMAT (2X,I4,2X,3A4)</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160; 1900         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160; </div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;              iptr(24)  = iptr(24) + iptr(40) / 4 - 1</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;              <span class="keywordflow">IF</span> (mod(iptr(40),4).NE.0) iptr(24) = iptr(24) + 1</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;          iptr(18)  = 0</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;<span class="comment">C  ---------------------------</span></div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (lx.EQ.6) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;<span class="comment">C                          SKIP NEXT DESCRIPTOR</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;<span class="comment">C              SET TO PASS OVER DESCRIPTOR AND DATA</span></div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="comment">C                     IF DESCRIPTOR NOT IN TABLE B</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;          iptr(36)   = ly</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;<span class="comment">C         PRINT *,&#39;SET TO SKIP&#39;,LY,&#39; BIT FIELD&#39;</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;          iptr(31)       = iptr(31) + 1</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;          kprm           = iptr(31) + iptr(24)</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;          mstack(1,kprm) = 34304 + ly</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;          mstack(2,kprm) = 0</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;          iptr(1)   = 5</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="comment">C&gt; @brief Process queue descriptor.</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1988-09-01</span></div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160; </div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;<span class="comment">C&gt; Substitute descriptor queue for queue descriptor.</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="comment">C&gt; Program history log:</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1988-09-01</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1991-04-17 Improved handling of nested queue descriptors</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1991-05-28 Improved handling of nested queue descriptors</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;<span class="comment">C&gt; based on tests with live data.</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;<span class="comment">C&gt; @param[in] IWORK Working descriptor list</span></div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;<span class="comment">C&gt; @param[in] IPTR See w3fi88 routine docblock</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;<span class="comment">C&gt; @param[in] ITBLD+ITBLD2 Array containing descriptor queues</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;<span class="comment">C&gt; @param[in] JDESC Queue descriptor to be expanded</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="comment">C&gt; @param KPTRD</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1988-09-01</span></div>
<div class="line"><a name="l02371"></a><span class="lineno"><a class="line" href="w3fi88_8f.html#aa56d7f5f943a7bf774c2e9ddc144595f"> 2371</a></span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="w3fi88_8f.html#aa56d7f5f943a7bf774c2e9ddc144595f">fi8807</a>(IPTR,IWORK,ITBLD,ITBLD2,JDESC,KPTRD)</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160; </div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;<span class="comment">C                       ANCILLARY TABLE D FROM TYPE 11 BUFR MESSAGE</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;      <span class="keywordtype">INTEGER</span>        ITBLD2(20,*)</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;<span class="comment">C                       NEW BASE TABLE D</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;      <span class="keywordtype">INTEGER</span>        ITBLD(20,*)</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;      <span class="keywordtype">INTEGER</span>        IPTR(*),JDESC,KPTRD(*)</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;      <span class="keywordtype">INTEGER</span>        IWORK(*),IHOLD(15000)</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;      <span class="keywordtype">SAVE</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;<span class="comment">C     PRINT *,&#39; FI8807  F3 ENTRY&#39;,IPTR(11),IPTR(12)</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;<span class="comment">C                                   SET FOR BINARY SEARCH IN TABLE D</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;      jlo  = 1</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;      jhi  = iptr(20)</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="comment">C     PRINT *,&#39;LOOKING FOR QUEUE DESCRIPTOR&#39;,JDESC,IPTR(11),IPTR(12)</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;      jmid = kptrd(mod(jdesc,16384))</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;      <span class="keywordflow">IF</span> (jmid.LT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;          iptr(1)  = 4</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;          <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;<span class="comment">C                              HAVE TABLE D MATCH</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;<span class="comment">C     PRINT *,&#39;D &#39;,(ITBLD(LL,JMID),LL=1,20)</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;<span class="comment">C     PRINT *,&#39;TABLE D TO IHOLD&#39;</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;      ik       = 0</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;      jk       = 0</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;      <span class="keywordflow">DO</span> 200 ki = 2, 20</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;          <span class="keywordflow">IF</span> (itbld(ki,jmid).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;              ik        = ik + 1</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;              ihold(ik) = itbld(ki,jmid)</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="comment">C             PRINT *,IK,IHOLD(IK)</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;              <span class="keywordflow">GO TO</span> 300</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;  200 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;  300 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;      kk       = iptr(11)</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;      <span class="keywordflow">IF</span> (kk.GT.iptr(12)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;<span class="comment">C                          NOTHING MORE TO APPEND</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="comment">C         PRINT *,&#39;NOTHING MORE TO APPEND&#39;</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;<span class="comment">C                          APPEND TRAILING IWORK TO IHOLD</span></div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="comment">C         PRINT *,&#39;APPEND FROM &#39;,KK,&#39; TO&#39;,IPTR(12)</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;          <span class="keywordflow">DO</span> 500 i = kk, iptr(12)</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;              ik  = ik + 1</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;              ihold(ik) = iwork(i)</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;  500     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;<span class="comment">C                                RESET IHOLD TO IWORK</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;<span class="comment">C     PRINT *,&#39; RESET IWORK STACK&#39;</span></div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;      kk       = iptr(11) - 2</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;      <span class="keywordflow">DO</span> 1000 i = 1, ik</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;          kk        = kk + 1</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;          iwork(kk) = ihold(i)</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160; 1000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;      iptr(12)   = kk</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="comment">C     PRINT *,&#39; FI8807  F3 EXIT &#39;,IPTR(11),IPTR(12)</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="comment">C     DO 2000 I = 1, IPTR(12)</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="comment">C         PRINT *,&#39;EXIT  IWORK&#39;,I,IWORK(I)</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;<span class="comment">C2000 CONTINUE</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;<span class="comment">C                                RESET POINTERS</span></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;      iptr(11)   = iptr(11) - 1</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;<span class="comment">C&gt; @brief</span></div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1988-09-01</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160; </div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;<span class="comment">C&gt; Program history log:</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1988-09-01</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;<span class="comment">C&gt; @param[inout] IPTR See w3fi88 routine docblock</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="comment">C&gt; @param[in] IWORK Working descriptor list</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;<span class="comment">C&gt; @param LF</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;<span class="comment">C&gt; @param LX</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="comment">C&gt; @param LY</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;<span class="comment">C&gt; @param JDESC</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1988-09-01</span></div>
<div class="line"><a name="l02458"></a><span class="lineno"><a class="line" href="w3fi88_8f.html#a2a7856fc62e88d8fa8670e58c4082293"> 2458</a></span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="w3fi88_8f.html#a2a7856fc62e88d8fa8670e58c4082293">fi8808</a>(IPTR,IWORK,LF,LX,LY,JDESC)</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160; </div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;      <span class="keywordtype">INTEGER</span>       IPTR(*),IWORK(*),LF,LX,LY,JDESC</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;      SAVE</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;<span class="comment">C     PRINT *,&#39; FI8808 NEW DESCRIPTOR PICKUP&#39;</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;      JDESC    = iwork(iptr(11))</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;      ly       = mod(jdesc,256)</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;      iptr(34) = ly</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;      lx       = mod((jdesc/256),64)</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;      iptr(33) = lx</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;      lf       = jdesc / 16384</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;      iptr(32) = lf</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;<span class="comment">C     PRINT *,&#39; TEST DESCRIPTOR&#39;,LF,LX,LY,&#39; AT&#39;,IPTR(11)</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;      iptr(11) = iptr(11) + 1</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;<span class="comment">C&gt; @brief Reformat profiler w hgt increments</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1990-02-14</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160; </div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;<span class="comment">C&gt; Reformat decoded profiler data to show heights instead of</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="comment">C&gt; height increments.</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;<span class="comment">C&gt; Program history log:</span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1990-02-14</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;<span class="comment">C&gt; @param[in] IDENT Array contains message information extracted from BUFR message</span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;<span class="comment">C&gt; - IDENT(1) - Edition number (byte 4, section 1)</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;<span class="comment">C&gt; - IDENT(2) - Originating center (bytes 5-6, section 1)</span></div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;<span class="comment">C&gt; - IDENT(3) - Update sequence (byte 7, section 1)</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;<span class="comment">C&gt; - IDENT(4) - (byte 8, section 1)</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;<span class="comment">C&gt; - IDENT(5) - Bufr message type (byte 9, section 1)</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;<span class="comment">C&gt; - IDENT(6) - Bufr msg sub-type (byte 10, section 1)</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<span class="comment">C&gt; - IDENT(7) - (bytes 11-12, section 1)</span></div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;<span class="comment">C&gt; - IDENT(8) - Year of century (byte 13, section 1)</span></div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;<span class="comment">C&gt; - IDENT(9) - Month of year (byte 14, section 1)</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;<span class="comment">C&gt; - IDENT(10) - Day of month (byte 15, section 1)</span></div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;<span class="comment">C&gt; - IDENT(11) - Hour of day (byte 16, section 1)</span></div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;<span class="comment">C&gt; - IDENT(12) - Minute of hour (byte 17, section 1)</span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;<span class="comment">C&gt; - IDENT(13) - Rsvd by adp centers (byte 18, section 1)</span></div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;<span class="comment">C&gt; - IDENT(14) - Nr of data subsets (byte 5-6, section 3)</span></div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;<span class="comment">C&gt; - IDENT(15) - Observed flag (byte 7, bit 1, section 3)</span></div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;<span class="comment">C&gt; - IDENT(16) - Compression flag (byte 7, bit 2, section 3)</span></div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;<span class="comment">C&gt; @param[in] MSTACK Working descriptor list and scaling factor</span></div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;<span class="comment">C&gt; @param[in] KDATA Array containing decoded reports from bufr message.</span></div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;<span class="comment">C&gt; KDATA(Report number,parameter number)</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;<span class="comment">C&gt; (report number limited to value of input argument</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;<span class="comment">C&gt;  maxr and parameter number limited to value of input</span></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;<span class="comment">C&gt;  argument maxd)</span></div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;<span class="comment">C&gt; @param[in] IPTR See w3fi88</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;<span class="comment">C&gt; @param[in] MAXR Maximum number of reports/subsets that may be</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;<span class="comment">C&gt; contained in a bufr message</span></div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;<span class="comment">C&gt; @param[in] MAXD Maximum number of descriptor combinations that</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;<span class="comment">C&gt; may be processed; upper air data and some satellite</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;<span class="comment">C&gt; data require a value for maxd of 1700, but for most</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;<span class="comment">C&gt; other data a value for maxd of 500 will suffice</span></div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1990-02-14</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"><a class="line" href="w3fi88_8f.html#a334e81d3c01ac71a02ef5425671e7bf0"> 2516</a></span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="w3fi88_8f.html#a334e81d3c01ac71a02ef5425671e7bf0">fi8809</a>(IDENT,MSTACK,KDATA,IPTR,MAXR,MAXD)</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160; </div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;<span class="comment">C  ----------------------------------------------------------------</span></div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;      <span class="keywordtype">INTEGER</span>        ISW</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;      <span class="keywordtype">INTEGER</span>        IDENT(*),KDATA(MAXR,MAXD)</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;      <span class="keywordtype">INTEGER</span>        MSTACK(2,MAXD),IPTR(*)</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;      <span class="keywordtype">INTEGER</span>        KPROFL(1700)</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;      <span class="keywordtype">INTEGER</span>        KPROF2(1700)</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;      <span class="keywordtype">INTEGER</span>        KSET2(1700)</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;<span class="comment">C  ----------------------------------------------------------</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;      <span class="keywordtype">SAVE</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;<span class="comment">C     PRINT *,&#39;FI8809&#39;</span></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;<span class="comment">C                                LOOP FOR NUMBER OF SUBSETS/REPORTS</span></div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;      <span class="keywordflow">DO</span> 3000 i = 1, ident(14)</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;<span class="comment">C                                INIT FOR DATA INPUT ARRAY</span></div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;          mk         = 1</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;<span class="comment">C                                INIT FOR DESC OUTPUT ARRAY</span></div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;          jk         = 0</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;<span class="comment">C                                LOCATION</span></div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;          isw        = 0</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;          <span class="keywordflow">DO</span> 200 j = 1, 3</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;<span class="comment">C                                    LATITUDE</span></div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;              <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1282) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;                  isw   = isw + 1</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;                  <span class="keywordflow">GO TO</span> 100</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;<span class="comment">C                                    LONGITUDE</span></div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1538) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;                  isw   = isw + 2</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;                  <span class="keywordflow">GO TO</span> 100</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;<span class="comment">C                                    HEIGHT ABOVE SEA LEVEL</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1793) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;                  ihgt  = kdata(i,mk)</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;                  isw   = isw + 4</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;                  <span class="keywordflow">GO TO</span> 100</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;              <span class="keywordflow">GO TO</span> 200</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;  100         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;              jk             = jk + 1</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;<span class="comment">C                                     SAVE DESCRIPTOR</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;              kprofl(jk)     = mstack(1,mk)</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;<span class="comment">C                                     SAVE SCALE</span></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;              kprof2(jk)     = mstack(2,mk)</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;<span class="comment">C                                      SAVE DATA</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;              kset2(jk)  = kdata(i,mk)</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;              mk         = mk + 1</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;  200     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;          <span class="keywordflow">IF</span> (isw.NE.7) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;              print *,<span class="stringliteral">&#39;LOCATION ERROR PROCESSING PROFILER&#39;</span></div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;              iptr(1)    = 200</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;              <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;<span class="comment">C  TIME</span></div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;          isw        = 0</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;          <span class="keywordflow">DO</span> 400 j = 1, 7</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;<span class="comment">C                                    YEAR</span></div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;              <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1025) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;                  isw   = isw + 1</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;                  <span class="keywordflow">GO TO</span> 300</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;<span class="comment">C                                    MONTH</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1026) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;                  isw   = isw + 2</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;                  <span class="keywordflow">GO TO</span> 300</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;<span class="comment">C                                    DAY</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1027) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;                  isw   = isw + 4</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;                  <span class="keywordflow">GO TO</span> 300</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;<span class="comment">C                                    HOUR</span></div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1028) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;                  isw   = isw + 8</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;                  <span class="keywordflow">GO TO</span> 300</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;<span class="comment">C                                    MINUTE</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1029) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;                  isw   = isw + 16</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;                  <span class="keywordflow">GO TO</span> 300</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;<span class="comment">C                                    TIME SIGNIFICANCE</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.2069) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;                  isw   = isw + 32</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;                  <span class="keywordflow">GO TO</span> 300</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1049) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;                  isw   = isw + 64</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;                  <span class="keywordflow">GO TO</span> 300</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;              <span class="keywordflow">GO TO</span> 400</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;  300         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;              jk         = jk + 1</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;<span class="comment">C                             SAVE DESCRIPTOR</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;              kprofl(jk) = mstack(1,mk)</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;<span class="comment">C                                     SAVE SCALE</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;              kprof2(jk)     = mstack(2,mk)</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="comment">C                             SAVE DATA</span></div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;              kset2(jk)  = kdata(i,mk)</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;              mk         = mk + 1</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;  400     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;          <span class="keywordflow">IF</span> (isw.NE.127) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;              print *,<span class="stringliteral">&#39;TIME ERROR PROCESSING PROFILER&#39;</span>,isw</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;              iptr(1)    = 201</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;              <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;<span class="comment">C  SURFACE DATA</span></div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;          krg        = 0</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;          isw        = 0</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;          <span class="keywordflow">DO</span> 600 j = 1, 10</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;<span class="comment">C                                    WIND SPEED</span></div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;              <span class="keywordflow">IF</span> (mstack(1,mk).EQ.2818) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;                  isw   = isw + 1</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;                  <span class="keywordflow">GO TO</span> 500</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;<span class="comment">C                                    WIND DIRECTION</span></div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.2817) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;                  isw   = isw + 2</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;                  <span class="keywordflow">GO TO</span> 500</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;<span class="comment">C                                    PRESS REDUCED TO MSL</span></div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.2611) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;                  isw   = isw + 4</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;                  <span class="keywordflow">GO TO</span> 500</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;<span class="comment">C                                    TEMPERATURE</span></div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.3073) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;                  isw   = isw + 8</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;                  <span class="keywordflow">GO TO</span> 500</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;<span class="comment">C                                    RAINFALL RATE</span></div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.3342) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;                  isw   = isw + 16</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;                  <span class="keywordflow">GO TO</span> 500</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;<span class="comment">C                                    RELATIVE HUMIDITY</span></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.3331) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;                  isw   = isw + 32</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;                  <span class="keywordflow">GO TO</span> 500</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;<span class="comment">C                                    1ST RANGE GATE OFFSET</span></div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1982.OR.</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;     *                    mstack(1,mk).EQ.1983) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;<span class="comment">C       CANNOT USE NORMAL PROCESSING FOR FIRST RANGE GATE, MUST SAVE</span></div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;<span class="comment">C        VALUE FOR LATER USE</span></div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;                  <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1983) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;                      ihgt   = kdata(i,mk)</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;                      mk     = mk + 1</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;                      krg   = 1</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;                      <span class="keywordflow">IF</span> (krg.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;                          incrht             = kdata(i,mk)</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;                          mk    = mk + 1</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;                          krg   = 1</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;<span class="comment">C                         PRINT *,&#39;INITIAL INCR =&#39;,INCRHT</span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;                      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;                          lhgt  = 500 + ihgt - kdata(i,mk)</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;                          isw   = isw + 64</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;<span class="comment">C                         PRINT *,&#39;BASE HEIGHT=&#39;,LHGT,&#39; INCR=&#39;,INCRHT</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;<span class="keywordflow">                      END IF</span></div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;<span class="comment">C                                    MODE #1</span></div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.8128) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;                  isw   = isw + 128</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;                  <span class="keywordflow">GO TO</span> 500</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;<span class="comment">C                                    MODE #2</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.8129) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;                  isw   = isw + 256</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;                  <span class="keywordflow">GO TO</span> 500</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;              <span class="keywordflow">GO TO</span> 600</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;  500         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;<span class="comment">C                              SAVE DESCRIPTOR</span></div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;              jk             = jk + 1</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;              kprofl(jk)     = mstack(1,mk)</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;<span class="comment">C                                     SAVE SCALE</span></div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;              kprof2(jk)     = mstack(2,mk)</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;<span class="comment">C                              SAVE DATA</span></div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;              kset2(jk)      = kdata(i,mk)</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;<span class="comment">C             IF (I.EQ.1) THEN</span></div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;<span class="comment">C                 PRINT *,&#39;   &#39;,JK,KPROFL(JK),KSET2(JK)</span></div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;<span class="comment">C             END IF</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;              mk             = mk + 1</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;  600     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;          <span class="keywordflow">IF</span> (isw.NE.511) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;              print *,<span class="stringliteral">&#39;SURFACE ERROR PROCESSING PROFILER&#39;</span>,isw</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;              iptr(1)    = 202</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;              <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;<span class="comment">C  43 LEVELS</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;          <span class="keywordflow">DO</span> 2000 l = 1, 43</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160; 2020         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;              isw        = 0</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;<span class="comment">C                                    HEIGHT INCREMENT</span></div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;              <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1982) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;<span class="comment">C                 PRINT *,&#39;NEW HEIGHT INCREMENT&#39;,KDATA(I,MK)</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;                  incrht  = kdata(i,mk)</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;                  mk      = mk + 1</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;                  <span class="keywordflow">IF</span> (lhgt.LT.(9250+ihgt)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;                      lhgt    = ihgt + 500 - incrht</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;                      lhgt    = ihgt + 9250 - incrht</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;<span class="comment">C    MUST ENTER HEIGHT OF THIS LEVEL - DESCRIPTOR AND DATA</span></div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;<span class="comment">C          AT THIS POINT     - HEIGHT + INCREMENT + BASE VALUE</span></div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;              lhgt       = lhgt + incrht</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;<span class="comment">C             PRINT *,&#39;LEVEL &#39;,L,LHGT</span></div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;              <span class="keywordflow">IF</span> (l.EQ.37) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;                  lhgt       = lhgt + incrht</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;              jk          = jk + 1</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;<span class="comment">C                              SAVE DESCRIPTOR</span></div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;              kprofl(jk)  = 1798</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;<span class="comment">C                                     SAVE SCALE</span></div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;              kprof2(jk)     = 0</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;<span class="comment">C                              SAVE DATA</span></div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;              kset2(jk)  = lhgt</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;<span class="comment">C             IF (I.EQ.10) THEN</span></div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;<span class="comment">C                 PRINT *,&#39; &#39;</span></div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;<span class="comment">C                 PRINT *,&#39;HGT&#39;,JK,KPROFL(JK),KSET2(JK)</span></div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;<span class="comment">C             END IF</span></div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;              isw   = 0</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;              <span class="keywordflow">DO</span> 800 j = 1, 9</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;  750             <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;                  <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1982) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;                      <span class="keywordflow">GO TO</span> 2020</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;<span class="comment">C                                    U VECTOR VALUE</span></div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.3008) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                      isw   = isw + 1</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;                      <span class="keywordflow">IF</span> (kdata(i,mk).GE.2047) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;                          vectu              = 32767</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;                      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;                          vectu              = kdata(i,mk)</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;<span class="keywordflow">                      END IF</span></div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;                      mk    = mk + 1</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;                      <span class="keywordflow">GO TO</span> 800</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;<span class="comment">C                                    V VECTOR VALUE</span></div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.3009) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;                      isw   = isw + 2</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;                      <span class="keywordflow">IF</span> (kdata(i,mk).GE.2047) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;                          vectv              = 32767</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;                      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;                          vectv              = kdata(i,mk)</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;<span class="keywordflow">                      END IF</span></div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;                      mk    = mk + 1</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;<span class="comment">C IF U VALUE IS ALSO AVAILABLE THEN GENERATE DDFFF</span></div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;<span class="comment">C     DESCRIPTORS AND DATA</span></div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;                      <span class="keywordflow">IF</span> (iand(isw,1).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;                          <span class="keywordflow">IF</span> (vectu.EQ.32767.OR.vectv.EQ.32767) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;<span class="comment">C                                               SAVE DD DESCRIPTOR</span></div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;                              jk             = jk + 1</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;                              kprofl(jk)     = 2817</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;<span class="comment">C                                     SAVE SCALE</span></div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;                              kprof2(jk)     = 0</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;<span class="comment">C                                               SAVE DD DATA</span></div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;                              kset2(jk)      = 32767</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;<span class="comment">C                                               SAVE FFF DESCRIPTOR</span></div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;                              jk             = jk + 1</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;                              kprofl(jk)     = 2818</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;<span class="comment">C                                     SAVE SCALE</span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;                              kprof2(jk)     = 1</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;<span class="comment">C                                               SAVE FFF DATA</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;                              kset2(jk)      = 32767</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;                          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;<span class="comment">C                                               GENERATE DDFFF</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;                              <span class="keyword">CALL </span><a class="code" href="w3fc05_8f.html#ae77a21f468d05a34fa3a201c89b30530">w3fc05</a> (vectu,vectv,dir,spd)</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;                              ndir         = dir</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;                              spd          = spd</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;                              nspd         = spd</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;<span class="comment">C                             PRINT *,&#39;                &#39;,NDIR,NSPD</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;<span class="comment">C                                               SAVE DD DESCRIPTOR</span></div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;                              jk             = jk + 1</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;                              kprofl(jk)     = 2817</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;<span class="comment">C                                     SAVE SCALE</span></div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;                              kprof2(jk)     = 0</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;<span class="comment">C                                               SAVE DD DATA</span></div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;                              kset2(jk)          = dir</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;<span class="comment">C                             IF (I.EQ.1) THEN</span></div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;<span class="comment">C                                 PRINT *,&#39;DD &#39;,JK,KPROFL(JK),KSET2(JK)</span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;<span class="comment">C                             END IF</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;<span class="comment">C                                               SAVE FFF DESCRIPTOR</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;                              jk             = jk + 1</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;                              kprofl(jk)     = 2818</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;<span class="comment">C                                     SAVE SCALE</span></div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;                              kprof2(jk)     = 1</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;<span class="comment">C                                               SAVE FFF DATA</span></div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;                              kset2(jk)          = spd</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;<span class="comment">C                             IF (I.EQ.1) THEN</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;<span class="comment">C                                 PRINT *,&#39;FFF&#39;,JK,KPROFL(JK),KSET2(JK)</span></div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;<span class="comment">C                             END IF</span></div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;<span class="keywordflow">                          END IF</span></div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;<span class="keywordflow">                      END IF</span></div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;                      <span class="keywordflow">GO TO</span> 800</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;<span class="comment">C                                    W VECTOR VALUE</span></div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.3010) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;                      isw   = isw + 4</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;                      <span class="keywordflow">GO TO</span> 700</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;<span class="comment">C                                    Q/C TEST RESULTS</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.8130) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;                      isw   = isw + 8</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;                      <span class="keywordflow">GO TO</span> 700</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="comment">C                                    U,V QUALITY IND</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(iand(isw,16).EQ.0.AND.mstack(1,mk).EQ.2070) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;                      isw   = isw + 16</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;                      <span class="keywordflow">GO TO</span> 700</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;<span class="comment">C                                    W QUALITY IND</span></div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(iand(isw,32).EQ.0.AND.mstack(1,mk).EQ.2070) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;                      isw   = isw + 32</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;                      <span class="keywordflow">GO TO</span> 700</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;<span class="comment">C                                    SPECTRAL PEAK POWER</span></div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.5568) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;                      isw   = isw + 64</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;                      <span class="keywordflow">GO TO</span> 700</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;<span class="comment">C                                    U,V VARIABILITY</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.3011) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;                      isw   = isw + 128</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;                      <span class="keywordflow">GO TO</span> 700</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;<span class="comment">C                                    W VARIABILITY</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.3013) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;                      isw   = isw + 256</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;                      <span class="keywordflow">GO TO</span> 700</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ((mstack(1,mk)/16384).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;                      mk     = mk + 1</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;                      <span class="keywordflow">GO TO</span> 750</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;                  <span class="keywordflow">GO TO</span> 800</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;  700             <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;                  jk         = jk + 1</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;<span class="comment">C                                      SAVE DESCRIPTOR</span></div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;                  kprofl(jk) = mstack(1,mk)</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;<span class="comment">C                                     SAVE SCALE</span></div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;                  kprof2(jk)     = mstack(2,mk)</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;<span class="comment">C                                      SAVE DATA</span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;                  kset2(jk)          = kdata(i,mk)</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;                  mk         = mk + 1</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;<span class="comment">C                 IF (I.EQ.1) THEN</span></div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;<span class="comment">C                     PRINT *,&#39;   &#39;,JK,KPROFL(JK),KSET2(JK)</span></div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;<span class="comment">C                 END IF</span></div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;  800         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;              <span class="keywordflow">IF</span> (isw.NE.511) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;                  print *,<span class="stringliteral">&#39;LEVEL ERROR PROCESSING PROFILER&#39;</span>,isw</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;                  iptr(1)    = 203</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;                  <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160; 2000     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;<span class="comment">C                        MOVE DATA BACK INTO KDATA ARRAY</span></div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;          <span class="keywordflow">DO</span> 4000 ll = 1, jk</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;              kdata(i,ll) = kset2(ll)</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160; 4000     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160; 3000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;<span class="comment">C     PRINT *,&#39;REBUILT ARRAY&#39;</span></div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;      <span class="keywordflow">DO</span> 5000 ll = 1, jk</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;<span class="comment">C                           DESCRIPTOR</span></div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;          mstack(1,ll)  = kprofl(ll)</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;<span class="comment">C                           SCALE</span></div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;          mstack(2,ll)  = kprof2(ll)</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;<span class="comment">C         PRINT *,LL,MSTACK(1,LL),(KDATA(I,LL),I=1,7)</span></div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160; 5000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;<span class="comment">C                        MOVE REFORMATTED DESCRIPTORS TO MSTACK ARRAY</span></div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;      iptr(31) = jk</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;<span class="comment">C&gt; @brief Reformat profiler edition 2 data</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1993-01-27</span></div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160; </div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;<span class="comment">C&gt; Reformat profiler data in edition 2</span></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;<span class="comment">C&gt; Program history log:</span></div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1993-01-27</span></div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;<span class="comment">C&gt; - Dennis Keyser 1995-06-07 A correction was made to prevent</span></div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;<span class="comment">C&gt; unnecessary looping when all requested</span></div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;<span class="comment">C&gt; descriptors are missing.</span></div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;<span class="comment">C&gt; @param[in] IDENT    - ARRAY CONTAINS MESSAGE INFORMATION EXTRACTED FROM BUFR MESSAGE -</span></div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;<span class="comment">C&gt; - IDENT(1)  - Edition number (byte 4, section 1)</span></div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;<span class="comment">C&gt; - IDENT(2)  - Originating center (bytes 5-6, section 1)</span></div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;<span class="comment">C&gt; - IDENT(3)  - Update sequence (byte 7, section 1)</span></div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;<span class="comment">C&gt; - IDENT(4)  - (byte 8, section 1)</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;<span class="comment">C&gt; - IDENT(5)  - Bufr message type (byte 9, section 1)</span></div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;<span class="comment">C&gt; - IDENT(6)  - Bufr msg sub-type (byte 10, section 1)</span></div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;<span class="comment">C&gt; - IDENT(7)  - (bytes 11-12, section 1)</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;<span class="comment">C&gt; - IDENT(8)  - Year of century (byte 13, section 1)</span></div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;<span class="comment">C&gt; - IDENT(9)  - Month of year (byte 14, section 1)</span></div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;<span class="comment">C&gt; - IDENT(10) - Day of month (byte 15, section 1)</span></div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;<span class="comment">C&gt; - IDENT(11) - Hour of day (byte 16, section 1)</span></div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;<span class="comment">C&gt; - IDENT(12) - Minute of hour (byte 17, section 1)</span></div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;<span class="comment">C&gt; - IDENT(13) - Rsvd by adp centers(byte 18, section 1)</span></div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;<span class="comment">C&gt; - IDENT(14) - Nr of data subsets (byte 5-6, section 3)</span></div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;<span class="comment">C&gt; - IDENT(15) - Observed flag (byte 7, bit 1, section 3)</span></div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;<span class="comment">C&gt; - IDENT(16) - Compression flag (byte 7, bit 2, section 3)</span></div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;<span class="comment">C&gt; @param[in] MSTACK Working descriptor list and scaling factor</span></div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;<span class="comment">C&gt; @param[in] KDATA Array containing decoded reports from bufr message.</span></div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;<span class="comment">C&gt; KDATA(Report number,parameter number)</span></div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;<span class="comment">C&gt; (report number limited to value of input argument</span></div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;<span class="comment">C&gt; maxr and parameter number limited to value of input</span></div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;<span class="comment">C&gt; argument maxd)</span></div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;<span class="comment">C&gt; @param[in] IPTR See w3fi88</span></div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;<span class="comment">C&gt; @param[in] MAXR Maximum number of reports/subsets that may be</span></div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;<span class="comment">C&gt; contained in a bufr message</span></div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;<span class="comment">C&gt; @param[in] MAXD Maximum number of descriptor combinations that</span></div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;<span class="comment">C&gt; may be processed; upper air data and some satellite</span></div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;<span class="comment">C&gt; data require a value for maxd of 1700, but for most</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;<span class="comment">C&gt; other data a value for maxd of 500 will suffice</span></div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1993-01-27</span></div>
<div class="line"><a name="l02910"></a><span class="lineno"><a class="line" href="w3fi88_8f.html#adad8332e2168ab134f2c6f879f133a5f"> 2910</a></span>&#160;      <span class="keyword">SUBROUTINE </span><a class="code" href="w3fi88_8f.html#adad8332e2168ab134f2c6f879f133a5f">fi8810</a>(IDENT,MSTACK,KDATA,IPTR,MAXR,MAXD)</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160; </div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;      <span class="keywordtype">INTEGER</span>        ISW</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;      <span class="keywordtype">INTEGER</span>        IDENT(*),KDATA(MAXR,MAXD)</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;      <span class="keywordtype">INTEGER</span>        MSTACK(2,MAXD),IPTR(*)</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;      <span class="keywordtype">INTEGER</span>        KPROFL(1700)</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;      <span class="keywordtype">INTEGER</span>        KPROF2(1700)</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;      <span class="keywordtype">INTEGER</span>        KSET2(1700)</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;      SAVE</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;<span class="comment">C                             LOOP FOR NUMBER OF SUBSETS</span></div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;      <span class="keywordflow">DO</span> 3000 i = 1, ident(14)</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;          mk  = 1</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;          jk  = 0</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;          isw  = 0</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;<span class="comment">C         PRINT *,&#39;IDENTIFICATION&#39;</span></div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;          <span class="keywordflow">DO</span> 200 j = 1, 5</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;              <span class="keywordflow">IF</span> (mstack(1,mk).EQ.257) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;<span class="comment">C                            BLOCK NUMBER</span></div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;                  isw  = isw + 1</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.258) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;<span class="comment">C                           STATION NUMBER</span></div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;                  isw  = isw + 2</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1282) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;<span class="comment">C                           LATITUDE</span></div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;                  isw  = isw + 4</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1538) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;<span class="comment">C                           LONGITUDE</span></div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;                  isw  = isw + 8</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1793) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;<span class="comment">C                           HEIGHT OF STATION</span></div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;                  isw  = isw + 16</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;                  ihgt  = kdata(i,mk)</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;                  mk  = mk + 1</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;                  <span class="keywordflow">GO TO</span> 200</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;              jk  = jk + 1</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;              kprofl(jk)  = mstack(1,mk)</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;              kprof2(jk)  = mstack(2,mk)</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;              kset2(jk)   = kdata(i,mk)</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;<span class="comment">C             PRINT *,JK,KPROFL(JK),KSET2(JK)</span></div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;              mk  = mk + 1</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;  200     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;<span class="comment">C         PRINT *,&#39;LOCATION &#39;,ISW</span></div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;          <span class="keywordflow">IF</span> (isw.NE.31) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;              print *,<span class="stringliteral">&#39;LOCATION ERROR PROCESSING PROFILER&#39;</span></div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;              iptr(10)  = 200</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;              <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;<span class="comment">C                      PROCESS TIME ELEMENTS</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;          isw  = 0</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;          <span class="keywordflow">DO</span> 400 j  = 1, 7</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;              <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1025) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;<span class="comment">C                           YEAR</span></div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;                  isw  = isw + 1</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1026) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;<span class="comment">C                           MONTH</span></div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;                  isw  = isw + 2</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1027) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;<span class="comment">C                           DAY</span></div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;                  isw  = isw + 4</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1028) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;<span class="comment">C                           HOUR</span></div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;                  isw  = isw + 8</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1029) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;<span class="comment">C                           MINUTE</span></div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;                  isw  = isw + 16</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.2069) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;<span class="comment">C                           TIME SIGNIFICANCE</span></div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;                  isw  = isw + 32</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1049) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;<span class="comment">C                           TIME DISPLACEMENT</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;                  isw  = isw + 64</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;                  mk  = mk + 1</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;                  <span class="keywordflow">GO TO</span> 400</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;              jk  = jk + 1</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;              kprofl(jk)  = mstack(1,mk)</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;              kprof2(jk)  = mstack(2,mk)</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;              kset2(jk)   = kdata(i,mk)</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;<span class="comment">C             PRINT *,JK,KPROFL(JK),KSET2(JK)</span></div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;              mk  = mk + 1</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;  400     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;<span class="comment">C         PRINT *,&#39;TIME &#39;,ISW</span></div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;          <span class="keywordflow">IF</span> (isw.NE.127) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;              print *,<span class="stringliteral">&#39;TIME ERROR PROCESSING PROFILER&#39;</span></div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;              iptr(1)  = 201</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;              <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;<span class="comment">C                  SURFACE DATA</span></div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;          isw  = 0</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;<span class="comment">C         PRINT *,&#39;SURFACE&#39;</span></div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;          <span class="keywordflow">DO</span> 600 k  = 1, 8</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;<span class="comment">C             PRINT *,MK,MSTACK(1,MK),JK,ISW</span></div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;              <span class="keywordflow">IF</span> (mstack(1,mk).EQ.2817) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;                  isw  = isw + 1</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.2818) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;                  isw  = isw + 2</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.2611) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;                  isw  = isw + 4</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.3073) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;                  isw  = isw + 8</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.3342) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;                  isw  = isw + 16</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.3331) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;                  isw  = isw + 32</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1797) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;                  incrht  = kdata(i,mk)</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;                  isw  = isw + 64</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;<span class="comment">C                 PRINT *,&#39;INITIAL INCREMENT = &#39;,INCRHT</span></div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;                  mk  = mk + 1</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;<span class="comment">C                 PRINT *,JK,KPROFL(JK),KSET2(JK),&#39; ISW=&#39;,ISW</span></div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;                  <span class="keywordflow">GO TO</span> 600</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.6433) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;                  isw  = isw + 128</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;              jk  = jk + 1</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;              kprofl(jk)  = mstack(1,mk)</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;              kprof2(jk)  = mstack(2,mk)</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;              kset2(jk)   = kdata(i,mk)</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;<span class="comment">C             PRINT *,JK,KPROFL(JK),KSET2(JK),&#39;ISW=&#39;,ISW</span></div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;              mk  = mk + 1</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;  600     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;          <span class="keywordflow">IF</span> (isw.NE.255) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;              print *,<span class="stringliteral">&#39;ERROR PROCESSING PROFILER&#39;</span>,isw</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;              iptr(1)  = 204</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;              <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;          <span class="keywordflow">IF</span> (mstack(1,mk).NE.1797) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;              print *,<span class="stringliteral">&#39;ERROR PROCESSING HEIGHT INCREMENT IN PROFILER&#39;</span></div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;              iptr(1)  = 205</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;              <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;<span class="comment">C                   MUST SAVE THIS HEIGHT VALUE</span></div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;          lhgt  = 500 + ihgt - kdata(i,mk)</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;<span class="comment">C         PRINT *,&#39;BASE HEIGHT = &#39;,LHGT,&#39; INCR = &#39;,INCRHT</span></div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;          mk  = mk + 1</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;          <span class="keywordflow">IF</span> (mstack(1,mk).GE.16384) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;              mk  = mk + 1</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;<span class="comment">C              PROCESS LEVEL DATA</span></div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;<span class="comment">C         PRINT *,&#39;LEVEL DATA&#39;</span></div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;          <span class="keywordflow">DO</span> 2000 l = 1, 43</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160; 2020         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;<span class="comment">C             PRINT *,&#39;DESC&#39;,MK,MSTACK(1,MK),JK</span></div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;              isw  = 0</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;<span class="comment">C                       HEIGHT INCREMENT</span></div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;              <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1797) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;                  incrht  = kdata(i,mk)</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;<span class="comment">C                 PRINT *,&#39;NEW HEIGHT INCREMENT = &#39;,INCRHT</span></div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;                  mk  = mk + 1</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;<span class="comment">C                 IF (LHGT.LT.(9250+IHGT)) THEN</span></div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;<span class="comment">C                     LHGT  = IHGT + 500 - INCRHT</span></div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;<span class="comment">C                 ELSE</span></div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;<span class="comment">C                     LHGT  = IHGT + 9250 -INCRHT</span></div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;<span class="comment">C                 END IF</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;<span class="comment">C                    MUST ENTER HEIGHT OF THIS LEVEL - DESCRIPTOR AND DA</span></div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;<span class="comment">C                     AT THIS POINT</span></div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;              lhgt  = lhgt + incrht</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;<span class="comment">C             PRINT *,&#39;LEVEL &#39;,L,LHGT</span></div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;<span class="comment">C             IF (L.EQ.37) THEN</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;<span class="comment">C                 LHGT  = LHGT + INCRHT</span></div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;<span class="comment">C             END IF</span></div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;              jk  = jk + 1</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;<span class="comment">C                        SAVE DESCRIPTOR</span></div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;              kprofl(jk)  = 1798</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;<span class="comment">C                       SAVE SCALE</span></div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;              kprof2(jk)  = 0</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;<span class="comment">C                        SAVE DATA</span></div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;              kset2(jk)   = lhgt</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;<span class="comment">C             PRINT *,KPROFL(JK),KSET2(JK),JK</span></div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;              isw  = 0</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;              icon  = 1</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;              <span class="keywordflow">DO</span> 800 j = 1, 10</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;750               <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;                  <span class="keywordflow">IF</span> (mstack(1,mk).EQ.1797) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;                        <span class="keywordflow">GO TO</span> 2020</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.6432) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;<span class="comment">C                               HI/LO MODE</span></div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;                      isw  = isw + 1</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.6434) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;<span class="comment">C                               Q/C TEST</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;                      isw  = isw + 2</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.2070) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;                      <span class="keywordflow">IF</span> (icon.EQ.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;<span class="comment">C                               FIRST PASS - U,V CONSENSUS</span></div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;                           isw  = isw + 4</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;                           icon  = icon + 1</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;                      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;<span class="comment">C                               SECOND PASS - W CONSENSUS</span></div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;                           isw  = isw + 64</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;<span class="keywordflow">                      END IF</span></div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.2819) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;<span class="comment">C                               U VECTOR VALUE</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;                      isw  = isw + 8</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;                      <span class="keywordflow">IF</span> (kdata(i,mk).GE.2047) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;                          vectu  = 32767</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;                      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;                          vectu  = kdata(i,mk)</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;<span class="keywordflow">                      END IF</span></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;                      mk  = mk + 1</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;                      <span class="keywordflow">GO TO</span> 800</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.2820) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;<span class="comment">C                               V VECTOR VALUE</span></div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;                      isw  = isw + 16</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;                      <span class="keywordflow">IF</span> (kdata(i,mk).GE.2047) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;                          vectv  = 32767</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;                      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;                          vectv  = kdata(i,mk)</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;<span class="keywordflow">                      END IF</span></div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;                      <span class="keywordflow">IF</span> (iand(isw,1).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;                          <span class="keywordflow">IF</span> (vectu.EQ.32767.OR.vectv.EQ.32767) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;<span class="comment">C                               SAVE DD DESCRIPTOR</span></div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;                              jk  = jk + 1</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;                              kprofl(jk)  = 2817</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;                              kprof2(jk)  = 0</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;                              kset2(jk)   = 32767</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;<span class="comment">C                               SAVE FFF DESCRIPTOR</span></div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;                              jk  = jk + 1</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;                              kprofl(jk)  = 2818</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;                              kprof2(jk)  = 1</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;                              kset2(jk)   = 32767</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;                          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;                              <span class="keyword">CALL </span><a class="code" href="w3fc05_8f.html#ae77a21f468d05a34fa3a201c89b30530">w3fc05</a> (vectu,vectv,dir,spd)</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;                              ndir  = dir</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;                              spd   = spd</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;                              nspd  = spd</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;<span class="comment">C                             PRINT *,&#39;     &#39;,NDIR,NSPD</span></div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;<span class="comment">C                               SAVE DD DESCRIPTOR</span></div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;                              jk  = jk + 1</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;                              kprofl(jk)  = 2817</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;                              kprof2(jk)  = 0</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;                              kset2(jk)   = ndir</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;<span class="comment">C                             IF (I.EQ.1) THEN</span></div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;<span class="comment">C                                 PRINT *,&#39;DD &#39;,JK,KPROFL(JK),KSET2(JK)</span></div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;<span class="comment">C                             ENDIF</span></div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;<span class="comment">C                            SAVE FFF DESCRIPTOR</span></div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;                              jk  = jk + 1</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;                              kprofl(jk)  = 2818</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;                              kprof2(jk)  = 1</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;                              kset2(jk)   = nspd</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;<span class="comment">C                             IF (I.EQ.1) THEN</span></div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;<span class="comment">C                                 PRINT *,&#39;FFF&#39;,JK,KPROFL(JK),KSET2(JK)</span></div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;<span class="comment">C                             ENDIF</span></div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;<span class="keywordflow">                          END IF</span></div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;                          mk  = mk + 1</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;                          <span class="keywordflow">GO TO</span> 800</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;<span class="keywordflow">                      END IF</span></div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.2866) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;<span class="comment">C                               SPEED STD DEVIATION</span></div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;                      isw  = isw + 32</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;<span class="comment">C -- A CHANGE BY KEYSER : POWER DESCR. BACK TO 5568</span></div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.5568) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;<span class="comment">C                               SIGNAL POWER</span></div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;                      isw  = isw + 128</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.2822) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;<span class="comment">C                               W COMPONENT</span></div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;                      isw  = isw + 256</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,mk).EQ.2867) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;<span class="comment">C                              VERT STD DEVIATION</span></div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;                      isw  = isw + 512</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;<span class="comment">CVVVVVCHANGE#1 FIX BY KEYSER  -- 12/06/1994</span></div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;<span class="comment">C   NOTE: THIS FIX PREVENTS UNNECESSARY LOOPING WHEN ALL REQ. DESCR.</span></div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;<span class="comment">C         ARE MISSING.  WOULD GO INTO INFINITE LOOP EXCEPT EVENTUALLY</span></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;<span class="comment">C         MSTACK ARRAY SIZE IS EXCEEDED AND GET FORTRAN ERROR INTERRUPT</span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;<span class="comment">CDAK              ELSE</span></div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ((mstack(1,mk)/16384).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;<span class="comment">CAAAAACHANGE#1 FIX BY KEYSER  -- 12/06/1994</span></div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;                      mk  = mk + 1</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;                      <span class="keywordflow">GO TO</span> 750</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;                  jk  = jk + 1</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;<span class="comment">C                               SAVE DESCRIPTOR</span></div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;                  kprofl(jk)  = mstack(1,mk)</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;<span class="comment">C                              SAVE SCALE</span></div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;                  kprof2(jk)  = mstack(2,mk)</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;<span class="comment">C                               SAVE DATA</span></div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;                  kset2(jk)   = kdata(i,mk)</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;                  mk  = mk + 1</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;<span class="comment">C                 PRINT *,L,&#39;TEST   &#39;,JK,KPROFL(JK),KSET2(JK)</span></div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;  800         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;              <span class="keywordflow">IF</span> (isw.NE.1023) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;                  print *,<span class="stringliteral">&#39;LEVEL ERROR PROCESSING PROFILER&#39;</span>,isw</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;                  iptr(1)  = 202</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;                  <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160; 2000     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;<span class="comment">C                           MOVE DATA BACK INTO KDATA ARRAY</span></div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;          <span class="keywordflow">DO</span> 5000 ll = 1, jk</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;<span class="comment">C                           DATA</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;              kdata(i,ll)   = kset2(ll)</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160; 5000     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160; 3000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;      <span class="keywordflow">DO</span> 5005 ll = 1, jk</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;<span class="comment">C                         DESCRIPTOR</span></div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;          mstack(1,ll)  = kprofl(ll)</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;<span class="comment">C                          SCALE</span></div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;          mstack(2,ll)  = kprof2(ll)</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;<span class="comment">C -- A CHANGE BY KEYSER : PRINT STATEMNT SHOULD BE HERE NOT IN 5000 LOOP</span></div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;<span class="comment">C             PRINT *,LL,MSTACK(1,LL),MSTACK(2,LL),(KDATA(I,LL),I=1,4)</span></div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160; 5005 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;      iptr(31)  = jk</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;<span class="comment">C&gt; @brief Expand data/descriptor replication</span></div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1993-05-12</span></div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160; </div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;<span class="comment">C&gt; Expand data and descriptor strings</span></div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;<span class="comment">C&gt; Program history log:</span></div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;<span class="comment">C&gt; - Bill Cavanaugh 1993-05-12</span></div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;<span class="comment">C&gt; @param[in] IPTR See w3fi88 routine docblock</span></div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;<span class="comment">C&gt; @param[in] IDENT See w3fi88 routine docblock</span></div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;<span class="comment">C&gt; @param[in] MAXR Maximum number of reports/subsets that may be</span></div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;<span class="comment">C&gt; contained in a bufr message</span></div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;<span class="comment">C&gt; @param[in] MAXD Maximum number of descriptor combinations that</span></div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;<span class="comment">C&gt; may be processed; upper air data and some satellite</span></div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;<span class="comment">C&gt; data require a value for maxd of 1700, but for most</span></div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;<span class="comment">C&gt; other data a value for maxd of 500 will suffice</span></div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;<span class="comment">C&gt; @param[inout] KDATA Array containing decoded reports from bufr message.</span></div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;<span class="comment">C&gt; kdata(report number,parameter number)</span></div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;<span class="comment">C&gt; (report number limited to value of input argument</span></div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;<span class="comment">C&gt; maxr and parameter number limited to value of input</span></div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;<span class="comment">C&gt; argument maxd)</span></div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;<span class="comment">C&gt; @param[inout] MSTACK List of descriptors and scale values</span></div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;<span class="comment">C&gt; @param KNR</span></div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;<span class="comment">C&gt; @param LDATA</span></div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;<span class="comment">C&gt; @param LSTACK</span></div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;<span class="comment">C&gt; Error return:</span></div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;<span class="comment">C&gt; - IPTR(1)</span></div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;<span class="comment">C&gt;</span></div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;<span class="comment">C&gt; @author Bill Cavanaugh @date 1993-05-12</span></div>
<div class="line"><a name="l03247"></a><span class="lineno"><a class="line" href="w3fi88_8f.html#a12b020b46772271cab997bb781bda9c1"> 3247</a></span>&#160;      <span class="keyword">SUBROUTINE  </span><a class="code" href="w3fi88_8f.html#a12b020b46772271cab997bb781bda9c1">fi8811</a>(IPTR,IDENT,MSTACK,KDATA,KNR,</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;     *                  LDATA,LSTACK,MAXD,MAXR)</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160; </div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;      <span class="keywordtype">INTEGER</span>        IPTR(*)</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;      <span class="keywordtype">INTEGER</span>        KNR(MAXR)</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;      <span class="keywordtype">INTEGER</span>        KDATA(MAXR,MAXD),LDATA(MAXD)</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;      <span class="keywordtype">INTEGER</span>        MSTACK(2,MAXD),LSTACK(2,MAXD)</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;      <span class="keywordtype">INTEGER</span>        IDENT(*)</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;      SAVE</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;<span class="comment">C     PRINT *,&#39; DATA/DESCRIPTOR REPLICATION &#39;</span></div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;      <span class="keywordflow">DO</span> 1000 i = 1, knr(1)</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;<span class="comment">C                           IF NOT REPLICATION DESCRIPTOR</span></div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;          <span class="keywordflow">IF</span> ((mstack(1,i)/16384).NE.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;              <span class="keywordflow">GO TO</span> 1000</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;<span class="comment">C                           IF DELAYED REPLICATION DESCRIPTOR</span></div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;          <span class="keywordflow">IF</span> (mod(mstack(1,i),256).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;<span class="comment">C                               SAVE KX VALUE (NR DESC&#39;S TO REPLICATE)</span></div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;              kx = mod((mstack(1,i)/256),64)</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;<span class="comment">C                               IF NEXT DESC IS NOT 7947 OR 7948</span></div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;<span class="comment">C                                 (I.E., 0 31 011  OR 0 31 012)</span></div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;              <span class="keywordflow">IF</span> (mstack(1,i+1).NE.7947.AND.mstack(1,i+1).NE.7948) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;<span class="comment">C                                    SKIP IT</span></div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;                  <span class="keywordflow">GO TO</span> 1000</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;<span class="comment">C                               GET NR REPS FROM KDATA</span></div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;              nrreps  = kdata(1,i+1)</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;              last  = i + 1 + kx</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;<span class="comment">C                               SAVE OFF TRAILING DESCS AND DATA</span></div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;              ktrail = knr(1) - i - 1 - kx</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;              <span class="keywordflow">DO</span> 100 l = 1, ktrail</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;                  nx  = i + l + kx + 1</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;                  ldata(l) = kdata(1,nx)</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;                  lstack(1,l) = mstack(1,nx)</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;                  lstack(2,l) = mstack(2,nx)</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;  100         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;<span class="comment">C                              INSERT FX DESCS/DATA NR REPS TIMES</span></div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;              last  = i + 1</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;              <span class="keywordflow">DO</span> 400 j = 1, nrreps</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;                  nx  = i + 2</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;                  <span class="keywordflow">DO</span> 300 k = 1, kx</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;                      last  = last + 1</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;                      kdata(1,last)  = kdata(1,nx)</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;                      mstack(1,last) = mstack(1,nx)</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;                      mstack(2,last) = mstack(2,nx)</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;                      nx  = nx + 1</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;  300             <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160; </div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;  400         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;<span class="comment">C                               RESTORE TRAILING DATA/DESCS</span></div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;              <span class="keywordflow">DO</span> 500 l = 1, ktrail</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;                  last  = last + 1</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;                  kdata(1,last) = ldata(l)</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;                  mstack(1,last)  = lstack(1,l)</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;                  mstack(2,last)  = lstack(2,l)</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;  500         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;<span class="comment">C                               RESET KNR(1)</span></div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;              knr(1)  = last</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160; 1000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;      <span class="keyword">SUBROUTINE </span>fi8812(IPTR,IUNITB,IUNITD,ISTACK,NRDESC,KPTRB,KPTRD,</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;     *                     IRF1SW,NEWREF,ITBLD,ITBLD2,</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;     *                     KFXY1,ANAME1,AUNIT1,ISCAL1,IRFVL1,IWIDE1,</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;     *                     KFXY2,ANAME2,AUNIT2,ISCAL2,IRFVL2,IWIDE2)</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;<span class="comment">C$$$  SUBPROGRAM DOCUMENTATION BLOCK</span></div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;<span class="comment">C                .      .    .                                       .</span></div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;<span class="comment">C SUBPROGRAM:    FI8812      BUILD TABLE B SUBSET BASED ON BUFR SEC 3</span></div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;<span class="comment">C   PRGMMR: CAVANAUGH        ORG: W/NMC42    DATE: 93-12-23</span></div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;<span class="comment">C ABSTRACT: BUILD A SUBSET OF TABLE B ENTRIES THAT CORRESPOND TO</span></div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;<span class="comment">C           THE DESCRIPTORS NEEDED FOR THIS MESSAGE</span></div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;<span class="comment">C PROGRAM HISTORY LOG:</span></div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;<span class="comment">C   93-05-12  CAVANAUGH</span></div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;<span class="comment">C   YY-MM-DD  MODIFIER2   DESCRIPTION OF CHANGE</span></div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;<span class="comment">C USAGE:    CALL FI8812(IPTR,IUNITB,IUNITD,ISTACK,NRDESC,KPTRB,KPTRD,</span></div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;<span class="comment">C    *      IRF1SW,NEWREF,ITBLD,ITBLD2,</span></div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;<span class="comment">C    *      KFXY1,ANAME1,AUNIT1,ISCAL1,IRFVL1,IWIDE1,</span></div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;<span class="comment">C    *      KFXY2,ANAME2,AUNIT2,ISCAL2,IRFVL2,IWIDE2)</span></div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;<span class="comment">C   INPUT ARGUMENT LIST:</span></div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;<span class="comment">C     IPTR     - SEE W3FI88 ROUTINE DOCBLOCK</span></div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;<span class="comment">C     IDENT    - SEE W3FI88 ROUTINE DOCBLOCK</span></div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;<span class="comment">C     ISTACK   - LIST OF DESCRIPTORS AND SCALE VALUES</span></div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;<span class="comment">C     IUNITB   -</span></div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;<span class="comment">C     IUNITD   -</span></div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;<span class="comment">C     ISTACK   -</span></div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;<span class="comment">C     NRDESC   -</span></div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;<span class="comment">C     KFXY2    -</span></div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;<span class="comment">C     ANAME2   -</span></div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;<span class="comment">C     AUNIT2   -</span></div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;<span class="comment">C     ISCAL2   -</span></div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;<span class="comment">C     IRFVL2   -</span></div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;<span class="comment">C     IWIDE2   -</span></div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;<span class="comment">C     IRF1SW   -</span></div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;<span class="comment">C     NEWREF   -</span></div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;<span class="comment">C     ITBLD2   -</span></div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;<span class="comment">C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)</span></div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;<span class="comment">C     KDATA    - ARRAY CONTAINING DECODED REPORTS FROM BUFR MESSAGE.</span></div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;<span class="comment">C                KDATA(REPORT NUMBER,PARAMETER NUMBER)</span></div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;<span class="comment">C                (REPORT NUMBER LIMITED TO VALUE OF INPUT ARGUMENT</span></div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;<span class="comment">C                 MAXR AND PARAMETER NUMBER LIMITED TO VALUE OF INPUT</span></div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;<span class="comment">C                 ARGUMENT MAXD)</span></div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;<span class="comment">C     MSTACK   - LIST OF DESCRIPTORS AND SCALE VALUES</span></div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;<span class="comment">C     KFXY1    -</span></div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;<span class="comment">C     ANAME1   -</span></div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;<span class="comment">C     AUNIT1   -</span></div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;<span class="comment">C     ISCAL1   -</span></div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;<span class="comment">C     IRFVL1   -</span></div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;<span class="comment">C     IWIDE1   -</span></div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;<span class="comment">C     ITBLD    -</span></div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;<span class="comment">C   SUBPROGRAMS CALLED:</span></div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;<span class="comment">C     LIBRARY:</span></div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;<span class="comment">C       W3LIB    -</span></div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;<span class="comment">C REMARKS: ERROR RETURN:</span></div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;<span class="comment">C    IPTR(1) =</span></div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;<span class="comment">C ATTRIBUTES:</span></div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;<span class="comment">C   LANGUAGE: FORTRAN 77</span></div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;<span class="comment">C   MACHINE:  NAS</span></div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;<span class="comment">C$$$</span></div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;<span class="comment">C     NEW               BASE TABLE B</span></div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;<span class="comment">C                            MAY BE A COMBINATION OF MASTER TABLE B</span></div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;<span class="comment">C                            AND ANCILLARY TABLE B</span></div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;      <span class="keywordtype">INTEGER</span>        KFXY1(*),ISCAL1(*),IRFVL1(3,*),IWIDE1(*)</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;      <span class="keywordtype">CHARACTER*40</span>   ANAME1(*)</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;      <span class="keywordtype">CHARACTER*24</span>   AUNIT1(*)</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;<span class="comment">C        NEW            ANCILLARY TABLE B FROM TYPE 11 BUFR MESSAGE</span></div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;      <span class="keywordtype">INTEGER</span>        KFXY2(*),ISCAL2(*),IRFVL2(*),IWIDE2(*)</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;      <span class="keywordtype">CHARACTER*64</span>   ANAME2(*)</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;      <span class="keywordtype">CHARACTER*24</span>   AUNIT2(*)</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;<span class="comment">C                       ANCILLARY TABLE D FROM TYPE 11 BUFR MESSAGE</span></div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;      <span class="keywordtype">INTEGER</span>        ITBLD2(20,*)</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;<span class="comment">C                       NEW BASE TABLE D</span></div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;      <span class="keywordtype">INTEGER</span>        ITBLD(20,*)</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;      <span class="keywordtype">INTEGER</span>        IPTR(*),ISTACK(*),NRDESC,NWLIST(200)</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;      <span class="keywordtype">INTEGER</span>        NEWREF(*),KPTRB(*),KPTRD(*)</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;      <span class="keywordtype">INTEGER</span>        IUNITB,IUNITD,ICOPY(20000),NRCOPY,IELEM,IPOS</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;      <span class="keywordtype">CHARACTER*64</span>   AHLD64</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;      <span class="keywordtype">CHARACTER*24</span>   AHLD24</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;      SAVE</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;<span class="comment">C     SCAN AND DISCARD REPLICATION AND OPERATOR DESCRIPTORS</span></div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;<span class="comment">C     REPLACING SEQUENCE DESCRIPTORS WITH THEIR CORRESPONDING</span></div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;<span class="comment">C     SET OF DESCRIPTORS ALSO ELIMINATING DUPLICATES.</span></div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;<span class="comment">C-----------------------------------------------------------</span></div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;<span class="comment">C     PRINT *,&#39;ENTER FI8812&#39;</span></div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;      <span class="keywordflow">DO</span> 10 i = 1, 16384</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;          kptrb(i) = -1</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;      <span class="keywordflow">IF</span> (iptr(14).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;          <span class="keywordflow">DO</span> i = 1, iptr(14)</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;              kptrb(kfxy1(i)) = i</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;<span class="keywordflow">          ENDDO</span></div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;          <span class="keywordflow">GO TO</span> 9000</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;<span class="comment">C                        READ IN TABLE B</span></div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;      print *,<span class="stringliteral">&#39;FI8812 - READING TABLE B&#39;</span></div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;      rewind iunitb</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;      i  = 1</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160; 4000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;      <span class="keyword">READ</span>(unit=iunitb,fmt=20,err=9999,<span class="keyword">END</span>=9000)MF,</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;     *                    mx,my,</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;     *                    (aname1(i)(k:k),k=1,40),</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;     *                    (aunit1(i)(k:k),k=1,24),</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;     *                    iscal1(i),irfvl1(1,i),iwide1(i)</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;   20 <span class="keyword">FORMAT</span>(i1,i2,i3,40a1,24a1,i5,i15,1x,i4)</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;      kfxy1(i)  = mf*16384 + mx*256 + my</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;<span class="comment">C     PRINT *,MF,MX,MY,KFXY1(I)</span></div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160; 5000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;      kptrb(kfxy1(i)) = i</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;      iptr(14) = i</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;<span class="comment">C     PRINT *,I</span></div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;<span class="comment">C     WRITE(6,21) MF,MX,MY,KFXY1(I),</span></div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;<span class="comment">C    *                    (ANAME1(I)(K:K),K=1,40),</span></div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;<span class="comment">C    *                    (AUNIT1(I)(K:K),K=1,24),</span></div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;<span class="comment">C    *                    ISCAL1(I),IRFVL1(1,I),IWIDE1(I)</span></div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;   21 <span class="keyword">FORMAT</span>(1x,i1,i2,i3,1x,i6,1x,40a1,</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;     *                                 2x,24a1,2x,i5,2x,i15,1x,i4)</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;      i = i + 1</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;      <span class="keywordflow">GO TO</span> 4000</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;<span class="comment">C ======================================================</span></div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160; 9999 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;<span class="comment">C                        ERROR READING TABLE B</span></div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;      print *,<span class="stringliteral">&#39;FI8812 -  ERROR READING TABLE B - RECORD &#39;</span>,i</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;      iptr(1)  = 9</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160; 9000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;      iptr(21) =  iptr(14)</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;<span class="comment">C     PRINT *,&#39;EXIT FI8812 - IPTR(21) =&#39;,IPTR(21),&#39; IPTR(1) =&#39;,IPTR(1)</span></div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;      <span class="keyword">SUBROUTINE </span>fi8813 (IPTR,MAXR,MAXD,MSTACK,KDATA,IDENT,KPTRD,KPTRB,</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;     *         ITBLD,ANAME1,AUNIT1,KFXY1,ISCAL1,IRFVL1,IWIDE1,IUNITB)</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;<span class="comment">C$$$  SUBPROGRAM DOCUMENTATION BLOCK</span></div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;<span class="comment">C                .      .    .                                       .</span></div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;<span class="comment">C SUBPROGRAM:    FI8813      EXTRACT TABLE A, TABLE B, TABLE D ENTRIES</span></div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;<span class="comment">C   PRGMMR: CAVANAUGH        ORG: W/NMC42    DATE: 94-03-04</span></div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;<span class="comment">C ABSTRACT: EXTRACT TABLE A, TABLE B, TABLE D ENTRIES FROM A</span></div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;<span class="comment">C   DECODED BUFR MESSAGE.</span></div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;<span class="comment">C PROGRAM HISTORY LOG:</span></div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;<span class="comment">C   94-03-04  CAVANAUGH</span></div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;<span class="comment">C   YY-MM-DD  MODIFIER1   DESCRIPTION OF CHANGE</span></div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;<span class="comment">C USAGE:    CALL FI8813 (IPTR,MAXR,MAXD,MSTACK,KDATA,IDENT,KPTRD,</span></div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;<span class="comment">C    *   KPTRB,ITBLD,ANAME1,AUNIT1,KFXY1,ISCAL1,IRFVL1,IWIDE1,IUNITB)</span></div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;<span class="comment">C   INPUT ARGUMENT LIST:</span></div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;<span class="comment">C     IPTR</span></div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;<span class="comment">C     MAXR</span></div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;<span class="comment">C     MAXD</span></div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;<span class="comment">C     MSTACK</span></div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;<span class="comment">C     KDATA</span></div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;<span class="comment">C     IDENT</span></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;<span class="comment">C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,</span></div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;<span class="comment">C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.</span></div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;<span class="comment">C   OUTPUT ARGUMENT LIST:</span></div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;<span class="comment">C     IUNITB</span></div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;<span class="comment">C     ITBLD1</span></div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;<span class="comment">C     ANAME1</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;<span class="comment">C     AUNIT1</span></div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;<span class="comment">C     KFXY1</span></div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;<span class="comment">C     ISCAL1</span></div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;<span class="comment">C     IRFVL1</span></div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;<span class="comment">C     IWIDE1</span></div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;<span class="comment">C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.</span></div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;<span class="comment">C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN</span></div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;<span class="comment">C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED</span></div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;<span class="comment">C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION</span></div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;<span class="comment">C ATTRIBUTES:</span></div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;<span class="comment">C   LANGUAGE: INDICATE EXTENSIONS, COMPILER OPTIONS</span></div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;<span class="comment">C   MACHINE:  NAS, CYBER, WHATEVER</span></div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;<span class="comment">C$$$</span></div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;<span class="comment">C        NEW            ANCILLARY TABLE B FROM TYPE 11 BUFR MESSAGE</span></div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;      <span class="keywordtype">INTEGER</span>        KFXY1(*),ISCAL1(*),IRFVL1(*),IWIDE1(*)</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;      <span class="keywordtype">CHARACTER*40</span>   ANAME1(*)</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;      <span class="keywordtype">CHARACTER*24</span>   AUNIT1(*)</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;<span class="comment">C                        TABLE D</span></div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;      <span class="keywordtype">INTEGER</span>        ITBLD(20,*)</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;      <span class="keywordtype">CHARACTER*32</span>      SPACES</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;      <span class="keywordtype">CHARACTER*8</span>       ASCCHR</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;      <span class="keywordtype">CHARACTER*32</span>      AAAA</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;      <span class="keywordtype">INTEGER</span>           I1(20),I2(20),I3(20),KPTRB(*)</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;      <span class="keywordtype">INTEGER</span>           IPTR(*),MAXR,MAXD,MSTACK(2,MAXD)</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;      <span class="keywordtype">INTEGER</span>           IXA, IXB, IXD, KDATA(MAXR,MAXD)</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;      <span class="keywordtype">INTEGER</span>           IEXTRA,KPTRD(*)</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;      <span class="keywordtype">INTEGER</span>           KEYSET,ISCSGN(200),IRFSGN(200)</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;      <span class="keywordtype">INTEGER</span>           IDENT(*),IHOLD,JHOLD(8),IUNITB</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;      EQUIVALENCE       (IHOLD,ASCCHR),(JHOLD,AAAA)</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;      SAVE</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;      DATA              SPACES/<span class="stringliteral">&#39;                                &#39;</span>/</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;      DATA              IEXTRA/0/</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;      <span class="keyword">DATA</span>              keyset/0/</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160; </div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;<span class="comment">C  ==============================================================</span></div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;<span class="comment">C     PRINT *,&#39;FI8813&#39;,IPTR(41),IPTR(42),IPTR(31),IPTR(21)</span></div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;<span class="comment">C                                 BUILD SPACE CONSTANT</span></div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;<span class="comment">C                                INITIALIZE ENTRY COUNTS</span></div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;      ixa  = 0</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;<span class="comment">C                       NUMBER IN TABLE B</span></div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;      ixb  = iptr(21)</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;<span class="comment">C                           SET FOR COMPRESSED OR NON COMPRESSED</span></div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;<span class="comment">C                                     PROCESSING</span></div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;<span class="comment">C     PRINT *,&#39;FI8813 - 2&#39;,IDENT(16),IDENT(14)</span></div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;      <span class="keywordflow">IF</span> (ident(16).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;          jk  = 1</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;          jk  = ident(14)</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;<span class="comment">C     PRINT *,&#39;FI8813 - 3,  JK=&#39;,JK</span></div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;<span class="comment">C                              START PROCESSING ENTRIES</span></div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;<span class="comment">C     PRINT *,&#39;START PROCESSING ENTRIES&#39;</span></div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;<span class="comment">C     DO 995 I = 1, IPTR(31)</span></div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;<span class="comment">C         IF (IPTR(45).EQ.4) THEN</span></div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;<span class="comment">C             PRINT 9958,I,MSTACK(1,I),KDATA(1,I),KDATA(1,I)</span></div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;<span class="comment">C9958         FORMAT (1X,I5,2X,I5,2X,Z8,2X,A4)</span></div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;<span class="comment">C         ELSE</span></div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;<span class="comment">C             PRINT 9959,I,MSTACK(1,I),KDATA(1,I),KDATA(1,I)</span></div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;<span class="comment">C9959         FORMAT (1X,I5,2X,I5,2X,Z16,2X,A8)</span></div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;<span class="comment">C         END IF</span></div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;<span class="comment">C 995 CONTINUE</span></div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;<span class="comment">C     PRINT *,&#39; &#39;</span></div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;      i       = 0</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;      iextra  = 0</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160; 1000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;<span class="comment">C                               SET POINTER TO CORRECT DATA POSITION</span></div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;<span class="comment">C                                 I IS THE NUMBER OF DESCRIPTORS</span></div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;<span class="comment">C                                 IEXTRA IS THE NUMBER OF WORDS ADDED</span></div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;<span class="comment">C                                       FOR TEXT DATA</span></div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;      i  = i + 1</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;      <span class="keywordflow">IF</span> (i.GT.iptr(31)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;<span class="comment">C                                 RETURN IF COMPLETED SEARCH</span></div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;          <span class="keywordflow">GO TO</span> 9000</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;      klk  = i + iextra</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;<span class="comment">C     PRINT *,&#39;ENTRY&#39;,KLK,I,IPTR(31),IEXTRA,MSTACK(1,KLK)</span></div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;<span class="comment">C                               IF TABLE A ENTRY OR EDITION NUMBER</span></div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;<span class="comment">C                                OR IF DESCRIPTOR IS NOT IN CLASS 0</span></div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;<span class="comment">C                                    SKIP OVER</span></div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;      <span class="keywordflow">IF</span> (mstack(1,klk).EQ.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;<span class="comment">C         PRINT *,&#39;A ENTRY&#39;</span></div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;          <span class="keywordflow">GO TO</span> 1000</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,klk).EQ.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;<span class="comment">C         PRINT *,&#39;A ENTRY LINE 1&#39;</span></div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;          iextra  = iextra + 32 / iptr(45) - 1</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;          <span class="keywordflow">GO TO</span> 1000</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,klk).EQ.3) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;<span class="comment">C         PRINT *,&#39;A ENTRY LINE 2&#39;</span></div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;          iextra  = iextra + 32 / iptr(45) - 1</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;          <span class="keywordflow">GO TO</span> 1000</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,klk).GE.34048.AND.mstack(1,klk).LE.34303) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;          ly = mod(mstack(1,klk),256)</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;<span class="comment">C         PRINT *,&#39;CLASS C - HAVE&#39;,LY,&#39; BYTES OF TEXT&#39;</span></div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;          <span class="keywordflow">IF</span> (mod(ly,iptr(45)).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;              iwds  = ly / iptr(45)</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;              iwds  = ly / iptr(45) + 1</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;          iextra  = iextra + iwds - 1</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;          <span class="keywordflow">GO TO</span> 1000</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,klk).LT.10.OR.mstack(1,klk).GT.255) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;<span class="comment">C         PRINT *,MSTACK(1,KLK),&#39;          NOT CLASS 0&#39;</span></div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;          <span class="keywordflow">GO TO</span> 1000</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;<span class="comment">C                              MUST FIND F X Y KEY FOR TABLE B</span></div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;<span class="comment">C                              OR TABLE D ENTRY</span></div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;      iz  = 1</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;      keyset  = 0</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;      <span class="keywordflow">IF</span> (i.GT.iptr(31)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;          <span class="keywordflow">GO TO</span> 9000</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;      klk  = i + iextra</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;      <span class="keywordflow">IF</span> (mstack(1,klk).GE.34048.AND.mstack(1,klk).LE.34303) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;          ly = mod(mstack(1,klk),256)</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;<span class="comment">C         PRINT *,&#39;TABLE C - HAVE&#39;,LY,&#39; TEXT BYTES&#39;</span></div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;          <span class="keywordflow">IF</span> (mod(ly,4).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;              iwds  = ly / iptr(45)</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;              iwds  = ly / iptr(45) + 1</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;          iextra  = iextra + iwds - 1</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;          i  = i + 1</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;          <span class="keywordflow">GO TO</span> 10</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,klk)/16384.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;          <span class="keywordflow">IF</span> (mod(mstack(1,klk),256).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;              i  = i + 1</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;          i  = i + 1</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;          <span class="keywordflow">GO TO</span> 10</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;      <span class="keywordflow">IF</span> (mstack(1,klk).GE.10.AND.mstack(1,klk).LE.12) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;<span class="comment">C         PRINT *,&#39;FIND KEY&#39;</span></div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;<span class="comment">C                  MUST INCLUDE PROCESSING FOR COMPRESSED DATA</span></div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;<span class="comment">C                               BUILD DESCRIPTOR SEGMENT</span></div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;          <span class="keywordflow">IF</span> (mstack(1,klk).EQ.10) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;              <span class="keyword">CALL </span>fi8814 (kdata(iz,klk),1,mf,ierr,iptr)</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;<span class="comment">C             PRINT *,&#39;F =&#39;,MF,KDATA(IZ,KLK),IPTR(31),I,IEXTRA</span></div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;              keyset  = ior(keyset,4)</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,klk).EQ.11) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;              <span class="keyword">CALL </span>fi8814 (kdata(iz,klk),2,mx,ierr,iptr)</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;<span class="comment">C             PRINT *,&#39;X =&#39;,MX,KDATA(IZ1,KLK)</span></div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;              keyset  = ior(keyset,2)</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,klk).EQ.12) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;              <span class="keyword">CALL </span>fi8814 (kdata(iz,klk),3,my,ierr,iptr)</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;<span class="comment">C             PRINT *,&#39;Y =&#39;,MY,KDATA(IZ,KLK)</span></div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;              keyset  = ior(keyset,1)</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;<span class="comment">C         PRINT *,&#39;          KEYSET =&#39;,KEYSET</span></div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;          i = i + 1</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;          <span class="keywordflow">GO TO</span> 10</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;      <span class="keywordflow">IF</span> (keyset.EQ.7) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;<span class="comment">C         PRINT *,&#39;HAVE KEY DESCRIPTOR&#39;,MF,MX,MY</span></div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;<span class="comment">C                               TEST NEXT DESCRIPTOR FOR TABLE B</span></div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;<span class="comment">C                               OR TABLE D ENTRY, PROCESS ACCORDINGLY</span></div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;          klk  = i + iextra</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;<span class="comment">C         PRINT *,&#39;DESC &#39;,MSTACK(1,KLK),KLK,I,IEXTRA,KDATA(1,KLK)</span></div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;          <span class="keywordflow">IF</span> (mstack(1,klk).EQ.30) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;              ixd  = iptr(20) + 1</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;              itbld(1,ixd) =16384 * mf + 256 * mx + my</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;<span class="comment">C             PRINT *,&#39;SEQUENCE DESCRIPTOR&#39;,MF,MX,MY,ITBLD(1,IXD)</span></div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;              <span class="keywordflow">GO TO</span> 300</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,klk).GE.13.AND.mstack(1,klk).LE.20) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;              kfxy1(ixb+iz) = 16384 * mf + 256 * mx + my</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;<span class="comment">C             PRINT *,&#39;ELEMENT DESCRIPTOR&#39;,MF,MX,MY,KFXY1(IXB+IZ),IXB+IZ</span></div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;              kptrb(kfxy1(ixb+iz)) = ixb+iz</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;              <span class="keywordflow">GO TO</span> 200</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;<span class="comment">C         I = I + 1</span></div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;<span class="comment">C         IF (I.GT.IPTR(31)) THEN</span></div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;<span class="comment">C             GO TO 9000</span></div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;<span class="comment">C         END IF</span></div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;<span class="comment">C         GO TO 10</span></div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;      <span class="keywordflow">GO TO</span> 1000</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;<span class="comment">C  ==================================================================</span></div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;  200 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;      ibflag   = 1</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;   20 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;      klk  = i + iextra</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;<span class="comment">C     PRINT *,&#39;ZZZ&#39;,KLK,I,IEXTRA,MSTACK(1,KLK),KDATA(IZ,KLK)</span></div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;      <span class="keywordflow">IF</span> (mstack(1,klk).LT.13.OR.mstack(1,klk).GT.20) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;              print *,<span class="stringliteral">&#39;IMPROPER SEQUENCE OF DESCRIPTORS IN LIST&#39;</span></div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;<span class="comment">C  ===============================================================</span></div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,klk).EQ.13) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;<span class="comment">C         PRINT *,&#39;13      NAME&#39;,KLK</span></div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;<span class="comment">C                              ELEMENT NAME PART 1 - 32 BYTES</span></div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;<span class="comment">C                                    FOR THIS PARAMETER</span></div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;          jj  = iextra</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;          <span class="keywordflow">DO</span> 21 ll = 1, 32, iptr(45)</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;              lll    = ll + iptr(45) - 1</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;              kqk = i + jj</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;              ihold  = kdata(iz,kqk)</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;              <span class="keywordflow">IF</span> (iptr(37).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;<span class="comment">C                 CALL W3AI39 (IDATA,IPTR(45))</span></div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;              aname1(ixb+iz)(ll:lll) = ascchr</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;              jj  = jj + 1</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;   21     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;          iextra  = iextra + (32 / iptr(45)) - 1</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;          ibflag   = ior(ibflag,64)</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;<span class="comment">C  ===============================================================</span></div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,klk).EQ.14) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;<span class="comment">C         PRINT *,&#39;14      NAME2&#39;,KLK</span></div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;<span class="comment">C                              ELEMENT NAME PART 2 - 32 BYTES</span></div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;<span class="comment">C                                    FOR THIS PARAMETER</span></div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;          jj  = iextra</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;          <span class="keywordflow">DO</span> 22 ll = 33, 64, iptr(45)</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;              lll    = ll + iptr(45) - 1</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;              kqk = i + jj</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;              ihold  = kdata(iz,kqk)</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;              <span class="keywordflow">IF</span> (iptr(37).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;<span class="comment">C                 CALL W3AI39 (ASCCHR,IPTR(45))</span></div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;              aname1(ixb+iz)(ll:lll) = ascchr</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;              jj  = jj + 1</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;   22     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;          iextra  = iextra + (32 / iptr(45)) - 1</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;          ibflag   = ior(ibflag,32)</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;<span class="comment">C  ===============================================================</span></div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,klk).EQ.15) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;<span class="comment">C         PRINT *,&#39;15      UNITS&#39;,KLK</span></div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;<span class="comment">C                              UNITS NAME - 24 BYTES</span></div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;<span class="comment">C                                    FOR THIS PARAMETER</span></div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;          jj  = iextra</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;          <span class="keywordflow">DO</span> 23 ll = 1, 24, iptr(45)</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;              lll    = ll + iptr(45) - 1</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;              kqk = i + jj</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;              ihold  = kdata(iz,kqk)</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;              <span class="keywordflow">IF</span> (iptr(37).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;<span class="comment">C                 CALL W3AI39 (ASCCHR,IPTR(45))</span></div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;              aunit1(ixb+iz)(ll:lll) = ascchr</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;              jj  = jj + 1</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;   23     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;          iextra  = iextra + (24 / iptr(45)) - 1</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;          ibflag   = ior(ibflag,16)</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;<span class="comment">C  ===============================================================</span></div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,klk).EQ.16) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;<span class="comment">C         PRINT *,&#39;16      SCALE SIGN&#39;</span></div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;<span class="comment">C                               SCALE SIGN - 1 BYTE</span></div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;<span class="comment">C                              0 = POS, 1 = NEG</span></div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;          ihold = kdata(iz,klk)</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;          klk  = i + iextra</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;          <span class="keywordflow">IF</span> (index(ascchr,<span class="stringliteral">&#39;-&#39;</span>).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;              iscsgn(iz)  = 1</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;              iscsgn(iz)  = -1</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;<span class="comment">C  ===============================================================</span></div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,klk).EQ.17) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;<span class="comment">C         PRINT *,&#39;17      SCALE&#39;,KLK</span></div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;<span class="comment">C                               SCALE - 3 BYTES</span></div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;          klk = i + iextra</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;          <span class="keyword">CALL </span>fi8814(kdata(iz,klk),3,iscal1(ixb+iz),ierr,iptr)</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;          <span class="keywordflow">IF</span> (ierr.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;              print *,<span class="stringliteral">&#39;NON-NUMERIC CHAR - CANNOT CONVERT&#39;</span></div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;              iptr(1) = 888</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;              <span class="keywordflow">GO TO</span> 9000</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;          iscal1(ixb+iz) = iscal1(ixb+iz) * iscsgn(iz)</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;          ibflag   = ior(ibflag,8)</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;<span class="comment">C  ===============================================================</span></div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,klk).EQ.18) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;<span class="comment">C         PRINT *,&#39;18      REFERENCE SCALE&#39;,KLK</span></div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;<span class="comment">C                              REFERENCE SIGN - 1 BYTE</span></div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;<span class="comment">C                              0 = POS, 1 = NEG</span></div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;          klk  = i + iextra</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;          ihold  = kdata(iz,klk)</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;          <span class="keywordflow">IF</span> (index(ascchr,<span class="stringliteral">&#39;-&#39;</span>).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;              irfsgn(iz) =  1</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;              irfsgn(iz) = -1</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;<span class="comment">C  ===============================================================</span></div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mstack(1,klk).EQ.19) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;<span class="comment">C         PRINT *,&#39;19      REFERENCE VALUE&#39;,KLK</span></div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;<span class="comment">C                              REFERENCE VALUE - 10 BYTES/ 3 WDS</span></div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;          jj  = iextra</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;          kqk  = i + jj</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;          km  = 0</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;          <span class="keywordflow">DO</span> 26 ll = 1, 12, iptr(45)</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;              kqk = i + jj</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;              km  = km + 1</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;              jhold(km)  = kdata(iz,kqk)</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;              jj  = jj + 1</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;   26     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;          <span class="keyword">CALL </span>fi8814(aaaa,10,irfvl1(ixb+iz),ierr,iptr)</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;          <span class="keywordflow">IF</span> (ierr.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;              print *,<span class="stringliteral">&#39;NON-NUMERIC CHARACTER-CANNOT CONVERT&#39;</span></div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;              iptr(1)  = 888</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;              <span class="keywordflow">GO TO</span> 9000</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;          irfvl1(ixb+iz) = irfvl1(ixb+iz) * irfsgn(iz)</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;          iextra  = iextra + 10 / iptr(45)</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;<span class="comment">C         DO 261 IZ = 1, JK</span></div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;<span class="comment">C             PRINT *,&#39;RFVAL&#39;,IXB+IZ,JK,IRFVL1(IXB+IZ)</span></div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;<span class="comment">C 261     CONTINUE</span></div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;          ibflag   = ior(ibflag,4)</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;<span class="comment">C  ===============================================================</span></div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;<span class="comment">C         PRINT *,&#39;20      WIDTH&#39;,KLK</span></div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;<span class="comment">C                              ELEMENT DATA WIDTH - 3 BYTES</span></div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;<span class="comment">C         DO 27 LL = 1, 24, IPTR(45)</span></div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;              klk = i + iextra</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;<span class="comment">C             DO 270 IZ = 1, JK</span></div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;                  <span class="keyword">CALL </span>fi8814(kdata(iz,klk),3,iwide1(ixb+iz),ierr,iptr)</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;                  <span class="keywordflow">IF</span> (ierr.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;                      print *,<span class="stringliteral">&#39;NON-NUMERIC CHAR - CANNOT CONVERT&#39;</span></div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;                      iptr(1) = 888</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;                      <span class="keywordflow">GO TO</span> 9000</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;                  <span class="keywordflow">IF</span> (iwide1(ixb+iz).LT.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;                      iptr(1) = 890</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;<span class="comment">C                    PRINT *,&#39;CLASS 0 DESCRIPTOR, WIDTH=0&#39;,KFXY1(IXB+IZ)</span></div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;                      <span class="keywordflow">GO TO</span> 9000</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;<span class="comment">C 270         CONTINUE</span></div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;<span class="comment">C  27     CONTINUE</span></div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;          ibflag   = ior(ibflag,2)</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;<span class="comment">C                                       NO, IT ISN&#39;T</span></div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;<span class="comment">C                             IF THERE ARE ENOUGH OF THE ELEMENTS</span></div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;<span class="comment">C                             NECESSARY TO ACCEPT A TABLE B ENTRY</span></div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;<span class="comment">C         PRINT *,&#39;                      IBFLAG =&#39;,IBFLAG</span></div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;      <span class="keywordflow">IF</span> (ibflag.EQ.127) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;<span class="comment">C         PRINT *,&#39;COMPLETE TABLE B ENTRY&#39;</span></div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;<span class="comment">C                  HAVE A COMPLETE TABLE B ENTRY</span></div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;          ixb  = ixb + 1</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;<span class="comment">C         PRINT *,&#39;B&#39;,IXB,JK,KFXY1(IXB),ANAME1(IXB)</span></div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;<span class="comment">C         PRINT *,&#39;     &#39;,AUNIT1(IXB),ISCAL1(IXB),</span></div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;<span class="comment">C    *    IRFVL1(IXB),IWIDE1(IXB)</span></div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;          iptr(21) = ixb</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;          <span class="keywordflow">GO TO</span> 1000</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;      i  = i + 1</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;<span class="comment">C                             CHECK NEXT DESCRIPTOR</span></div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;      <span class="keywordflow">IF</span> (i.GT.iptr(31)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;<span class="comment">C                                 RETURN IF COMPLETED SEARCH</span></div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;          <span class="keywordflow">GO TO</span> 9000</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;      <span class="keywordflow">GO TO</span> 20</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;<span class="comment">C  ==================================================================</span></div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;  300 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;      iseq  = 0</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;      ijk  = iptr(20) + 1</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;<span class="comment">C     PRINT *,&#39;SEQUENCE DESCRIPTOR&#39;,MF,MX,MY,ITBLD(1,IXD),&#39; FOR&#39;,IJK</span></div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;   30 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;      klk  = i + iextra</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;<span class="comment">C     PRINT *,&#39;HAVE A SEQUENCE DESCRIPTOR&#39;,KLK,KDATA(IZ,KLK)</span></div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;      <span class="keywordflow">IF</span> (mstack(1,klk).EQ.30) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;<span class="comment">C                             FROM TEXT FIELD (6 BYTES/2 WDS)</span></div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;<span class="comment">C                             STRIP OUT NEXT DESCRIPTOR IN SEQUENCE</span></div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;<span class="comment">C                             F - EXTRACT AND CONVERT TO DECIMAL</span></div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;          jj  = iextra</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;          kk  = 0</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;          <span class="keywordflow">DO</span> 351 ll = 1, 6, iptr(45)</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;              kqk  = i + jj</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;              kk = kk + 1</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;              jhold(kk)  = kdata(1,kqk)</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;              jj  = jj + 1</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;              <span class="keywordflow">IF</span> (ll.GT.1) iextra  = iextra + 1</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;  351     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;<span class="comment">C         PRINT 349,KDATA(1,KQK)</span></div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;  349     <span class="keyword">FORMAT</span> (6x,z24)</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;<span class="comment">C                                     CONVERT TO INTEGER</span></div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;          <span class="keyword">CALL </span>fi8814(aaaa,6,ihold,ierr,iptr)</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;<span class="comment">C         PRINT *,&#39;                         &#39;,IHOLD</span></div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;          <span class="keywordflow">IF</span> (ierr.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;              print *,<span class="stringliteral">&#39;NON NUMERIC CHARACTER FOUND IN F X Y&#39;</span></div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;              iptr(1)  = 888</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;              <span class="keywordflow">GO TO</span> 9000</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;<span class="comment">C                                CONSTRUCT SEQUENCE DESCRIPTOR</span></div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;          iff  = ihold / 100000</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;          ixx  = mod((ihold/1300),100)</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;          iyy  = mod(ihold,1300)</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;<span class="comment">C                                 INSERT IN PROPER SEQUENCE</span></div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;          itbld(iseq+2,ijk) = 16384 * iff + 256 * ixx + iyy</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;<span class="comment">C         PRINT *,&#39;    SEQUENCE&#39;,IZ,AAAA,IHOLD,ITBLD(ISEQ+2,IJK),</span></div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;<span class="comment">C    *                     IFF,IXX,IYY</span></div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;          iseq  = iseq + 1</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;          <span class="keywordflow">IF</span> (iseq.GT.18) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;              iptr(1) = 30</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;              <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;<span class="comment">C                                SET TO LOOK AT NEXT DESCRIPTOR</span></div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;          i  = i + 1</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;<span class="comment">C         IF (IPTR(45).LT.6) THEN</span></div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;<span class="comment">C             IEXTRA  = IEXTRA + 1</span></div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;<span class="comment">C         END IF</span></div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;          <span class="keywordflow">GO TO</span> 30</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;<span class="comment">C                     NEXT DESCRIPTOR IS NOT A SEQUENCE DESCRIPTOR</span></div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;          <span class="keywordflow">IF</span> (iseq.GE.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;<span class="comment">C                           HAVE COMPLETE TABLE D ENTRY</span></div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;              iptr(20) = iptr(20) + 1</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;<span class="comment">C             PRINT *,&#39;                        INTO LOCATION &#39;,IPTR(20)</span></div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;              lz       = itbld(1,ijk)</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;              mz       = mod(lz,16384)</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;              kptrd(mz) = ijk</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;              i  = i - 1</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;<span class="comment">C                              GO TEST  NEXT DESCRIPTOR</span></div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;      <span class="keywordflow">GO TO</span> 1000</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;<span class="comment">C  ==================================================================</span></div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160; 9000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;<span class="comment">C     PRINT *,IPTR(21),&#39; ENTRIES IN ANCILLARY TABLE B&#39;</span></div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;<span class="comment">C     PRINT *,IPTR(20),&#39; ENTRIES IN ANCILLARY TABLE D&#39;</span></div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;<span class="comment">C     DO 9050 L = 1, 16384</span></div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;<span class="comment">C         IF (KPTRD(L).GT.0) PRINT *,&#39; D&#39;,L+32768, KPTRD(L)</span></div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;<span class="comment">C9050 CONTINUE</span></div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;<span class="comment">C     IF (I.GE.IPTR(31)) THEN</span></div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;<span class="comment">C       FILE FOR MODIFIED TABLE B OUTPUT</span></div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;          numnut = iunitb + 1</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;          rewind numnut</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;<span class="comment">C             PRINT *,&#39; HERE IS THE NEW TABLE B&#39;,IPTR(21)</span></div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;              <span class="keywordflow">DO</span> 2000 kb = 1, iptr(21)</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;                  jf  = kfxy1(kb) / 16384</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;                  jx  = mod((kfxy1(kb) / 256),64)</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;                  jy  = mod(kfxy1(kb),256)</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;<span class="comment">C                 WRITE (6,2001)JF,JX,JY,ANAME1(KB),</span></div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;<span class="comment">C    *                    AUNIT1(KB),ISCAL1(KB),IRFVL1(KB),IWIDE1(KB)</span></div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;                  <span class="keyword">WRITE</span> (numnut,5000)jf,jx,jy,aname1(kb)(1:40),</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;     *               aunit1(kb)(1:24),iscal1(kb),irfvl1(kb),iwide1(kb)</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160; 5000             <span class="keyword">FORMAT</span>(i1,i2,i3,a40,a24,i5,i15,i5)</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160; 2000         <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160; 2001         <span class="keyword">FORMAT</span> (1x,i1,1x,i2,1x,i3,2x,a40,3x,a24,2x,i5,2x,i12,</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;     *                     2x,i4)</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;              endfile numnut</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;          <span class="keywordflow">IF</span> (iptr(20).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;<span class="comment">C                                  PRINT OUT TABLE</span></div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;<span class="comment">C             PRINT *,&#39; HERE IS THE UPGRADED TABLE D&#39;</span></div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;<span class="comment">C             DO 3000 KB = 1, IPTR(20)</span></div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;<span class="comment">C                 PRINT 3001,KB,(ITBLD(K,KB),K=1,15)</span></div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;<span class="comment">C3000         CONTINUE</span></div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;<span class="comment">C3001         FORMAT (16(1X,I5))</span></div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;<span class="comment">C                                    EXIT ROUTINE, ALL DONE WITH PASS</span></div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;<span class="comment">C     END IF</span></div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;      <span class="keyword">SUBROUTINE </span>fi8814 (ASCCHR,NPOS,NEWVAL,IERR,IPTR)</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;<span class="comment">C$$$  SUBPROGRAM DOCUMENTATION BLOCK</span></div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;<span class="comment">C                .      .    .                                       .</span></div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;<span class="comment">C SUBPROGRAM:    FI8814      CONVERT TEXT TO INTEGER</span></div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;<span class="comment">C   PRGMMR: CAVANAUGH        ORG: W/NMC42    DATE: 94-03-04</span></div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;<span class="comment">C ABSTRACT: CONVERT TEXT CHARACTERS TO INTEGER VALUE</span></div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;<span class="comment">C PROGRAM HISTORY LOG:</span></div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;<span class="comment">C   94-03-04  CAVANAUGH</span></div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;<span class="comment">C   YY-MM-DD  MODIFIER2   DESCRIPTION OF CHANGE</span></div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;<span class="comment">C USAGE:    CALL FI8814 (ASCCHR,NPOS,NEWVAL,IERR,IPTR)</span></div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;<span class="comment">C   INPUT ARGUMENT LIST:</span></div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;<span class="comment">C     ASCCHR   -</span></div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;<span class="comment">C     NPOS     -</span></div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;<span class="comment">C     NEWVAL   -</span></div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;<span class="comment">C     IERR     -</span></div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;<span class="comment">C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,</span></div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;<span class="comment">C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.</span></div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;<span class="comment">C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)</span></div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;<span class="comment">C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.</span></div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;<span class="comment">C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN</span></div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;<span class="comment">C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED</span></div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;<span class="comment">C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)</span></div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;<span class="comment">C     DDNAME1  - GENERIC NAME &amp; CONTENT</span></div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;<span class="comment">C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)</span></div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;<span class="comment">C     DDNAME2  - GENERIC NAME &amp; CONTENT AS ABOVE</span></div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;<span class="comment">C     FT06F001 - INCLUDE IF ANY PRINTOUT</span></div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;<span class="comment">C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION</span></div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;<span class="comment">C ATTRIBUTES:</span></div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;<span class="comment">C   LANGUAGE: INDICATE EXTENSIONS, COMPILER OPTIONS</span></div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;<span class="comment">C   MACHINE:  NAS, CYBER, WHATEVER</span></div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;<span class="comment">C$$$</span></div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;      <span class="keywordtype">INTEGER</span>      IERR, IHOLD, IPTR(*)</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;      <span class="keywordtype">CHARACTER*8</span>  AHOLD</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;      <span class="keywordtype">CHARACTER*64</span> ASCCHR</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;      EQUIVALENCE  (IHOLD,AHOLD)</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160; </div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;      SAVE</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;<span class="comment">C  ----------------------------------------------------------</span></div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;      IERR    = 0</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;      newval  = 0</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;      iflag  = 0</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;      <span class="keywordflow">DO</span> 1000 i = 1, npos</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;          ihold  = 0</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;          ahold(iptr(45):iptr(45)) = ascchr(i:i)</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;          <span class="keywordflow">IF</span> (iptr(37).EQ.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;              <span class="keywordflow">IF</span> (ihold.EQ.32) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;                  <span class="keywordflow">IF</span> (iflag.EQ.0) <span class="keywordflow">GO TO</span> 1000</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;                  <span class="keywordflow">GO TO</span> 2000</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (ihold.LT.48.OR.ihold.GT.57) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;<span class="comment">C                 PRINT*,&#39; ASCII IHOLD =&#39;,IHOLD</span></div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;                  ierr       = 1</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;                  <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;                  iflag  = 1</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;                  newval     = newval * 10 + ihold - 48</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;              <span class="keywordflow">IF</span> (ihold.EQ.64) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;                  <span class="keywordflow">IF</span> (iflag.EQ.0) <span class="keywordflow">GO TO</span> 1000</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;                  <span class="keywordflow">GO TO</span> 2000</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (ihold.LT.240.OR.ihold.GT.249) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;<span class="comment">C                 PRINT*,&#39; EBCIDIC IHOLD =&#39;,IHOLD</span></div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;                  ierr       = 1</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;                  <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;                  iflag  = 1</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;                  newval     = newval * 10 + ihold - 240</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160; 1000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160; 2000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;      <span class="keyword">SUBROUTINE </span>fi8815(IPTR,IDENT,JDESC,KDATA,KFXY3,MAXR,MAXD,</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;     *                                ANAME3,AUNIT3,</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;     *                                ISCAL3,IRFVL3,IWIDE3,</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;     *                                KEYSET,IBFLAG,IERR)</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;<span class="comment">C$$$  SUBPROGRAM DOCUMENTATION BLOCK</span></div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;<span class="comment">C                .      .    .                                       .</span></div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;<span class="comment">C SUBPROGRAM:    FI8815      EXTRACT TABLE A, TABLE B, TABLE D ENTRIES</span></div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;<span class="comment">C   PRGMMR: CAVANAUGH        ORG: W/NMC42    DATE: 94-03-04</span></div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;<span class="comment">C ABSTRACT: EXTRACT TABLE A, TABLE B, ENTRIES FROM ACTIVE BUFR MESSAGE</span></div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;<span class="comment">C   TO BE RETAINED FOR USE DURING THE DECODING OF ACTIVE BUFR MESSAGE.</span></div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;<span class="comment">C   THESE WILL BE DISCARDED WHEN DECODING OF CURRENT MESSAGE IS COMPLETE</span></div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;<span class="comment">C PROGRAM HISTORY LOG:</span></div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;<span class="comment">C   94-03-04  CAVANAUGH</span></div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;<span class="comment">C   YY-MM-DD  MODIFIER1   DESCRIPTION OF CHANGE</span></div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;<span class="comment">C USAGE:    CALL FI8815(IPTR,IDENT,JDESC,KDATA,KFXY3,MAXR,MAXD,</span></div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;<span class="comment">C    *                                ANAME3,AUNIT3,</span></div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;<span class="comment">C    *                                ISCAL3,IRFVL3,IWIDE3,</span></div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;<span class="comment">C    *                                KEYSET,IBFLAG,IERR)</span></div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;<span class="comment">C   INPUT ARGUMENT LIST:</span></div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;<span class="comment">C     IPTR     -</span></div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;<span class="comment">C     MAXR     -</span></div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;<span class="comment">C     MAXD     -</span></div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;<span class="comment">C     MSTACK   -</span></div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;<span class="comment">C     KDATA    -</span></div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;<span class="comment">C     IDENT    -</span></div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;<span class="comment">C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,</span></div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;<span class="comment">C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.</span></div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;<span class="comment">C   OUTPUT ARGUMENT LIST:</span></div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;<span class="comment">C     ANAME3   -</span></div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;<span class="comment">C     AUNIT3   -</span></div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;<span class="comment">C     KFXY3    -</span></div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;<span class="comment">C     ISCAL3   -</span></div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;<span class="comment">C     IRFVL3   -</span></div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;<span class="comment">C     IWIDE3   -</span></div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;<span class="comment">C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.</span></div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;<span class="comment">C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN</span></div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;<span class="comment">C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED</span></div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;<span class="comment">C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION</span></div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;<span class="comment">C ATTRIBUTES:</span></div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;<span class="comment">C   LANGUAGE: INDICATE EXTENSIONS, COMPILER OPTIONS</span></div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;<span class="comment">C   MACHINE:  NAS, CYBER</span></div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;<span class="comment">C$$$</span></div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;      <span class="keywordtype">CHARACTER*64</span>      ANAME3(*),SPACES</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;      <span class="keywordtype">CHARACTER*24</span>      AUNIT3(*)</div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;      <span class="keywordtype">INTEGER</span>           IPTR(*),MAXR,MAXD,JDESC</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;      <span class="keywordtype">INTEGER</span>           IXA, IXB, IXD, KDATA(MAXR,MAXD)</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;      <span class="keywordtype">INTEGER</span>           IEXTRA</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;      <span class="keywordtype">INTEGER</span>           KEYSET</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;      <span class="keywordtype">INTEGER</span>           KFXY3(*),IDENT(*)</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;      <span class="keywordtype">INTEGER</span>           ISCAL3(*),ISCSGN(150)</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;      <span class="keywordtype">INTEGER</span>           IRFVL3(*),IRFSGN(150)</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;      <span class="keywordtype">INTEGER</span>           IWIDE3(*)</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160; </div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;      SAVE</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;<span class="comment">C  ==============================================================</span></div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;<span class="comment">C     PRINT *,&#39;FI8815&#39;</span></div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;      IEXTRA  = 0</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;<span class="comment">C                                 BUILD SPACE CONSTANT</span></div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;      do 1 i = 1, 64</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;          spaces(i:i)  = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;    1 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;<span class="comment">C                                INITIALIZE ENTRY COUNTS</span></div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;      ixa  = 0</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;      ixb  = 0</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;      ixd  = 0</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;<span class="comment">C                           SET FOR COMPRESSED OR NON COMPRESSED</span></div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;<span class="comment">C                                     PROCESSING</span></div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;      <span class="keywordflow">IF</span> (ident(16).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;          jk  = 1</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;          jk  = ident(14)</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;<span class="comment">C                           CLEAR NECESSARY ENTRIES</span></div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;      <span class="keywordflow">DO</span> 2 iy = 1, jk</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;<span class="comment">C                           CLEAR NEXT TABLE B ENTRY</span></div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;          kfxy3(ixb+iy)   = 0</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;          aname3(ixb+iy)(1:64)  = spaces(1:64)</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;          aunit3(ixb+iy)(1:24)  = spaces(1:24)</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;          iscal3(ixb+iy)  = 0</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;          irfvl3(ixb+iy)  = 0</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;          iwide3(ixb+iy)  = 0</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;          iscsgn(iy)      = 1</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;          irfsgn(iy)      = 1</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;    2 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;<span class="comment">C                              START PROCESSING ENTRIES</span></div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;      i  = 0</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160; 1000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;<span class="comment">C                               SET POINTER TO CORRECT DATA POSITION</span></div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;      k  = i + iextra</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;<span class="comment">C                              MUST FIND F X Y KEY FOR TABLE B</span></div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;<span class="comment">C                              OR TABLE D ENTRY</span></div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;      <span class="keywordflow">IF</span> (jdesc.GE.10.AND.jdesc.LE.12) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;   10     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;<span class="comment">C                               BUILD DESCRIPTOR SEGMENT</span></div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;          <span class="keywordflow">DO</span> 20 ly  = 1,jk</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;              <span class="keywordflow">IF</span> (jdesc.EQ.10) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;                  kfxy3(ixb+ly) = kdata(k,1) * 16384 + kfxy3(ixb+ly)</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;                  keyset  = ior(keyset,4)</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;                  i = i + 1</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;                  <span class="keywordflow">GO TO</span> 10</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (jdesc.EQ.11) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;                  kfxy3(ixb+ly) = kdata(k,1) * 256 + kfxy3(ixb+ly)</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;                  keyset  = ior(keyset,2)</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;                  i = i + 1</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;                  <span class="keywordflow">GO TO</span> 10</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (jdesc.EQ.12) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;                  kfxy3(ixb+ly) = kdata(k,1) + kfxy3(ixb+ly)</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;                  keyset  = ior(keyset,1)</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;   20     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;<span class="comment">C  ==================================================================</span></div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (jdesc.GE.13.AND.jdesc.LE.20) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;          <span class="keywordflow">DO</span> 250 iz = 1, jk</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;              <span class="keywordflow">IF</span> (jdesc.EQ.13) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;<span class="comment">C                              ELEMENT NAME PART 1 - 32 BYTES/8 WDS</span></div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="gbytes_8f.html#ac957b0c87f1261d8460c52bfec7d0308">gbytes</a> (aname3(ixb+iz),kdata(k,iz),0,32,0,8)</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;                  ibflag   = ior(ibflag,16)</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (jdesc.EQ.14) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;<span class="comment">C                              ELEMENT NAME PART 2 - 32 BYTES/8 WDS</span></div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;                 <span class="keyword">CALL </span><a class="code" href="gbytes_8f.html#ac957b0c87f1261d8460c52bfec7d0308">gbytes</a>(aname3(ixb+iz)(33:33),kdata(k,iz),0,32,0,8)</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (jdesc.EQ.15) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;<span class="comment">C                              UNITS NAME - 24 BYTES/6 WDS</span></div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="gbytes_8f.html#ac957b0c87f1261d8460c52bfec7d0308">gbytes</a> (aunit3(ixb+iz)(1:1),kdata(k,iz),0,32,0,6)</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;                  ibflag   = ior(ibflag,8)</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (jdesc.EQ.16) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;<span class="comment">C                              UNITS SCALE SIGN - 1 BYTE/ 1 WD</span></div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;<span class="comment">C                              0 = POS, 1 = NEG</span></div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;                  <span class="keywordflow">IF</span> (kdata(k,1).NE.48) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;                      iscsgn(iz)  = -1</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;                      iscsgn(iz)  = 1</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (jdesc.EQ.17) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;<span class="comment">C                              UNITS SCALE - 3 BYTES/ 1 WD</span></div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;                  <span class="keyword">CALL </span>fi8814(kdata(k,iz),3,iscal3(ixb+iz),ierr,iptr)</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;                  <span class="keywordflow">IF</span> (ierr.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;                      print *,<span class="stringliteral">&#39;NON-NUMERIC CHARACTER - CANNOT CONVERT&#39;</span></div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;                      iptr(1) = 888</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;                      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;                  ibflag   = ior(ibflag,4)</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (jdesc.EQ.18) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;<span class="comment">C                              UNITS REFERENCE SIGN - 1 BYTE/ 1 WD</span></div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;<span class="comment">C                              0 = POS, 1 = NEG</span></div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;                  <span class="keywordflow">IF</span> (kdata(k,1).EQ.48) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;                      irfsgn(iz) =  1</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;                      irfsgn(iz) = -1</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (jdesc.EQ.19) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;<span class="comment">C                              UNITS REFERENCE VALUE - 10 BYTES/ 3 WDS</span></div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;                  <span class="keyword">CALL </span>fi8814(kdata(k,iz),10,irfvl3(ixb+iz),ierr,iptr)</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;                  <span class="keywordflow">IF</span> (ierr.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;                      print *,<span class="stringliteral">&#39;NON-NUMERIC CHARACTER-CANNOT CONVERT&#39;</span></div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;                      iptr(1)  = 888</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;                      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;                  ibflag   = ior(ibflag,2)</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;<span class="comment">C                              ELEMENT DATA WIDTH - 3 BYTES/ 1 WD</span></div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;                  <span class="keyword">CALL </span>fi8814(kdata(k,1),3,iwide3(ixb+1),ierr,iptr)</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;                  <span class="keywordflow">IF</span> (ierr.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;                      print *,<span class="stringliteral">&#39;NON-NUMERIC CHARACTER-CANNOT CONVERT&#39;</span></div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;                      iptr(1)  = 888</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;                      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;                  ibflag   = ior(ibflag,1)</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;  250     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;<span class="comment">C  ==================================================================</span></div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160; 9000 <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;      <span class="keyword">SUBROUTINE </span>fi8818(IPTR,</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;     *                KFXY1,ANAME1,AUNIT1,ISCAL1,IRFVL1,IWIDE1,</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;     *                KFXY2,ANAME2,AUNIT2,ISCAL2,IRFVL2,IWIDE2,</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;     *                KPTRB)</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;<span class="comment">C$$$  SUBPROGRAM DOCUMENTATION BLOCK</span></div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;<span class="comment">C                .      .    .                                       .</span></div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;<span class="comment">C SUBPROGRAM:    FI8818      MERGE ANCILLARY &amp; STANDARD B ENTRIES</span></div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;<span class="comment">C   PRGMMR: CAVANAUGH        ORG: W/NMC42    DATE: YY-MM-DD</span></div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;<span class="comment">C ABSTRACT: START ABSTRACT HERE AND INDENT TO COLUMN 5 ON THE</span></div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;<span class="comment">C   FOLLOWING LINES.  SEE NMC HANDBOOK SECTION 3.1.1. FOR DETAILS</span></div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;<span class="comment">C PROGRAM HISTORY LOG:</span></div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;<span class="comment">C   YY-MM-DD  CAVANAUGH</span></div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;<span class="comment">C   YY-MM-DD  MODIFIER1   DESCRIPTION OF CHANGE</span></div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;<span class="comment">C USAGE:    CALL FI8818(IPTR,</span></div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;<span class="comment">C    *                KFXY1,ANAME1,AUNIT1,ISCAL1,IRFVL1,IWIDE1,</span></div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;<span class="comment">C    *                KFXY2,ANAME2,AUNIT2,ISCAL2,IRFVL2,IWIDE2,KPTRB)</span></div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;<span class="comment">C   INPUT ARGUMENT LIST:</span></div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;<span class="comment">C     IPTR     -</span></div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;<span class="comment">C     KFXY1    -</span></div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;<span class="comment">C     ANAME1   -</span></div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;<span class="comment">C     AUNIT1   -</span></div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;<span class="comment">C     ISCAL1   -</span></div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;<span class="comment">C     IRFVL1   -</span></div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;<span class="comment">C     IWIDE1   -</span></div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;<span class="comment">C     KFXY2    -</span></div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;<span class="comment">C     ANAME2   -</span></div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;<span class="comment">C     AUNIT2   -</span></div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;<span class="comment">C     ISCAL2   -</span></div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;<span class="comment">C     IRFVL2   -</span></div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;<span class="comment">C     IWIDE2   -</span></div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;<span class="comment">C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)</span></div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;<span class="comment">C     IPTR     -</span></div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;<span class="comment">C     KFXY1    -</span></div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;<span class="comment">C     ANAME1   -</span></div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;<span class="comment">C     AUNIT1   -</span></div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;<span class="comment">C     ISCAL1   -</span></div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;<span class="comment">C     IRFVL1   -</span></div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;<span class="comment">C     IWIDE1   -</span></div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;<span class="comment">C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION</span></div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;<span class="comment">C ATTRIBUTES:</span></div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;<span class="comment">C   LANGUAGE: INDICATE EXTENSIONS, COMPILER OPTIONS</span></div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;<span class="comment">C   MACHINE:  NAS, CYBER, WHATEVER</span></div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;<span class="comment">C$$$</span></div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;<span class="comment">C     NEW               BASE TABLE B</span></div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;<span class="comment">C                            MAY BE A COMBINATION OF MASTER TABLE B</span></div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;<span class="comment">C                            AND ANCILLARY TABLE B</span></div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;      <span class="keywordtype">INTEGER</span>        KFXY1(*),ISCAL1(*),IRFVL1(3,*),IWIDE1(*)</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;      <span class="keywordtype">CHARACTER*40</span>   ANAME1(*)</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;      <span class="keywordtype">CHARACTER*24</span>   AUNIT1(*)</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;<span class="comment">C        NEW            ANCILLARY TABLE B FROM TYPE 11 BUFR MESSAGE</span></div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;      <span class="keywordtype">INTEGER</span>        KFXY2(*),ISCAL2(*),IRFVL2(*),IWIDE2(*)</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;      <span class="keywordtype">CHARACTER*64</span>   ANAME2(*)</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;      <span class="keywordtype">CHARACTER*24</span>   AUNIT2(*)</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;      <span class="keywordtype">INTEGER</span>           IPTR(*),KPTRB(*)</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160; </div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;      SAVE</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;<span class="comment">C                       SET UP POINTERS</span></div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;<span class="comment">C     PRINT *,&#39;FI8818-A&#39;,IPTR(21),IPTR(41)</span></div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;      KAB   = 1</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;      kb    = 1</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160; 1000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;<span class="comment">C     PRINT *,KB,KAB,KFXY1(KB),KFXY2(KAB),IPTR(21)</span></div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;      <span class="keywordflow">IF</span> (kb.GT.iptr(21)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;<span class="comment">C                                 NO MORE MASTER ENTRIES</span></div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;<span class="comment">C         PRINT *,&#39;NO MORE MASTER ENTRIES&#39;</span></div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;          <span class="keywordflow">IF</span> (kab.GT.iptr(41)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;               <span class="keywordflow">GO TO</span> 5000</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;<span class="comment">C                                  APPEND ANCILLARY ENTRY</span></div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;          <span class="keywordflow">GO TO</span> 2000</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (kb.LE.iptr(21)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;<span class="comment">C                                  HAVE MORE MASTER ENTRIES</span></div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;          <span class="keywordflow">IF</span> (kab.GT.iptr(41)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;<span class="comment">C                                  NO MORE ANCILLARY ENTRIES</span></div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;              <span class="keywordflow">GO TO</span> 5000</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;          <span class="keywordflow">IF</span> (kfxy2(kab).EQ.kfxy1(kb)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;<span class="comment">C                                  REPLACE MASTER ENTRY</span></div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;              <span class="keywordflow">GO TO</span> 3000</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (kfxy2(kab).LT.kfxy1(kb)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;<span class="comment">C                                  INSERT ANCILLARY ENTRY</span></div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;              <span class="keywordflow">GO TO</span> 2000</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (kfxy2(kab).GT.kfxy1(kb)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;<span class="comment">C                                  SKIP MASTER ENTRY</span></div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;              kb  = kb + 1</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;      <span class="keywordflow">GO TO</span> 1000</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160; 2000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;      iptr(21)  = iptr(21) + 1</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;      kptrb(kfxy2(kab)) = iptr(21)</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;<span class="comment">C                                  APPEND ANCILLARY ENTRY</span></div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;      kfxy1(iptr(21))        = kfxy2(kab)</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;      aname1(iptr(21))(1:40) = aname2(kab)(1:40)</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;      aunit1(iptr(21))       = aunit2(kab)</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;      iscal1(iptr(21))       = iscal2(kab)</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;      irfvl1(1,iptr(21))       = irfvl2(kab)</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;      iwide1(iptr(21))       = iwide2(kab)</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;<span class="comment">C     PRINT *,IPTR(21),KFXY1(IPTR(21)),&#39; APPENDED&#39;</span></div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;      kab                   = kab + 1</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;      <span class="keywordflow">GO TO</span> 1000</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160; 3000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;<span class="comment">C                                  REPLACE MASTER ENTRY</span></div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;      kfxy1(kb)       = kfxy2(kab)</div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;      aname1(kb)      = aname2(kab)(1:40)</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;      aunit1(kb)      = aunit2(kab)</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;      iscal1(kb)      = iscal2(kab)</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;      irfvl1(1,kb)    = irfvl2(kab)</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;      iwide1(kb)      = iwide2(kab)</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;<span class="comment">C     PRINT *,KB,KFXY1(KB),&#39;REPLACED&#39;,IWIDE1(KB)</span></div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;      kab             = kab + 1</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;      kb              = kb + 1</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;      <span class="keywordflow">GO TO</span> 1000</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160; 5000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;      iptr(41)  = 0</div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;<span class="comment">C                                  PROCESSING COMPLETE</span></div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;<span class="comment">C     PRINT *,&#39;FI8818-B&#39;,IPTR(21),IPTR(41)</span></div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;<span class="comment">C     DO 6000 I = 1, IPTR(21)</span></div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;<span class="comment">C         PRINT *,&#39;FI8818-C&#39;,I,KFXY1(I),IWIDE1(I)</span></div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;<span class="comment">C6000 CONTINUE</span></div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;      <span class="keyword">SUBROUTINE </span>fi8819(IPTR,ITBLD,ITBLD2,KPTRD)</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;<span class="comment">C$$$  SUBPROGRAM DOCUMENTATION BLOCK</span></div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;<span class="comment">C                .      .    .                                       .</span></div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;<span class="comment">C SUBPROGRAM:    FI8819      MERGE ANCILLARY &amp; MASTER TABLE D</span></div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;<span class="comment">C   PRGMMR: CAVANAUGH        ORG: W/NMC42    DATE: YY-MM-DD</span></div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;<span class="comment">C ABSTRACT: MERGE TABLE D ENTRIES WITH THE ENTRIES FROM THE STANDARD</span></div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;<span class="comment">C   TABLE D. ASSURE THAT ENTRIES ARE SEQUENTIAL.</span></div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;<span class="comment">C PROGRAM HISTORY LOG:</span></div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;<span class="comment">C   YY-MM-DD  CAVANAUGH</span></div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;<span class="comment">C   YY-MM-DD  MODIFIER1   DESCRIPTION OF CHANGE</span></div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;<span class="comment">C USAGE:    CALL FI8819(IPTR,ITBLD,ITBLD2,KPTRD)</span></div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;<span class="comment">C   INPUT ARGUMENT LIST:</span></div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;<span class="comment">C     IPTR     -</span></div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;<span class="comment">C     ITBLD    -</span></div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;<span class="comment">C     ITBLD2   -</span></div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;<span class="comment">C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)</span></div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;<span class="comment">C     IPTR     -</span></div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;<span class="comment">C     ITBLD    -</span></div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;<span class="comment">C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION</span></div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;<span class="comment">C ATTRIBUTES:</span></div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;<span class="comment">C   LANGUAGE: FORTRAN 77</span></div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;<span class="comment">C   MACHINE:  NAS, CYBER</span></div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;<span class="comment">C$$$</span></div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;<span class="comment">C                       ANCILLARY TABLE D FROM TYPE 11 BUFR MESSAGE</span></div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;      <span class="keywordtype">INTEGER</span>        ITBLD2(20,*)</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;<span class="comment">C                       NEW BASE TABLE D</span></div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;      <span class="keywordtype">INTEGER</span>        ITBLD(20,*)</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;      <span class="keywordtype">INTEGER</span>           IPTR(*),KPTRD(*)</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160; </div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;      SAVE</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;<span class="comment">C     PRINT *,&#39;FI8819-A&#39;,IPTR(20),IPTR(42)</span></div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;<span class="comment">C                       SET UP POINTERS</span></div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;      DO 1000 I = 1, iptr(42)</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;          iptr(20) = iptr(20) + 1</div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;          <span class="keywordflow">DO</span> 500 j = 1, 20</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;               itbld(j,iptr(20)) = itbld2(j,i)</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;               mptrd = mod(itbld(j,iptr(20)),16384)</div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;               kptrd(mptrd) = iptr(20)</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;  500     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160; 1000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;<span class="comment">C  =======================================================</span></div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;      iptr(42) = 0</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;<span class="comment">C     PRINT *,&#39;MERGED TABLE D -- FI8819-B&#39;,IPTR(20),IPTR(42)</span></div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;<span class="comment">C     DO 6000 I = 1, IPTR(20)</span></div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;<span class="comment">C         WRITE (6,6001)I,(ITBLD(J,I),J=1,20)</span></div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;<span class="comment">C6001     FORMAT(15(1X,I5))</span></div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;<span class="comment">C6000 CONTINUE</span></div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;      <span class="keyword">END</span></div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;      <span class="keyword">SUBROUTINE </span>fi8820 (ITBLD,IUNITD,IPTR,ITBLD2,KPTRD)</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;<span class="comment">C$$$  SUBPROGRAM DOCUMENTATION BLOCK</span></div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;<span class="comment">C                .      .    .                                       .</span></div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;<span class="comment">C SUBPROGRAM:    FI8820      READ IN BUFR TABLE D</span></div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;<span class="comment">C   PRGMMR: CAVANAUGH        ORG: W/NMC42    DATE: 93-05-06</span></div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;<span class="comment">C ABSTRACT: READ IN BUFR TABLE D</span></div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;<span class="comment">C PROGRAM HISTORY LOG:</span></div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;<span class="comment">C   93-05-06  CAVANAUGH</span></div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;<span class="comment">C   YY-MM-DD  MODIFIER1   DESCRIPTION OF CHANGE</span></div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;<span class="comment">C USAGE:    CALL FI8820 (ITBLD,IUNITD,IPTR,ITBLD2,KPTRD)</span></div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;<span class="comment">C   INPUT ARGUMENT LIST:</span></div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;<span class="comment">C     IUNITD   - UNIT NUMBER FOR TABLE D INPUT</span></div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;<span class="comment">C     IPTR     - ARRAY OF WORKING VALUES</span></div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;<span class="comment">C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)</span></div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;<span class="comment">C     ITBLD    - ARRAY TO CONTAIN TABLE D</span></div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;<span class="comment">C REMARKS:</span></div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;<span class="comment">C ATTRIBUTES:</span></div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;<span class="comment">C   LANGUAGE: FORTRAN 77</span></div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;<span class="comment">C   MACHINE:  NAS</span></div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;<span class="comment">C$$$</span></div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;<span class="comment">C                       ANCILLARY TABLE D FROM TYPE 11 BUFR MESSAGE</span></div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;      <span class="keywordtype">INTEGER</span>        ITBLD2(20,*)</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;<span class="comment">C                       NEW BASE TABLE D</span></div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;      <span class="keywordtype">INTEGER</span>        ITBLD(20,*)</div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;<span class="comment">C  ..................................................</span></div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;      <span class="keywordtype">INTEGER</span>       IHOLD(33),IPTR(*),KPTRD(*)</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;      <span class="keywordtype">LOGICAL</span>       MORE</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160; </div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;      SAVE</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;      MORE  = .true.</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;      i  = 0</div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;<span class="comment">C                                  READ IN TABLE D, BUT JUST ONCE</span></div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;<span class="comment">C     PRINT *,&#39;TABLE D SWITCH=&#39;,IPTR(20),&#39; ANCILLARY D SW=&#39;,IPTR(42)</span></div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;      <span class="keywordflow">IF</span> (iptr(20).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;          <span class="keywordflow">DO</span> 1000 mm = 1, 16384</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;              kptrd(mm) = -1</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160; 1000     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;          ierr  = 0</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;          print *,<span class="stringliteral">&#39;FI8820 - READING TABLE D&#39;</span></div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;          key = 0</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;  100     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;<span class="comment">C                                 READ NEXT TABLE D ENTRY</span></div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;          <span class="keyword">READ</span>(iunitd,15,err=9998,<span class="keyword">END</span>=9000)(IHOLD(M),M=1,33)</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;   15     <span class="keyword">FORMAT</span>(11(i1,i2,i3,1x),3x)</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;<span class="comment">C                                  BUILD KEY FROM MASTER D ENTRY</span></div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;<span class="comment">C                             INSERT NEW MASTER INTO TABLE B</span></div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;          i  = i + 1</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;          iptr(20)  = iptr(20) + 1</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;          <span class="keywordflow">DO</span> 25 jj = 1, 41, 3</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;              kk = (jj/3) + 1</div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;              <span class="keywordflow">IF</span> (jj.LE.31) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;                  itbld(kk,i) = ihold(jj)*16384 +</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;     *                                 ihold(jj+1)*256 + ihold(jj+2)</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;                   <span class="keywordflow">IF</span> (itbld(kk,i).LT.1.OR.itbld(kk,i).GT.65535) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;                       itbld(kk,i) = 0</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;                       <span class="keywordflow">GO TO</span> 25</div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;<span class="keywordflow">                   END IF</span></div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;                  itbld(kk,i)  = 0</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;   25     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;          mptrd = mod(itbld(1,i),16384)</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;          kptrd(mptrd) = i</div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;   50     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;<span class="comment">C         WRITE (6,51)I,(ITBLD(L,I),L=1,15)</span></div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;   51     <span class="keyword">FORMAT</span> (7h tabled,16(1x,i5))</div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;          <span class="keywordflow">GO TO</span> 100</div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;<span class="comment">C         PRINT *,&#39;TABLE D IS IN PLACE&#39;</span></div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;      <span class="keywordflow">GO TO</span> 9999</div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160; 9000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;      <span class="keyword">CLOSE</span>(unit=iunitd,status=<span class="stringliteral">&#39;KEEP&#39;</span>)</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;      <span class="keywordflow">GO TO</span> 9999</div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160; 9998 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;      iptr(1)  = 8</div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;<span class="comment">C</span></div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160; 9999 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;<span class="comment">C     PRINT *,&#39;THERE ARE&#39;,IPTR(20),&#39; ENTRIES IN TABLE D&#39;</span></div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;      <span class="keyword">END</span></div>
<div class="ttc" id="agbyte_8f_html_ad73b69048043b0e9876125b1d839e5c6"><div class="ttname"><a href="gbyte_8f.html#ad73b69048043b0e9876125b1d839e5c6">gbyte</a></div><div class="ttdeci">subroutine gbyte(IPACKD, IUNPKD, NOFF, NBITS)</div><div class="ttdoc">This is the fortran version of gbyte.</div><div class="ttdef"><b>Definition:</b> <a href="gbyte_8f_source.html#l00026">gbyte.f:27</a></div></div>
<div class="ttc" id="agbytes_8f_html_ac957b0c87f1261d8460c52bfec7d0308"><div class="ttname"><a href="gbytes_8f.html#ac957b0c87f1261d8460c52bfec7d0308">gbytes</a></div><div class="ttdeci">subroutine gbytes(IPACKD, IUNPKD, NOFF, NBITS, ISKIP, ITER)</div><div class="ttdoc">Program history log:</div><div class="ttdef"><b>Definition:</b> <a href="gbytes_8f_source.html#l00025">gbytes.f:26</a></div></div>
<div class="ttc" id="amova2i_8f_html_aed1be7b63ac5c89c04f701e75bb4fbe0"><div class="ttname"><a href="mova2i_8f.html#aed1be7b63ac5c89c04f701e75bb4fbe0">mova2i</a></div><div class="ttdeci">integer function mova2i(a)</div><div class="ttdoc">This Function copies a bit string from a Character*1 variable to an integer variable.</div><div class="ttdef"><b>Definition:</b> <a href="mova2i_8f_source.html#l00024">mova2i.f:25</a></div></div>
<div class="ttc" id="aw3ai39_8f_html_a28ca73de8fec4c73859576d1d2e0a219"><div class="ttname"><a href="w3ai39_8f.html#a28ca73de8fec4c73859576d1d2e0a219">w3ai39</a></div><div class="ttdeci">subroutine w3ai39(NFLD, N)</div><div class="ttdoc">translate an 'ASCII' field to 'EBCDIC', all alphanumerics, special charcaters, fill scatter,...</div><div class="ttdef"><b>Definition:</b> <a href="w3ai39_8f_source.html#l00025">w3ai39.f:26</a></div></div>
<div class="ttc" id="aw3fc05_8f_html_ae77a21f468d05a34fa3a201c89b30530"><div class="ttname"><a href="w3fc05_8f.html#ae77a21f468d05a34fa3a201c89b30530">w3fc05</a></div><div class="ttdeci">subroutine w3fc05(U, V, DIR, SPD)</div><div class="ttdoc">Given the true (Earth oriented) wind components compute the wind direction and speed.</div><div class="ttdef"><b>Definition:</b> <a href="w3fc05_8f_source.html#l00028">w3fc05.f:29</a></div></div>
<div class="ttc" id="aw3fi01_8f_html_a10ac20498f7eca8e2281cad1218bede4"><div class="ttname"><a href="w3fi01_8f.html#a10ac20498f7eca8e2281cad1218bede4">w3fi01</a></div><div class="ttdeci">subroutine w3fi01(LW)</div><div class="ttdoc">Determines the number of bytes in a full word for the particular machine (IBM or cray).</div><div class="ttdef"><b>Definition:</b> <a href="w3fi01_8f_source.html#l00018">w3fi01.f:19</a></div></div>
<div class="ttc" id="aw3fi88_8f_html_a119b554db1325ff6b2d3742797f107dd"><div class="ttname"><a href="w3fi88_8f.html#a119b554db1325ff6b2d3742797f107dd">fi8806</a></div><div class="ttdeci">subroutine fi8806(IPTR, LX, LY, IDENT, MSGA, KDATA, IVALS, MSTACK, IWIDE1, IRFVL1, ISCAL1, J, LL, KFXY1, IWORK, JDESC, MAXR, MAXD, KPTRB)</div><div class="ttdoc">Process operator descriptors.</div><div class="ttdef"><b>Definition:</b> <a href="w3fi88_8f_source.html#l02147">w3fi88.f:2149</a></div></div>
<div class="ttc" id="aw3fi88_8f_html_a12b020b46772271cab997bb781bda9c1"><div class="ttname"><a href="w3fi88_8f.html#a12b020b46772271cab997bb781bda9c1">fi8811</a></div><div class="ttdeci">subroutine fi8811(IPTR, IDENT, MSTACK, KDATA, KNR, LDATA, LSTACK, MAXD, MAXR)</div><div class="ttdoc">Expand data/descriptor replication.</div><div class="ttdef"><b>Definition:</b> <a href="w3fi88_8f_source.html#l03247">w3fi88.f:3249</a></div></div>
<div class="ttc" id="aw3fi88_8f_html_a228b9ca88ab5e42aa00c6df379ecd470"><div class="ttname"><a href="w3fi88_8f.html#a228b9ca88ab5e42aa00c6df379ecd470">fi8803</a></div><div class="ttdeci">subroutine fi8803(IPTR, IDENT, MSGA, KDATA, IVALS, MSTACK, IWIDE1, IRFVL1, ISCAL1, J, JDESC, MAXR, MAXD)</div><div class="ttdoc">Process compressed data.</div><div class="ttdef"><b>Definition:</b> <a href="w3fi88_8f_source.html#l01412">w3fi88.f:1414</a></div></div>
<div class="ttc" id="aw3fi88_8f_html_a2a7856fc62e88d8fa8670e58c4082293"><div class="ttname"><a href="w3fi88_8f.html#a2a7856fc62e88d8fa8670e58c4082293">fi8808</a></div><div class="ttdeci">subroutine fi8808(IPTR, IWORK, LF, LX, LY, JDESC)</div><div class="ttdoc">Program history log:</div><div class="ttdef"><b>Definition:</b> <a href="w3fi88_8f_source.html#l02458">w3fi88.f:2459</a></div></div>
<div class="ttc" id="aw3fi88_8f_html_a334e81d3c01ac71a02ef5425671e7bf0"><div class="ttname"><a href="w3fi88_8f.html#a334e81d3c01ac71a02ef5425671e7bf0">fi8809</a></div><div class="ttdeci">subroutine fi8809(IDENT, MSTACK, KDATA, IPTR, MAXR, MAXD)</div><div class="ttdoc">Reformat profiler w hgt increments.</div><div class="ttdef"><b>Definition:</b> <a href="w3fi88_8f_source.html#l02516">w3fi88.f:2517</a></div></div>
<div class="ttc" id="aw3fi88_8f_html_a45180c8723bc0f7b3eaff47b7fda7ed8"><div class="ttname"><a href="w3fi88_8f.html#a45180c8723bc0f7b3eaff47b7fda7ed8">fi8805</a></div><div class="ttdeci">subroutine fi8805(IPTR, IDENT, MSGA, IWORK, LX, LY, KDATA, LL, KNR, MSTACK, MAXR, MAXD)</div><div class="ttdoc">Process a replication descriptor.</div><div class="ttdef"><b>Definition:</b> <a href="w3fi88_8f_source.html#l01939">w3fi88.f:1941</a></div></div>
<div class="ttc" id="aw3fi88_8f_html_a7829bc0e44ec367834a1a6d83377d428"><div class="ttname"><a href="w3fi88_8f.html#a7829bc0e44ec367834a1a6d83377d428">fi8802</a></div><div class="ttdeci">subroutine fi8802(IPTR, IDENT, MSGA, KDATA, KFXY1, LL, MSTACK, AUNIT1, IWIDE1, IRFVL1, ISCAL1, JDESC, IVALS, J, MAXR, MAXD, KPTRB)</div><div class="ttdoc">Process element descriptor.</div><div class="ttdef"><b>Definition:</b> <a href="w3fi88_8f_source.html#l01307">w3fi88.f:1309</a></div></div>
<div class="ttc" id="aw3fi88_8f_html_a94b6d994b2df117c1395048caea2f86b"><div class="ttname"><a href="w3fi88_8f.html#a94b6d994b2df117c1395048caea2f86b">fi8804</a></div><div class="ttdeci">subroutine fi8804(IPTR, MSGA, KDATA, IVALS, MSTACK, IWIDE1, IRFVL1, ISCAL1, J, LL, JDESC, MAXR, MAXD)</div><div class="ttdoc">Process serial data.</div><div class="ttdef"><b>Definition:</b> <a href="w3fi88_8f_source.html#l01731">w3fi88.f:1733</a></div></div>
<div class="ttc" id="aw3fi88_8f_html_aa56d7f5f943a7bf774c2e9ddc144595f"><div class="ttname"><a href="w3fi88_8f.html#aa56d7f5f943a7bf774c2e9ddc144595f">fi8807</a></div><div class="ttdeci">subroutine fi8807(IPTR, IWORK, ITBLD, ITBLD2, JDESC, KPTRD)</div><div class="ttdoc">Process queue descriptor.</div><div class="ttdef"><b>Definition:</b> <a href="w3fi88_8f_source.html#l02371">w3fi88.f:2372</a></div></div>
<div class="ttc" id="aw3fi88_8f_html_aaa3b36f853bace0e172b8191ce3a4f17"><div class="ttname"><a href="w3fi88_8f.html#aaa3b36f853bace0e172b8191ce3a4f17">w3fi88</a></div><div class="ttdeci">subroutine w3fi88(IPTR, IDENT, MSGA, ISTACK, MSTACK, KDATA, KNR, INDEX, LDATA, LSTACK, MAXR, MAXD, IUNITB, IUNITD)</div><div class="ttdoc">This set of routines will decode a bufr message and place information extracted from the bufr message...</div><div class="ttdef"><b>Definition:</b> <a href="w3fi88_8f_source.html#l00437">w3fi88.f:439</a></div></div>
<div class="ttc" id="aw3fi88_8f_html_adad8332e2168ab134f2c6f879f133a5f"><div class="ttname"><a href="w3fi88_8f.html#adad8332e2168ab134f2c6f879f133a5f">fi8810</a></div><div class="ttdeci">subroutine fi8810(IDENT, MSTACK, KDATA, IPTR, MAXR, MAXD)</div><div class="ttdoc">Reformat profiler edition 2 data.</div><div class="ttdef"><b>Definition:</b> <a href="w3fi88_8f_source.html#l02910">w3fi88.f:2911</a></div></div>
<div class="ttc" id="aw3fi88_8f_html_ae5d0192919fea00763c2ea1490bff16a"><div class="ttname"><a href="w3fi88_8f.html#ae5d0192919fea00763c2ea1490bff16a">fi8801</a></div><div class="ttdeci">subroutine fi8801(IPTR, IDENT, MSGA, ISTACK, IWORK, KDATA, IVALS, MSTACK, KNR, INDEX, MAXR, MAXD, KFXY1, ANAME1, AUNIT1, ISCAL1, IRFVL1, IWIDE1, IRF1SW, INEWVL, KFXY2, ANAME2, AUNIT2, ISCAL2, IRFVL2, IWIDE2, KFXY3, ANAME3, AUNIT3, ISCAL3, IRFVL3, IWIDE3, IUNITB, IUNITD, ITBLD, ITBLD2, KPTRB, KPTRD)</div><div class="ttdoc">Data extraction.</div><div class="ttdef"><b>Definition:</b> <a href="w3fi88_8f_source.html#l00967">w3fi88.f:973</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="w3fi88_8f.html">w3fi88.f</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
