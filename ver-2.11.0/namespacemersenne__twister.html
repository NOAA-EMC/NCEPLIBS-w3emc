<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NCEPLIBS-w3emc: mersenne_twister Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NCEPLIBS-w3emc
   &#160;<span id="projectnumber">2.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacemersenne__twister.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">mersenne_twister Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module calculates random numbers using the Mersenne twister.  
<a href="namespacemersenne__twister.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:acd01aa05ecfbe1c3283dc3552fc9a437"><td class="memItemLeft" align="right" valign="top">real function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemersenne__twister.html#acd01aa05ecfbe1c3283dc3552fc9a437">random_gauss_f</a> ()</td></tr>
<tr class="memdesc:acd01aa05ecfbe1c3283dc3552fc9a437"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates Gaussian random numbers in functional mode.  <a href="namespacemersenne__twister.html#acd01aa05ecfbe1c3283dc3552fc9a437">More...</a><br /></td></tr>
<tr class="separator:acd01aa05ecfbe1c3283dc3552fc9a437"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc59b5b06bcd98e292ffeaeae88c9c5e"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemersenne__twister.html#acc59b5b06bcd98e292ffeaeae88c9c5e">random_index_f</a> (imax)</td></tr>
<tr class="memdesc:acc59b5b06bcd98e292ffeaeae88c9c5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates random indices in functional mode.  <a href="namespacemersenne__twister.html#acc59b5b06bcd98e292ffeaeae88c9c5e">More...</a><br /></td></tr>
<tr class="separator:acc59b5b06bcd98e292ffeaeae88c9c5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72d5b1cd21e6af407325bb8b0e18481a"><td class="memItemLeft" align="right" valign="top">real function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemersenne__twister.html#a72d5b1cd21e6af407325bb8b0e18481a">random_number_f</a> ()</td></tr>
<tr class="memdesc:a72d5b1cd21e6af407325bb8b0e18481a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates random numbers in functional mode.  <a href="namespacemersenne__twister.html#a72d5b1cd21e6af407325bb8b0e18481a">More...</a><br /></td></tr>
<tr class="separator:a72d5b1cd21e6af407325bb8b0e18481a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5807578f927f719be280774b17803ad"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemersenne__twister.html#ab5807578f927f719be280774b17803ad">random_seed</a> (size, put, get, stat)</td></tr>
<tr class="memdesc:ab5807578f927f719be280774b17803ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets and gets state; overloads Fortran 90 standard.  <a href="namespacemersenne__twister.html#ab5807578f927f719be280774b17803ad">More...</a><br /></td></tr>
<tr class="separator:ab5807578f927f719be280774b17803ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module calculates random numbers using the Mersenne twister. </p>
<p>(It has been adapted to a Fortran 90 module from open source software. The comments from the original software are given below in the remarks.) The Mersenne twister (aka MT19937) is a state-of-the-art random number generator based on Mersenne primes and originally developed in 1997 by Matsumoto and Nishimura. It has a period before repeating of 2^19937-1, which certainly should be good enough for geophysical purposes. :-) Considering the algorithm's robustness, it runs fairly speedily. (Some timing statistics are given below in the remarks.) This adaptation uses the standard Fortran 90 random number interface, which can generate an arbitrary number of random numbers at one time. The random numbers generated are uniformly distributed between 0 and 1. The module also can generate random numbers from a Gaussian distribution with mean 0 and standard deviation 1, using a Numerical Recipes algorithm. The module also can generate uniformly random integer indices. There are also thread-safe versions of the generators in this adaptation, necessitating the passing of generator states which must be kept private.</p>
<p>Usage:</p><ul>
<li>The module can be compiled with 4-byte reals or with 8-byte reals, but 4-byte integers are required. The module should be endian-independent.</li>
<li>The Fortran 90 interfaces random_seed and random_number are overloaded and can be used as in the standard by adding the appropriate use statement<ul>
<li>use <a class="el" href="namespacemersenne__twister.html" title="This module calculates random numbers using the Mersenne twister.">mersenne_twister</a></li>
</ul>
</li>
<li>In the below use cases, harvest is a real array of arbitrary size, and iharvest is an integer array of arbitrary size.</li>
<li>To generate uniformly distributed random numbers between 0 and 1,<ul>
<li>call random_number(harvest)</li>
</ul>
</li>
<li>To generate Gaussian distributed random numbers with 0 mean and 1 sigma,<ul>
<li>call random_gauss(harvest)</li>
</ul>
</li>
<li>To generate uniformly distributed random integer indices between 0 and n,<ul>
<li>call random_index(n,iharvest)</li>
</ul>
</li>
<li>In standard "saved" mode, the random number generator can be used without setting a seed. But to set a seed, only 1 non-zero integer is required, e.g.<ul>
<li>call random_setseed(4357) ! set default seed</li>
</ul>
</li>
<li>The full generator state can be set via the standard interface random_seed, but it is recommended to use this method only to restore saved states, e.g.<ul>
<li>call random_seed(size=lsave) ! get size of generator state seed array</li>
<li>allocate isave(lsave) ! allocate seed array</li>
<li>call random_seed(get=isave) ! fill seed array (then maybe save to disk)</li>
<li>call random_seed(put=isave) ! restore state (after read from disk maybe)</li>
</ul>
</li>
<li>Locally kept generator states can also be saved in a seed array, e.g.<ul>
<li>type(random_stat):: stat</li>
<li>call random_seed(get=isave,stat=stat) ! fill seed array</li>
<li>call random_seed(put=isave,stat=stat) ! restore state</li>
</ul>
</li>
<li>To generate random numbers in a threaded region, the "thread-safe" mode must be used where generator states of type random_state are passed, e.g.</li>
</ul>
<p>Public Defined Types:</p><ul>
<li>random_stat Generator state (private contents)</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Here are the comments in the original open source code: A C-program for MT19937: Real number version genrand() generates one pseudorandom real number (double) which is uniformly distributed on [0,1]-interval, for each call. sgenrand(seed) set initial values to the working area of 624 words. Before genrand(), sgenrand(seed) must be called once. (seed is any 32-bit integer except for 0). Integer generator is obtained by modifying two lines. Coded by Takuji Nishimura, considering the suggestions by Topher Cooper and Marc Rieffel in July-Aug. 1997. This library is free software; you can redistribute it and/or modify it under the terms of the GNU Library General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version. This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Library General Public License for more details. You should have received a copy of the GNU Library General Public License along with this library; if not, write to the Free Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA Copyright (C) 1997 Makoto Matsumoto and Takuji Nishimura. When you use this, send an email to: <a href="#" onclick="location.href='mai'+'lto:'+'mat'+'um'+'oto'+'@m'+'ath'+'.k'+'eio'+'.a'+'c.j'+'p'; return false;">matum<span style="display: none;">.nosp@m.</span>oto@<span style="display: none;">.nosp@m.</span>math.<span style="display: none;">.nosp@m.</span>keio<span style="display: none;">.nosp@m.</span>.ac.j<span style="display: none;">.nosp@m.</span>p</a> with an appropriate reference to your work. Fortran translation by Hiroshi Takano. Jan. 13, 1999.</dd>
<dd>
On a single IBM Power4 processor on the NCEP operational cluster (2005) each Mersenne twister random number takes less than 30 ns, about 3 times slower than the default random number generator, and each random number from a Gaussian distribution takes less than 150 ns.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Mark Iredell </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2005-06-14 </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="acd01aa05ecfbe1c3283dc3552fc9a437"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd01aa05ecfbe1c3283dc3552fc9a437">&#9670;&nbsp;</a></span>random_gauss_f()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function, public mersenne_twister::random_gauss_f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates Gaussian random numbers in functional mode. </p>
<dl class="section return"><dt>Returns</dt><dd>harvest Real number output. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mersenne__twister_8f_source.html#l00305">305</a> of file <a class="el" href="mersenne__twister_8f_source.html">mersenne_twister.f</a>.</p>

</div>
</div>
<a id="acc59b5b06bcd98e292ffeaeae88c9c5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc59b5b06bcd98e292ffeaeae88c9c5e">&#9670;&nbsp;</a></span>random_index_f()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public mersenne_twister::random_index_f </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>imax</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates random indices in functional mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">imax</td><td>Integer maximum index input </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>iharvest Integer number output </dd></dl>

<p class="definition">Definition at line <a class="el" href="mersenne__twister_8f_source.html#l00396">396</a> of file <a class="el" href="mersenne__twister_8f_source.html">mersenne_twister.f</a>.</p>

</div>
</div>
<a id="a72d5b1cd21e6af407325bb8b0e18481a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72d5b1cd21e6af407325bb8b0e18481a">&#9670;&nbsp;</a></span>random_number_f()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function, public mersenne_twister::random_number_f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates random numbers in functional mode. </p>
<dl class="section return"><dt>Returns</dt><dd>harvest Real number output. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mersenne__twister_8f_source.html#l00233">233</a> of file <a class="el" href="mersenne__twister_8f_source.html">mersenne_twister.f</a>.</p>

</div>
</div>
<a id="ab5807578f927f719be280774b17803ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5807578f927f719be280774b17803ad">&#9670;&nbsp;</a></span>random_seed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mersenne_twister::random_seed </td>
          <td>(</td>
          <td class="paramtype">integer, intent(out), optional&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrest), intent(in), optional&#160;</td>
          <td class="paramname"><em>put</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrest), intent(out), optional&#160;</td>
          <td class="paramname"><em>get</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(random_stat), intent(inout), optional&#160;</td>
          <td class="paramname"><em>stat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets and gets state; overloads Fortran 90 standard. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">size</td><td>Optional integer output size of seed array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">put</td><td>Optional integer(:) input seed array. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">get</td><td>Optional integer(:) output seed array. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stat</td><td>Optional type(random_stat) (thread-safe mode). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mersenne__twister_8f_source.html#l00150">150</a> of file <a class="el" href="mersenne__twister_8f_source.html">mersenne_twister.f</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemersenne__twister.html">mersenne_twister</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
