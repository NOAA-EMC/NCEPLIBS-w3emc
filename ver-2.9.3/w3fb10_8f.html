<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NCEPLIBS-w3emc: w3fb10.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NCEPLIBS-w3emc
   &#160;<span id="projectnumber">2.9.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('w3fb10_8f.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">w3fb10.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Lat/long pair to compass bearing, gcd.  
<a href="#details">More...</a></p>

<p><a href="w3fb10_8f_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a5f021ccf55ac42f4034f0fd60e612911"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="w3fb10_8f.html#a5f021ccf55ac42f4034f0fd60e612911">w3fb10</a> (DLAT1, DLON1, DLAT2, DLON2, BEARD, GCDKM)</td></tr>
<tr class="memdesc:a5f021ccf55ac42f4034f0fd60e612911"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a pair of points (1) and (2) given by latitude and longitude, <a class="el" href="w3fb10_8f.html#a5f021ccf55ac42f4034f0fd60e612911" title="Given a pair of points (1) and (2) given by latitude and longitude, w3fb10() computes the bearing and...">w3fb10()</a> computes the bearing and great circle distance from point (1) to point (2) assuming a spherical Earth.  <a href="w3fb10_8f.html#a5f021ccf55ac42f4034f0fd60e612911">More...</a><br /></td></tr>
<tr class="separator:a5f021ccf55ac42f4034f0fd60e612911"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Lat/long pair to compass bearing, gcd. </p>
<dl class="section author"><dt>Author</dt><dd>Peter Chase </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1988-08-29 </dd></dl>

<p class="definition">Definition in file <a class="el" href="w3fb10_8f_source.html">w3fb10.f</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a5f021ccf55ac42f4034f0fd60e612911"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f021ccf55ac42f4034f0fd60e612911">&#9670;&nbsp;</a></span>w3fb10()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3fb10 </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>DLAT1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>DLON1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>DLAT2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>DLON2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>BEARD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>GCDKM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a pair of points (1) and (2) given by latitude and longitude, <a class="el" href="w3fb10_8f.html#a5f021ccf55ac42f4034f0fd60e612911" title="Given a pair of points (1) and (2) given by latitude and longitude, w3fb10() computes the bearing and...">w3fb10()</a> computes the bearing and great circle distance from point (1) to point (2) assuming a spherical Earth. </p>
<p>The north and south poles are special cases. If latitude of point (1) is within 1e-10 degrees of the north pole, bearing is the negative longitude of point (2) by convention. If latitude of point (1) is within 1e-10 degrees of the south pole, bearing is the longitude of point (2) by convention. If point (2) is within 1e-6 radians of the antipode of point (1), the bearing will be set to zero. If point (1) and point (2) are within 1e-10 radians of each other, both bearing and distance will be set to zero.</p>
<p>Program history log:</p><ul>
<li>Peter Chase 1988-08-29</li>
<li>Peter Chase 1988-09-23 Fix dumb south pole error.</li>
<li>Peter Chase 1988-10-05 Fix bearing ambiguity.</li>
<li>Ralph Jones 1990-04-12 Convert to cft77 fortran.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">DLAT1</td><td>REAL Latitude of point (1) in degrees north. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DLON1</td><td>REAL Longitude of point (1) in degrees east. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DLAT2</td><td>REAL Latitude of point (2) in degrees north. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DLON2</td><td>REAL Longitude of point (2) in degrees east. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">BEARD</td><td>REAL Bearing of point (2) from point (1) in compass degrees with north = 0.0, values from -180.0 to +180.0 degrees. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">GCDKM</td><td>REAL Great circle distance from point (1) to point (2) in kilometers.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>According to the nmc handbook, the Earth's radius is 6371.2 kilometers. This is what we use, even though the value recommended by the smithsonian meteorological handbook is 6371.221 km. (I wouldn't want you to think that I didn't know what the correct value was.)</dd>
<dd>
Method: The poles are special cases, and handled separately. otherwise, from spherical trigonometry, the law of cosines is used to calculate the third side of the spherical triangle having sides from the pole to points (1) and (2) (the colatitudes). then the law of sines is used to calculate the angle at point (1). A test is applied to see whether the arcsine result may be be used as such, giving an acute angle as the bearing, or whether the arcsine result should be subtracted from pi, giving an obtuse angle as the bearing. This test is derived by constructing a right spherical triangle using the pole, point (2), and the meridian through point(1). The latitude of the right-angled vertex then provides a test&ndash;if latitude (1) is greater than this latitude, the bearing angle must be obtuse, otherwise acute. If the two points are within 1e-6 radians of each other a flat Earth is assumed, and the four-quadrant arctangent function is used to find the bearing. The y-displacement is the difference in latitude and the x-displacement is the difference in longitude times cosine latitude, both in radians. distance is then the diagonal.</dd>
<dd>
Fundamental trigonometric identities are used freely, such as that cos(x) = sin(pi/2 - x), etc. See almost any mathematical handbook, such as the c.r.c. standard math tables under 'relations in any spherical triangle', or the national bureau of standards 'handbook of mathematical functions' under section 4.3.149, formulas for solution of spherical triangles.</dd>
<dd>
Double precision is used internally because of the wide range of geographic values that may be used.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Peter Chase </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1988-08-29 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3fb10_8f_source.html#l00071">71</a> of file <a class="el" href="w3fb10_8f_source.html">w3fb10.f</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="w3fb10_8f.html">w3fb10.f</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
